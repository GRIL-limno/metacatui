!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.$rdf=a()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){(function(b){!function(){function g(a){var b=!1;return function(){if(b)throw new Error("Callback was already called.");b=!0,a.apply(e,arguments)}}var e,f,d={};e=this,null!=e&&(f=e.async),d.noConflict=function(){return e.async=f,d};var h=Object.prototype.toString,i=Array.isArray||function(a){return"[object Array]"===h.call(a)},j=function(a,b){for(var c=0;c<a.length;c+=1)b(a[c],c,a)},k=function(a,b){if(a.map)return a.map(b);var c=[];return j(a,function(a,d,e){c.push(b(a,d,e))}),c},l=function(a,b,c){return a.reduce?a.reduce(b,c):(j(a,function(a,d,e){c=b(c,a,d,e)}),c)},m=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};"undefined"!=typeof b&&b.nextTick?(d.nextTick=b.nextTick,"undefined"!=typeof setImmediate?d.setImmediate=function(a){setImmediate(a)}:d.setImmediate=d.nextTick):"function"==typeof setImmediate?(d.nextTick=function(a){setImmediate(a)},d.setImmediate=d.nextTick):(d.nextTick=function(a){setTimeout(a,0)},d.setImmediate=d.nextTick),d.each=function(a,b,c){function e(b){b?(c(b),c=function(){}):(d+=1,d>=a.length&&c())}if(c=c||function(){},!a.length)return c();var d=0;j(a,function(a){b(a,g(e))})},d.forEach=d.each,d.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():e())})};e()},d.forEachSeries=d.eachSeries,d.eachLimit=function(a,b,c,d){var e=n(b);e.apply(null,[a,c,d])},d.forEachLimit=d.eachLimit;var n=function(a){return function(b,c,d){if(d=d||function(){},!b.length||a<=0)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;g<a&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},o=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.each].concat(b))}},p=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[n(a)].concat(c))}},q=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[d.eachSeries].concat(b))}},r=function(a,b,c,d){if(b=k(b,function(a,b){return{index:b,value:a}}),d){var e=[];a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})}else a(b,function(a,b){c(a.value,function(a){b(a)})})};d.map=o(r),d.mapSeries=q(r),d.mapLimit=function(a,b,c,d){return s(b)(a,c,d)};var s=function(a){return p(a,r)};d.reduce=function(a,b,c,e){d.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){e(a,b)})},d.inject=d.reduce,d.foldl=d.reduce,d.reduceRight=function(a,b,c,e){var f=k(a,function(a){return a}).reverse();d.reduce(f,b,c,e)},d.foldr=d.reduceRight;var t=function(a,b,c,d){var e=[];b=k(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(a){d(k(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.filter=o(t),d.filterSeries=q(t),d.select=d.filter,d.selectSeries=d.filterSeries;var u=function(a,b,c,d){var e=[];b=k(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(a){d(k(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};d.reject=o(u),d.rejectSeries=q(u);var v=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(a){d()})};d.detect=o(v),d.detectSeries=q(v),d.some=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(a){c(!1)})},d.any=d.some,d.every=function(a,b,c){d.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(a){c(!0)})},d.all=d.every,d.sortBy=function(a,b,c){d.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0};c(null,k(b.sort(d),function(a){return a.value}))})},d.auto=function(a,b){b=b||function(){};var c=m(a),e=c.length;if(!e)return b();var f={},g=[],h=function(a){g.unshift(a)},k=function(a){for(var b=0;b<g.length;b+=1)if(g[b]===a)return void g.splice(b,1)},n=function(){e--,j(g.slice(0),function(a){a()})};h(function(){if(!e){var a=b;b=function(){},a(null,f)}}),j(c,function(c){var e=i(a[c])?a[c]:[a[c]],g=function(a){var e=Array.prototype.slice.call(arguments,1);if(e.length<=1&&(e=e[0]),a){var g={};j(m(f),function(a){g[a]=f[a]}),g[c]=e,b(a,g),b=function(){}}else f[c]=e,d.setImmediate(n)},o=e.slice(0,Math.abs(e.length-1))||[],p=function(){return l(o,function(a,b){return a&&f.hasOwnProperty(b)},!0)&&!f.hasOwnProperty(c)};if(p())e[e.length-1](g,f);else{var q=function(){p()&&(k(q),e[e.length-1](g,f))};h(q)}})},d.retry=function(a,b,c){var e=5,f=[];"function"==typeof a&&(c=b,b=a,a=e),a=parseInt(a,10)||e;var g=function(e,g){for(var h=function(a,b){return function(c){a(function(a,d){c(!a||b,{err:a,result:d})},g)}};a;)f.push(h(b,!(a-=1)));d.series(f,function(a,b){b=b[b.length-1],(e||c)(b.err,b.result)})};return c?g():g},d.waterfall=function(a,b){if(b=b||function(){},!i(a)){var c=new Error("First argument to waterfall must be an array of functions");return b(c)}if(!a.length)return b();var e=function(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var f=Array.prototype.slice.call(arguments,1),g=a.next();g?f.push(e(g)):f.push(b),d.setImmediate(function(){a.apply(null,f)})}}};e(d.iterator(a))()};var w=function(a,b,c){if(c=c||function(){},i(b))a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(m(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};d.parallel=function(a,b){w({map:d.map,each:d.each},a,b)},d.parallelLimit=function(a,b,c){w({map:s(b),each:n(b)},a,c)},d.series=function(a,b){if(b=b||function(){},i(a))d.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};d.eachSeries(m(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},d.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},d.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var x=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};d.concat=o(x),d.concatSeries=q(x),d.whilst=function(a,b,c){a()?b(function(e){return e?c(e):void d.whilst(a,b,c)}):c()},d.doWhilst=function(a,b,c){a(function(e){if(e)return c(e);var f=Array.prototype.slice.call(arguments,1);b.apply(null,f)?d.doWhilst(a,b,c):c()})},d.until=function(a,b,c){a()?c():b(function(e){return e?c(e):void d.until(a,b,c)})},d.doUntil=function(a,b,c){a(function(e){if(e)return c(e);var f=Array.prototype.slice.call(arguments,1);b.apply(null,f)?c():d.doUntil(a,b,c)})},d.queue=function(a,b){function c(a,b,c,e){return a.started||(a.started=!0),i(b)||(b=[b]),0==b.length?d.setImmediate(function(){a.drain&&a.drain()}):void j(b,function(b){var f={data:b,callback:"function"==typeof e?e:null};c?a.tasks.unshift(f):a.tasks.push(f),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),d.setImmediate(a.process)})}void 0===b&&(b=1);var e=0,f={tasks:[],concurrency:b,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(a,b){c(f,a,!1,b)},kill:function(){f.drain=null,f.tasks=[]},unshift:function(a,b){c(f,a,!0,b)},process:function(){if(!f.paused&&e<f.concurrency&&f.tasks.length){var b=f.tasks.shift();f.empty&&0===f.tasks.length&&f.empty(),e+=1;var c=function(){e-=1,b.callback&&b.callback.apply(b,arguments),f.drain&&f.tasks.length+e===0&&f.drain(),f.process()},d=g(c);a(b.data,d)}},length:function(){return f.tasks.length},running:function(){return e},idle:function(){return f.tasks.length+e===0},pause:function(){f.paused!==!0&&(f.paused=!0)},resume:function(){if(f.paused!==!1){f.paused=!1;for(var a=1;a<=f.concurrency;a++)d.setImmediate(f.process)}}};return f},d.priorityQueue=function(a,b){function c(a,b){return a.priority-b.priority}function e(a,b,c){for(var d=-1,e=a.length-1;d<e;){var f=d+(e-d+1>>>1);c(b,a[f])>=0?d=f:e=f-1}return d}function f(a,b,f,g){return a.started||(a.started=!0),i(b)||(b=[b]),0==b.length?d.setImmediate(function(){a.drain&&a.drain()}):void j(b,function(b){var h={data:b,priority:f,callback:"function"==typeof g?g:null};a.tasks.splice(e(a.tasks,h,c)+1,0,h),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),d.setImmediate(a.process)})}var g=d.queue(a,b);return g.push=function(a,b,c){f(g,a,b,c)},delete g.unshift,g},d.cargo=function(a,b){var c=!1,e=[],f={tasks:e,payload:b,saturated:null,empty:null,drain:null,drained:!0,push:function(a,c){i(a)||(a=[a]),j(a,function(a){e.push({data:a,callback:"function"==typeof c?c:null}),f.drained=!1,f.saturated&&e.length===b&&f.saturated()}),d.setImmediate(f.process)},process:function d(){if(!c){if(0===e.length)return f.drain&&!f.drained&&f.drain(),void(f.drained=!0);var g="number"==typeof b?e.splice(0,b):e.splice(0,e.length),h=k(g,function(a){return a.data});f.empty&&f.empty(),c=!0,a(h,function(){c=!1;var a=arguments;j(g,function(b){b.callback&&b.callback.apply(null,a)}),d()})}},length:function(){return e.length},running:function(){return c}};return f};var y=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&j(c,function(b){console[a](b)}))}]))}};d.log=y("log"),d.dir=y("dir"),d.memoize=function(a,b){var c={},e={};b=b||function(a){return a};var f=function(){var f=Array.prototype.slice.call(arguments),g=f.pop(),h=b.apply(null,f);h in c?d.nextTick(function(){g.apply(null,c[h])}):h in e?e[h].push(g):(e[h]=[g],a.apply(null,f.concat([function(){c[h]=arguments;var a=e[h];delete e[h];for(var b=0,d=a.length;b<d;b++)a[b].apply(null,arguments)}])))};return f.memo=c,f.unmemoized=a,f},d.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},d.times=function(a,b,c){for(var e=[],f=0;f<a;f++)e.push(f);return d.map(e,b,c)},d.timesSeries=function(a,b,c){for(var e=[],f=0;f<a;f++)e.push(f);return d.mapSeries(e,b,c)},d.seq=function(){var a=arguments;return function(){var b=this,c=Array.prototype.slice.call(arguments),e=c.pop();d.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){e.apply(b,[a].concat(c))})}},d.compose=function(){return d.seq.apply(null,Array.prototype.reverse.call(arguments))};var z=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};d.applyEach=o(z),d.applyEachSeries=q(z),d.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},"undefined"!=typeof c&&c.exports?c.exports=d:"undefined"!=typeof a&&a.amd?a([],function(){return d}):e.async=d}()}).call(this,b("_process"))},{_process:23}],2:[function(a,b,c){"use strict";function g(){for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=0,c=a.length;b<c;++b)d[b]=a[b],e[a.charCodeAt(b)]=b;e["-".charCodeAt(0)]=62,e["_".charCodeAt(0)]=63}function h(a){var b,c,d,g,h,i,j=a.length;if(j%4>0)throw new Error("Invalid string. Length must be a multiple of 4");h="="===a[j-2]?2:"="===a[j-1]?1:0,i=new f(3*j/4-h),d=h>0?j-4:j;var k=0;for(b=0,c=0;b<d;b+=4,c+=3)g=e[a.charCodeAt(b)]<<18|e[a.charCodeAt(b+1)]<<12|e[a.charCodeAt(b+2)]<<6|e[a.charCodeAt(b+3)],i[k++]=g>>16&255,i[k++]=g>>8&255,i[k++]=255&g;return 2===h?(g=e[a.charCodeAt(b)]<<2|e[a.charCodeAt(b+1)]>>4,i[k++]=255&g):1===h&&(g=e[a.charCodeAt(b)]<<10|e[a.charCodeAt(b+1)]<<4|e[a.charCodeAt(b+2)]>>2,i[k++]=g>>8&255,i[k++]=255&g),i}function i(a){return d[a>>18&63]+d[a>>12&63]+d[a>>6&63]+d[63&a]}function j(a,b,c){for(var d,e=[],f=b;f<c;f+=3)d=(a[f]<<16)+(a[f+1]<<8)+a[f+2],e.push(i(d));return e.join("")}function k(a){for(var b,c=a.length,e=c%3,f="",g=[],h=16383,i=0,k=c-e;i<k;i+=h)g.push(j(a,i,i+h>k?k:i+h));return 1===e?(b=a[c-1],f+=d[b>>2],f+=d[b<<4&63],f+="=="):2===e&&(b=(a[c-2]<<8)+a[c-1],f+=d[b>>10],f+=d[b>>4&63],f+=d[b<<2&63],f+="="),g.push(f),g.join("")}c.toByteArray=h,c.fromByteArray=k;var d=[],e=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array;g()},{}],3:[function(a,b,c){},{}],4:[function(a,b,c){(function(b){"use strict";function g(){try{var a=new Uint8Array(1);return a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===a.foo()&&"function"==typeof a.subarray&&0===a.subarray(1,1).byteLength}catch(a){return!1}}function h(){return j.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(a,b){if(h()<b)throw new RangeError("Invalid typed array length");return j.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(b),a.__proto__=j.prototype):(null===a&&(a=new j(b)),a.length=b),a}function j(a,b,c){if(!(j.TYPED_ARRAY_SUPPORT||this instanceof j))return new j(a,b,c);if("number"==typeof a){if("string"==typeof b)throw new Error("If encoding is specified then the first argument must be a string");return n(this,a)}return k(this,a,b,c)}function k(a,b,c,d){if("number"==typeof b)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&b instanceof ArrayBuffer?q(a,b,c,d):"string"==typeof b?o(a,b,c):r(a,b)}function l(a){if("number"!=typeof a)throw new TypeError('"size" argument must be a number');if(a<0)throw new RangeError('"size" argument must not be negative')}function m(a,b,c,d){return l(b),b<=0?i(a,b):void 0!==c?"string"==typeof d?i(a,b).fill(c,d):i(a,b).fill(c):i(a,b)}function n(a,b){if(l(b),a=i(a,b<0?0:0|s(b)),!j.TYPED_ARRAY_SUPPORT)for(var c=0;c<b;++c)a[c]=0;return a}function o(a,b,c){if("string"==typeof c&&""!==c||(c="utf8"),!j.isEncoding(c))throw new TypeError('"encoding" must be a valid string encoding');var d=0|u(b,c);a=i(a,d);var e=a.write(b,c);return e!==d&&(a=a.slice(0,e)),a}function p(a,b){var c=b.length<0?0:0|s(b.length);a=i(a,c);for(var d=0;d<c;d+=1)a[d]=255&b[d];return a}function q(a,b,c,d){if(b.byteLength,c<0||b.byteLength<c)throw new RangeError("'offset' is out of bounds");if(b.byteLength<c+(d||0))throw new RangeError("'length' is out of bounds");return b=void 0===c&&void 0===d?new Uint8Array(b):void 0===d?new Uint8Array(b,c):new Uint8Array(b,c,d),j.TYPED_ARRAY_SUPPORT?(a=b,a.__proto__=j.prototype):a=p(a,b),a}function r(a,b){if(j.isBuffer(b)){var c=0|s(b.length);return a=i(a,c),0===a.length?a:(b.copy(a,0,0,c),a)}if(b){if("undefined"!=typeof ArrayBuffer&&b.buffer instanceof ArrayBuffer||"length"in b)return"number"!=typeof b.length||ba(b.length)?i(a,0):p(a,b);if("Buffer"===b.type&&f(b.data))return p(a,b.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function s(a){if(a>=h())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h().toString(16)+" bytes");return 0|a}function t(a){return+a!=a&&(a=0),j.alloc(+a)}function u(a,b){if(j.isBuffer(a))return a.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":case void 0:return Y(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return _(a).length;default:if(d)return Y(a).length;b=(""+b).toLowerCase(),d=!0}}function v(a,b,c){var d=!1;if((void 0===b||b<0)&&(b=0),b>this.length)return"";if((void 0===c||c>this.length)&&(c=this.length),c<=0)return"";if(c>>>=0,b>>>=0,c<=b)return"";for(a||(a="utf8");;)switch(a){case"hex":return L(this,b,c);case"utf8":case"utf-8":return G(this,b,c);case"ascii":return J(this,b,c);case"latin1":case"binary":return K(this,b,c);case"base64":return F(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function w(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function x(a,b,c,d,e){if(0===a.length)return-1;if("string"==typeof c?(d=c,c=0):c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c=+c,isNaN(c)&&(c=e?0:a.length-1),c<0&&(c=a.length+c),c>=a.length){if(e)return-1;c=a.length-1}else if(c<0){if(!e)return-1;c=0}if("string"==typeof b&&(b=j.from(b,d)),j.isBuffer(b))return 0===b.length?-1:y(a,b,c,d,e);if("number"==typeof b)return b&=255,j.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?e?Uint8Array.prototype.indexOf.call(a,b,c):Uint8Array.prototype.lastIndexOf.call(a,b,c):y(a,[b],c,d,e);throw new TypeError("val must be string, number or Buffer")}function y(a,b,c,d,e){function i(a,b){return 1===f?a[b]:a.readUInt16BE(b*f)}var f=1,g=a.length,h=b.length;if(void 0!==d&&(d=String(d).toLowerCase(),"ucs2"===d||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(a.length<2||b.length<2)return-1;f=2,g/=2,h/=2,c/=2}var j;if(e){var k=-1;for(j=c;j<g;j++)if(i(a,j)===i(b,k===-1?0:j-k)){if(k===-1&&(k=j),j-k+1===h)return k*f}else k!==-1&&(j-=j-k),k=-1}else for(c+h>g&&(c=g-h),j=c;j>=0;j--){for(var l=!0,m=0;m<h;m++)if(i(a,j+m)!==i(b,m)){l=!1;break}if(l)return j}return-1}function z(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new TypeError("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;g<d;++g){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))return g;a[c+g]=h}return g}function A(a,b,c,d){return aa(Y(b,a.length-c),a,c,d)}function B(a,b,c,d){return aa(Z(b),a,c,d)}function C(a,b,c,d){return B(a,b,c,d)}function D(a,b,c,d){return aa(_(b),a,c,d)}function E(a,b,c,d){return aa($(b,a.length-c),a,c,d)}function F(a,b,c){return 0===b&&c===a.length?d.fromByteArray(a):d.fromByteArray(a.slice(b,c))}function G(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;e<c;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(e+h<=c){var i,j,k,l;switch(h){case 1:f<128&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(l<55296||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&l<1114112&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return I(d)}function I(a){var b=a.length;if(b<=H)return String.fromCharCode.apply(String,a);for(var c="",d=0;d<b;)c+=String.fromCharCode.apply(String,a.slice(d,d+=H));return c}function J(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;++e)d+=String.fromCharCode(127&a[e]);return d}function K(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}function L(a,b,c){var d=a.length;(!b||b<0)&&(b=0),(!c||c<0||c>d)&&(c=d);for(var e="",f=b;f<c;++f)e+=X(a[f]);return e}function M(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function N(a,b,c){if(a%1!==0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function O(a,b,c,d,e,f){if(!j.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(b>e||b<f)throw new RangeError('"value" argument is out of bounds');if(c+d>a.length)throw new RangeError("Index out of range")}function P(a,b,c,d){b<0&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);e<f;++e)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function Q(a,b,c,d){b<0&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);e<f;++e)a[c+e]=b>>>8*(d?e:3-e)&255}function R(a,b,c,d,e,f){if(c+d>a.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function S(a,b,c,d,f){return f||R(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(a,b,c,d,23,4),c+4}function T(a,b,c,d,f){return f||R(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(a,b,c,d,52,8),c+8}function V(a){if(a=W(a).replace(U,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function W(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function X(a){return a<16?"0"+a.toString(16):a.toString(16)}function Y(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;g<d;++g){if(c=a.charCodeAt(g),c>55295&&c<57344){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(c<56320){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=(e-55296<<10|c-56320)+65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,c<128){if((b-=1)<0)break;f.push(c)}else if(c<2048){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(c<65536){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(c<1114112))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function Z(a){for(var b=[],c=0;c<a.length;++c)b.push(255&a.charCodeAt(c));return b}function $(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);++g)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function _(a){return d.toByteArray(V(a))}function aa(a,b,c,d){for(var e=0;e<d&&!(e+c>=b.length||e>=a.length);++e)b[e+c]=a[e];return e}function ba(a){return a!==a}var d=a("base64-js"),e=a("ieee754"),f=a("isarray");c.Buffer=j,c.SlowBuffer=t,c.INSPECT_MAX_BYTES=50,j.TYPED_ARRAY_SUPPORT=void 0!==b.TYPED_ARRAY_SUPPORT?b.TYPED_ARRAY_SUPPORT:g(),c.kMaxLength=h(),j.poolSize=8192,j._augment=function(a){return a.__proto__=j.prototype,a},j.from=function(a,b,c){return k(null,a,b,c)},j.TYPED_ARRAY_SUPPORT&&(j.prototype.__proto__=Uint8Array.prototype,j.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&j[Symbol.species]===j&&Object.defineProperty(j,Symbol.species,{value:null,configurable:!0})),j.alloc=function(a,b,c){return m(null,a,b,c)},j.allocUnsafe=function(a){return n(null,a)},j.allocUnsafeSlow=function(a){return n(null,a)},j.isBuffer=function(b){return!(null==b||!b._isBuffer)},j.compare=function(b,c){if(!j.isBuffer(b)||!j.isBuffer(c))throw new TypeError("Arguments must be Buffers");if(b===c)return 0;for(var d=b.length,e=c.length,f=0,g=Math.min(d,e);f<g;++f)if(b[f]!==c[f]){d=b[f],e=c[f];break}return d<e?-1:e<d?1:0},j.isEncoding=function(b){switch(String(b).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},j.concat=function(b,c){if(!f(b))throw new TypeError('"list" argument must be an Array of Buffers');if(0===b.length)return j.alloc(0);var d;if(void 0===c)for(c=0,d=0;d<b.length;++d)c+=b[d].length;var e=j.allocUnsafe(c),g=0;for(d=0;d<b.length;++d){var h=b[d];if(!j.isBuffer(h))throw new TypeError('"list" argument must be an Array of Buffers');h.copy(e,g),g+=h.length}return e},j.byteLength=u,j.prototype._isBuffer=!0,j.prototype.swap16=function(){var b=this.length;if(b%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<b;c+=2)w(this,c,c+1);return this},j.prototype.swap32=function(){var b=this.length;if(b%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<b;c+=4)w(this,c,c+3),w(this,c+1,c+2);return this},j.prototype.swap64=function(){var b=this.length;if(b%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<b;c+=8)w(this,c,c+7),w(this,c+1,c+6),w(this,c+2,c+5),w(this,c+3,c+4);return this},j.prototype.toString=function(){var b=0|this.length;return 0===b?"":0===arguments.length?G(this,0,b):v.apply(this,arguments)},j.prototype.equals=function(b){if(!j.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===j.compare(this,b)},j.prototype.inspect=function(){var b="",d=c.INSPECT_MAX_BYTES;return this.length>0&&(b=this.toString("hex",0,d).match(/.{2}/g).join(" "),this.length>d&&(b+=" ... ")),"<Buffer "+b+">"},j.prototype.compare=function(b,c,d,e,f){if(!j.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(void 0===c&&(c=0),void 0===d&&(d=b?b.length:0),void 0===e&&(e=0),void 0===f&&(f=this.length),c<0||d>b.length||e<0||f>this.length)throw new RangeError("out of range index");if(e>=f&&c>=d)return 0;if(e>=f)return-1;if(c>=d)return 1;if(c>>>=0,d>>>=0,e>>>=0,f>>>=0,this===b)return 0;for(var g=f-e,h=d-c,i=Math.min(g,h),k=this.slice(e,f),l=b.slice(c,d),m=0;m<i;++m)if(k[m]!==l[m]){g=k[m],h=l[m];break}return g<h?-1:h<g?1:0},j.prototype.includes=function(b,c,d){return this.indexOf(b,c,d)!==-1},j.prototype.indexOf=function(b,c,d){return x(this,b,c,d,!0)},j.prototype.lastIndexOf=function(b,c,d){return x(this,b,c,d,!1)},j.prototype.write=function(b,c,d,e){if(void 0===c)e="utf8",d=this.length,c=0;else if(void 0===d&&"string"==typeof c)e=c,d=this.length,c=0;else{if(!isFinite(c))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");c|=0,isFinite(d)?(d|=0,void 0===e&&(e="utf8")):(e=d,d=void 0)}var f=this.length-c;if((void 0===d||d>f)&&(d=f),b.length>0&&(d<0||c<0)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");e||(e="utf8");for(var g=!1;;)switch(e){case"hex":return z(this,b,c,d);case"utf8":case"utf-8":return A(this,b,c,d);case"ascii":return B(this,b,c,d);case"latin1":case"binary":return C(this,b,c,d);case"base64":return D(this,b,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,b,c,d);default:if(g)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),g=!0}},j.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var H=4096;j.prototype.slice=function(b,c){var d=this.length;b=~~b,c=void 0===c?d:~~c,b<0?(b+=d,b<0&&(b=0)):b>d&&(b=d),c<0?(c+=d,c<0&&(c=0)):c>d&&(c=d),c<b&&(c=b);var e;if(j.TYPED_ARRAY_SUPPORT)e=this.subarray(b,c),e.__proto__=j.prototype;else{var f=c-b;e=new j(f,void 0);for(var g=0;g<f;++g)e[g]=this[g+b]}return e},j.prototype.readUIntLE=function(b,c,d){b|=0,c|=0,d||N(b,c,this.length);for(var e=this[b],f=1,g=0;++g<c&&(f*=256);)e+=this[b+g]*f;return e},j.prototype.readUIntBE=function(b,c,d){b|=0,c|=0,d||N(b,c,this.length);for(var e=this[b+--c],f=1;c>0&&(f*=256);)e+=this[b+--c]*f;return e},j.prototype.readUInt8=function(b,c){return c||N(b,1,this.length),this[b]},j.prototype.readUInt16LE=function(b,c){return c||N(b,2,this.length),this[b]|this[b+1]<<8},j.prototype.readUInt16BE=function(b,c){return c||N(b,2,this.length),this[b]<<8|this[b+1]},j.prototype.readUInt32LE=function(b,c){return c||N(b,4,this.length),(this[b]|this[b+1]<<8|this[b+2]<<16)+16777216*this[b+3]},j.prototype.readUInt32BE=function(b,c){return c||N(b,4,this.length),16777216*this[b]+(this[b+1]<<16|this[b+2]<<8|this[b+3])},j.prototype.readIntLE=function(b,c,d){b|=0,c|=0,d||N(b,c,this.length);for(var e=this[b],f=1,g=0;++g<c&&(f*=256);)e+=this[b+g]*f;return f*=128,e>=f&&(e-=Math.pow(2,8*c)),e},j.prototype.readIntBE=function(b,c,d){b|=0,c|=0,d||N(b,c,this.length);for(var e=c,f=1,g=this[b+--e];e>0&&(f*=256);)g+=this[b+--e]*f;return f*=128,g>=f&&(g-=Math.pow(2,8*c)),g},j.prototype.readInt8=function(b,c){return c||N(b,1,this.length),128&this[b]?(255-this[b]+1)*-1:this[b]},j.prototype.readInt16LE=function(b,c){c||N(b,2,this.length);var d=this[b]|this[b+1]<<8;return 32768&d?4294901760|d:d},j.prototype.readInt16BE=function(b,c){c||N(b,2,this.length);var d=this[b+1]|this[b]<<8;return 32768&d?4294901760|d:d},j.prototype.readInt32LE=function(b,c){return c||N(b,4,this.length),this[b]|this[b+1]<<8|this[b+2]<<16|this[b+3]<<24},j.prototype.readInt32BE=function(b,c){return c||N(b,4,this.length),this[b]<<24|this[b+1]<<16|this[b+2]<<8|this[b+3]},j.prototype.readFloatLE=function(b,c){return c||N(b,4,this.length),e.read(this,b,!0,23,4)},j.prototype.readFloatBE=function(b,c){return c||N(b,4,this.length),e.read(this,b,!1,23,4)},j.prototype.readDoubleLE=function(b,c){return c||N(b,8,this.length),e.read(this,b,!0,52,8)},j.prototype.readDoubleBE=function(b,c){return c||N(b,8,this.length),e.read(this,b,!1,52,8)},j.prototype.writeUIntLE=function(b,c,d,e){if(b=+b,c|=0,d|=0,!e){var f=Math.pow(2,8*d)-1;O(this,b,c,d,f,0)}var g=1,h=0;for(this[c]=255&b;++h<d&&(g*=256);)this[c+h]=b/g&255;return c+d},j.prototype.writeUIntBE=function(b,c,d,e){if(b=+b,c|=0,d|=0,!e){var f=Math.pow(2,8*d)-1;O(this,b,c,d,f,0)}var g=d-1,h=1;for(this[c+g]=255&b;--g>=0&&(h*=256);)this[c+g]=b/h&255;return c+d},j.prototype.writeUInt8=function(b,c,d){return b=+b,c|=0,d||O(this,b,c,1,255,0),j.TYPED_ARRAY_SUPPORT||(b=Math.floor(b)),this[c]=255&b,c+1},j.prototype.writeUInt16LE=function(b,c,d){return b=+b,c|=0,d||O(this,b,c,2,65535,0),j.TYPED_ARRAY_SUPPORT?(this[c]=255&b,this[c+1]=b>>>8):P(this,b,c,!0),c+2},j.prototype.writeUInt16BE=function(b,c,d){return b=+b,c|=0,d||O(this,b,c,2,65535,0),j.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=255&b):P(this,b,c,!1),c+2},j.prototype.writeUInt32LE=function(b,c,d){return b=+b,c|=0,d||O(this,b,c,4,4294967295,0),j.TYPED_ARRAY_SUPPORT?(this[c+3]=b>>>24,this[c+2]=b>>>16,this[c+1]=b>>>8,this[c]=255&b):Q(this,b,c,!0),c+4},j.prototype.writeUInt32BE=function(b,c,d){return b=+b,c|=0,d||O(this,b,c,4,4294967295,0),j.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=255&b):Q(this,b,c,!1),c+4},j.prototype.writeIntLE=function(b,c,d,e){if(b=+b,c|=0,!e){var f=Math.pow(2,8*d-1);O(this,b,c,d,f-1,-f)}var g=0,h=1,i=0;for(this[c]=255&b;++g<d&&(h*=256);)b<0&&0===i&&0!==this[c+g-1]&&(i=1),this[c+g]=(b/h>>0)-i&255;return c+d},j.prototype.writeIntBE=function(b,c,d,e){if(b=+b,c|=0,!e){var f=Math.pow(2,8*d-1);O(this,b,c,d,f-1,-f)}var g=d-1,h=1,i=0;for(this[c+g]=255&b;--g>=0&&(h*=256);)b<0&&0===i&&0!==this[c+g+1]&&(i=1),this[c+g]=(b/h>>0)-i&255;return c+d},j.prototype.writeInt8=function(b,c,d){return b=+b,c|=0,d||O(this,b,c,1,127,-128),j.TYPED_ARRAY_SUPPORT||(b=Math.floor(b)),b<0&&(b=255+b+1),this[c]=255&b,c+1},j.prototype.writeInt16LE=function(b,c,d){return b=+b,c|=0,d||O(this,b,c,2,32767,-32768),j.TYPED_ARRAY_SUPPORT?(this[c]=255&b,this[c+1]=b>>>8):P(this,b,c,!0),c+2},j.prototype.writeInt16BE=function(b,c,d){return b=+b,c|=0,d||O(this,b,c,2,32767,-32768),j.TYPED_ARRAY_SUPPORT?(this[c]=b>>>8,this[c+1]=255&b):P(this,b,c,!1),c+2},j.prototype.writeInt32LE=function(b,c,d){return b=+b,c|=0,d||O(this,b,c,4,2147483647,-2147483648),j.TYPED_ARRAY_SUPPORT?(this[c]=255&b,this[c+1]=b>>>8,this[c+2]=b>>>16,this[c+3]=b>>>24):Q(this,b,c,!0),c+4},j.prototype.writeInt32BE=function(b,c,d){return b=+b,c|=0,d||O(this,b,c,4,2147483647,-2147483648),b<0&&(b=4294967295+b+1),j.TYPED_ARRAY_SUPPORT?(this[c]=b>>>24,this[c+1]=b>>>16,this[c+2]=b>>>8,this[c+3]=255&b):Q(this,b,c,!1),c+4},j.prototype.writeFloatLE=function(b,c,d){return S(this,b,c,!0,d)},j.prototype.writeFloatBE=function(b,c,d){return S(this,b,c,!1,d)},j.prototype.writeDoubleLE=function(b,c,d){return T(this,b,c,!0,d);
},j.prototype.writeDoubleBE=function(b,c,d){return T(this,b,c,!1,d)},j.prototype.copy=function(b,c,d,e){if(d||(d=0),e||0===e||(e=this.length),c>=b.length&&(c=b.length),c||(c=0),e>0&&e<d&&(e=d),e===d)return 0;if(0===b.length||0===this.length)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("sourceStart out of bounds");if(e<0)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),b.length-c<e-d&&(e=b.length-c+d);var g,f=e-d;if(this===b&&d<c&&c<e)for(g=f-1;g>=0;--g)b[g+c]=this[g+d];else if(f<1e3||!j.TYPED_ARRAY_SUPPORT)for(g=0;g<f;++g)b[g+c]=this[g+d];else Uint8Array.prototype.set.call(b,this.subarray(d,d+f),c);return f},j.prototype.fill=function(b,c,d,e){if("string"==typeof b){if("string"==typeof c?(e=c,c=0,d=this.length):"string"==typeof d&&(e=d,d=this.length),1===b.length){var f=b.charCodeAt(0);f<256&&(b=f)}if(void 0!==e&&"string"!=typeof e)throw new TypeError("encoding must be a string");if("string"==typeof e&&!j.isEncoding(e))throw new TypeError("Unknown encoding: "+e)}else"number"==typeof b&&(b&=255);if(c<0||this.length<c||this.length<d)throw new RangeError("Out of range index");if(d<=c)return this;c>>>=0,d=void 0===d?this.length:d>>>0,b||(b=0);var g;if("number"==typeof b)for(g=c;g<d;++g)this[g]=b;else{var h=j.isBuffer(b)?b:Y(new j(b,e).toString()),i=h.length;for(g=0;g<d-c;++g)this[g+c]=h[g%i]}return this};var U=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":2,ieee754:8,isarray:11}],5:[function(a,b,c){(function(a){function b(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=a.isBuffer}).call(this,{isBuffer:a("../../is-buffer/index.js")})},{"../../is-buffer/index.js":10}],6:[function(b,c,d){(function(d,e){(function(){"use strict";function f(a){return"function"==typeof a||"object"==typeof a&&null!==a}function g(a){return"function"==typeof a}function h(a){return"object"==typeof a&&null!==a}function p(a){n=a}function q(a){o=a}function w(){var a=d.nextTick,b=d.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(b)&&"0"===b[1]&&"10"===b[2]&&(a=setImmediate),function(){a(C)}}function x(){return function(){m(C)}}function y(){var a=0,b=new t(C),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function z(){var a=new MessageChannel;return a.port1.onmessage=C,function(){a.port2.postMessage(0)}}function A(){return function(){setTimeout(C,1)}}function C(){for(var a=0;a<k;a+=2){var b=B[a],c=B[a+1];b(c),B[a]=void 0,B[a+1]=void 0}k=0}function D(){try{var a=b,c=a("vertx");return m=c.runOnLoop||c.runOnContext,x()}catch(a){return A()}}function F(){}function K(){return new TypeError("You cannot resolve a promise with itself")}function L(){return new TypeError("A promises callback cannot return that same promise.")}function M(a){try{return a.then}catch(a){return J.error=a,J}}function N(a,b,c,d){try{a.call(b,c,d)}catch(a){return a}}function O(a,b,c){o(function(a){var d=!1,e=N(c,b,function(c){d||(d=!0,b!==c?R(a,c):T(a,c))},function(b){d||(d=!0,U(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,U(a,e))},a)}function P(a,b){b._state===H?T(a,b._result):b._state===I?U(a,b._result):V(b,void 0,function(b){R(a,b)},function(b){U(a,b)})}function Q(a,b){if(b.constructor===a.constructor)P(a,b);else{var c=M(b);c===J?U(a,J.error):void 0===c?T(a,b):g(c)?O(a,b,c):T(a,b)}}function R(a,b){a===b?U(a,K()):f(b)?Q(a,b):T(a,b)}function S(a){a._onerror&&a._onerror(a._result),W(a)}function T(a,b){a._state===G&&(a._result=b,a._state=H,0!==a._subscribers.length&&o(W,a))}function U(a,b){a._state===G&&(a._state=I,a._result=b,o(S,a))}function V(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+H]=c,e[f+I]=d,0===f&&a._state&&o(W,a)}function W(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?$(c,d,e,f):e(f);a._subscribers.length=0}}function X(){this.error=null}function Z(a,b){try{return a(b)}catch(a){return Y.error=a,Y}}function $(a,b,c,d){var f,h,i,j,e=g(c);if(e){if(f=Z(c,d),f===Y?(j=!0,h=f.error,f=null):i=!0,b===f)return void U(b,L())}else f=d,i=!0;b._state!==G||(e&&i?R(b,f):j?U(b,h):a===H?T(b,f):a===I&&U(b,f))}function _(a,b){try{b(function(c){R(a,c)},function(c){U(a,c)})}catch(b){U(a,b)}}function aa(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(F),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?T(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&T(c.promise,c._result))):U(c.promise,c._validationError())}function ca(a){return new ba(this,a).promise}function ea(a){function e(a){R(c,a)}function f(a){U(c,a)}var b=this,c=new b(F);if(!j(a))return U(c,new TypeError("You must pass an array to race.")),c;for(var d=a.length,g=0;c._state===G&&g<d;g++)V(b.resolve(a[g]),void 0,e,f);return c}function ga(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(F);return R(c,a),c}function ia(a){var b=this,c=new b(F);return U(c,a),c}function la(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ma(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function oa(a){this._id=ka++,this._state=void 0,this._result=void 0,this._subscribers=[],F!==a&&(g(a)||la(),this instanceof oa||ma(),_(this,a))}function pa(){var a;if("undefined"!=typeof e)a=e;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(a){throw new Error("polyfill failed because global object is unavailable in this environment")}var b=a.Promise;b&&"[object Promise]"===Object.prototype.toString.call(b.resolve())&&!b.cast||(a.Promise=na)}var i;i=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var m,n,E,j=i,k=0,o=({}.toString,function(b,c){B[k]=b,B[k+1]=c,k+=2,2===k&&(n?n(C):E())}),r="undefined"!=typeof window?window:void 0,s=r||{},t=s.MutationObserver||s.WebKitMutationObserver,u="undefined"!=typeof d&&"[object process]"==={}.toString.call(d),v="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,B=new Array(1e3);E=u?w():t?y():v?z():void 0===r&&"function"==typeof b?D():A();var G=void 0,H=1,I=2,J=new X,Y=new X;aa.prototype._validateInput=function(a){return j(a)},aa.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},aa.prototype._init=function(){this._result=new Array(this.length)};var ba=aa;aa.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===G&&e<b;e++)a._eachEntry(d[e],e)},aa.prototype._eachEntry=function(a,b){var c=this,d=c._instanceConstructor;h(a)?a.constructor===d&&a._state!==G?(a._onerror=null,c._settledAt(a._state,b,a._result)):c._willSettleAt(d.resolve(a),b):(c._remaining--,c._result[b]=a)},aa.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===G&&(d._remaining--,a===I?U(e,c):d._result[b]=c),0===d._remaining&&T(e,d._result)},aa.prototype._willSettleAt=function(a,b){var c=this;V(a,void 0,function(a){c._settledAt(H,b,a)},function(a){c._settledAt(I,b,a)})};var da=ca,fa=ea,ha=ga,ja=ia,ka=0,na=oa;oa.all=da,oa.race=fa,oa.resolve=ha,oa.reject=ja,oa._setScheduler=p,oa._setAsap=q,oa._asap=o,oa.prototype={constructor:oa,then:function(a,b){var c=this,d=c._state;if(d===H&&!a||d===I&&!b)return this;var e=new this.constructor(F),f=c._result;if(d){var g=arguments[d-1];o(function(){$(d,e,g,f)})}else V(c,e,a,b);return e},catch:function(a){return this.then(null,a)}};var qa=pa,ra={Promise:na,polyfill:qa};"function"==typeof a&&a.amd?a(function(){return ra}):"undefined"!=typeof c&&c.exports?c.exports=ra:"undefined"!=typeof this&&(this.ES6Promise=ra),qa()}).call(this)}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:23}],7:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;var k=new Error('Uncaught, unspecified "error" event. ('+b+")");throw k.context=b,k}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),c.apply(this,f)}else if(g(c))for(f=Array.prototype.slice.call(arguments,1),j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f);return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned&&(c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function d(){this.removeListener(a,d),c||(c=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var c=!1;return d.listener=b,this.on(a,d),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(e(b))return 1;if(b)return b.length}return 0},d.listenerCount=function(a,b){return a.listenerCount(b)}},{}],8:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],9:[function(a,b,c){"function"==typeof Object.create?b.exports=function(b,c){b.super_=c,b.prototype=Object.create(c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(b,c){b.super_=c;var d=function(){};d.prototype=c.prototype,b.prototype=new d,b.prototype.constructor=b}},{}],10:[function(a,b,c){function d(a){return!!a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}function e(a){return"function"==typeof a.readFloatLE&&"function"==typeof a.slice&&d(a.slice(0,0))}b.exports=function(a){return null!=a&&(d(a)||e(a)||!!a._isBuffer)}},{}],11:[function(a,b,c){var d={}.toString;b.exports=Array.isArray||function(a){return"[object Array]"==d.call(a)}},{}],12:[function(a,b,c){},{}],13:[function(b,c,d){(function(d,e,f){!function(){var g="undefined"!=typeof d&&d.versions&&d.versions.node,h=!g&&("undefined"!=typeof window||"undefined"!=typeof self);h&&"undefined"==typeof e&&("undefined"!=typeof window?e=window:"undefined"!=typeof self?e=self:"undefined"!=typeof $&&(e=$));var i=function(a){function c(){}function G(a){for(var b=[],c=Object.keys(a).sort(),d=0;d<c.length;++d){var e=c[d],f=a[e];ma(f)||(f=[f]);for(var g=0;g<f.length;++g){var h=f[g];if(null!==h){if(!oa(h))throw new E("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:a});b.push({"@value":h,"@language":e.toLowerCase()})}}}return b}function H(a,b){if(ma(b))for(var c=0;c<b.length;++c)b[c]=H(a,b[c]);else if(xa(b))b["@list"]=H(a,b["@list"]);else if(ka(b)){ya(b)&&(b["@id"]=a.getId(b["@id"]));for(var d=Object.keys(b).sort(),e=0;e<d.length;++e){var f=d[e];"@id"!==f&&(b[f]=H(a,b[f]))}}return b}function I(b,c,d){if(null===d||void 0===d)return null;var e=fa(b,c,{vocab:!0});if("@id"===e)return fa(b,d,{base:!0});if("@type"===e)return fa(b,d,{vocab:!0,base:!0});var f=a.getContextValue(b,c,"@type");if("@id"===f||"@graph"===e&&oa(d))return{"@id":fa(b,d,{base:!0})};if("@vocab"===f)return{"@id":fa(b,d,{vocab:!0,base:!0})};if(ja(e))return d;var g={};if(null!==f)g["@type"]=f;else if(oa(d)){var h=a.getContextValue(b,c,"@language");null!==h&&(g["@language"]=h)}return["boolean","number","string"].indexOf(typeof d)===-1&&(d=d.toString()),g["@value"]=d,g}function J(a,b,c){for(var d=[],e=Object.keys(a).sort(),f=0;f<e.length;++f)for(var g=e[f],h=a[g],i=Object.keys(h).sort(),j=0;j<i.length;++j){var k=i[j],l=h[k];if("@type"===k)k=x;else if(ja(k))continue;for(var m=0;m<l.length;++m){var n=l[m],o={};if(o.type=0===g.indexOf("_:")?"blank node":"IRI",o.value=g,za(g)){var p={};if(p.type=0===k.indexOf("_:")?"blank node":"IRI",p.value=k,za(k)&&("blank node"!==p.type||c.produceGeneralizedRdf))if(xa(n))K(n["@list"],b,o,p,d);else{var q=L(n);q&&d.push({subject:o,predicate:p,object:q})}}}}return d}function K(a,b,c,d,e){for(var f={type:"IRI",value:u},g={type:"IRI",value:v},h={type:"IRI",value:w},i=0;i<a.length;++i){var j=a[i],k={type:"blank node",value:b.getId()};e.push({subject:c,predicate:d,object:k}),c=k,d=f;var l=L(j);l&&e.push({subject:c,predicate:d,object:l}),d=g}e.push({subject:c,predicate:d,object:h})}function L(a){var b={};if(wa(a)){b.type="literal";var c=a["@value"],d=a["@type"]||null;sa(c)?(b.value=c.toString(),b.datatype=d||o):qa(c)||d===p?(qa(c)||(c=parseFloat(c)),b.value=c.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),b.datatype=d||p):pa(c)?(b.value=c.toFixed(0),b.datatype=d||q):"@language"in a?(b.value=c,b.datatype=d||B,b.language=a["@language"]):(b.value=c,b.datatype=d||r)}else{var e=ka(a)?a["@id"]:a;b.type=0===e.indexOf("_:")?"blank node":"IRI",b.value=e}return"IRI"!==b.type||za(b.value)?b:null}function M(a,b){if("IRI"===a.type||"blank node"===a.type)return{"@id":a.value};var c={"@value":a.value};if(a.language)c["@language"]=a.language;else{var d=a.datatype;if(d||(d=r),b){if(d===o)"true"===c["@value"]?c["@value"]=!0:"false"===c["@value"]&&(c["@value"]=!1);else if(ra(c["@value"]))if(d===q){var e=parseInt(c["@value"],10);e.toFixed(0)===c["@value"]&&(c["@value"]=e)}else d===p&&(c["@value"]=parseFloat(c["@value"]));[o,q,p,r].indexOf(d)===-1&&(c["@type"]=d)}else d!==r&&(c["@type"]=d)}return c}function N(a,b){for(var c=["subject","predicate","object"],d=0;d<c.length;++d){var e=c[d];if(a[e].type!==b[e].type||a[e].value!==b[e].value)return!1}return a.object.language===b.object.language&&a.object.datatype===b.object.datatype}function Q(b,c,d,e,f,g){if(ma(b))for(var h=0;h<b.length;++h)Q(b[h],c,d,e,void 0,g);else{if(!ka(b))return void(g&&g.push(b));if(wa(b)){if("@type"in b){var i=b["@type"];0===i.indexOf("_:")&&(b["@type"]=i=e.getId(i))}return void(g&&g.push(b))}if("@type"in b)for(var j=b["@type"],h=0;h<j.length;++h){var i=j[h];0===i.indexOf("_:")&&e.getId(i)}ta(f)&&(f=ya(b)?e.getId(b["@id"]):b["@id"]),g&&g.push({"@id":f});var k=c[d],l=k[f]=k[f]||{};l["@id"]=f;for(var m=Object.keys(b).sort(),n=0;n<m.length;++n){var o=m[n];if("@id"!==o)if("@reverse"!==o)if("@graph"!==o)if("@type"!==o&&ja(o)){if("@index"===o&&o in l&&(b[o]!==l[o]||b[o]["@id"]!==l[o]["@id"]))throw new E("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:l});l[o]=b[o]}else{var x=b[o];if(0===o.indexOf("_:")&&(o=e.getId(o)),0!==x.length)for(var y=0;y<x.length;++y){var z=x[y];if("@type"===o&&(z=0===z.indexOf("_:")?e.getId(z):z),ua(z)||va(z)){var A=ya(z)?e.getId(z["@id"]):z["@id"];a.addValue(l,o,{"@id":A},{propertyIsArray:!0,allowDuplicate:!1}),Q(z,c,d,e,A)}else if(xa(z)){var B=[];Q(z["@list"],c,d,e,f,B),z={"@list":B},a.addValue(l,o,z,{propertyIsArray:!0,allowDuplicate:!1})}else Q(z,c,d,e,f),a.addValue(l,o,z,{propertyIsArray:!0,allowDuplicate:!1})}else a.addValue(l,o,[],{propertyIsArray:!0})}else{f in c||(c[f]={});var w="@merged"===d?d:f;Q(b[o],c,w,e)}else{var p={"@id":f},q=b["@reverse"];for(var r in q)for(var s=q[r],t=0;t<s.length;++t){var u=s[t],v=u["@id"];ya(u)&&(v=e.getId(v)),Q(u,c,d,e,v),a.addValue(k[v],r,p,{propertyIsArray:!0,allowDuplicate:!1})}}}}}function R(a){for(var b=a["@default"],c=Object.keys(a).sort(),d=0;d<c.length;++d){var e=c[d];if("@default"!==e){var f=a[e],g=b[e];g?"@graph"in g||(g["@graph"]=[]):b[e]=g={"@id":e,"@graph":[]};for(var h=g["@graph"],i=Object.keys(f).sort(),j=0;j<i.length;++j){var k=f[i[j]];va(k)||h.push(k)}}}return b}function S(a,b,c,d,e){W(c),c=c[0];for(var f=a.options,g={embed:V(c,f,"embed"),explicit:V(c,f,"explicit"),requireAll:V(c,f,"requireAll")},h=X(a,b,c,g),i=Object.keys(h).sort(),j=0;j<i.length;++j){var k=i[j],l=h[k];if("@link"===g.embed&&k in a.link)$(d,e,a.link[k]);else{null===e&&(a.uniqueEmbeds={});var m={};if(m["@id"]=k,a.link[k]=m,"@never"===g.embed||U(l,a.subjectStack))$(d,e,m);else{"@last"===g.embed&&(k in a.uniqueEmbeds&&Z(a,k),a.uniqueEmbeds[k]={parent:d,property:e}),a.subjectStack.push(l);for(var n=Object.keys(l).sort(),o=0;o<n.length;o++){var p=n[o];if(ja(p))m[p]=Aa(l[p]);else if(!g.explicit||p in c)for(var q=l[p],r=0;r<q.length;++r){var s=q[r];if(xa(s)){var t={"@list":[]};$(m,p,t);var u=s["@list"];for(var v in u)if(s=u[v],va(s)){var w=p in c?c[p][0]["@list"]:T(g);S(a,[s["@id"]],w,t,"@list")}else $(t,"@list",Aa(s))}else if(va(s)){var w=p in c?c[p]:T(g);S(a,[s["@id"]],w,m,p)}else $(m,p,Aa(s))}}for(var n=Object.keys(c).sort(),o=0;o<n.length;++o){var p=n[o];if(!ja(p)){var x=c[p][0],y=V(x,f,"omitDefault");if(!(y||p in m)){var z="@null";"@default"in x&&(z=Aa(x["@default"])),ma(z)||(z=[z]),m[p]=[{"@preserve":z}]}}}$(d,e,m),a.subjectStack.pop()}}}}function T(a){var b={};for(var c in a)void 0!==a[c]&&(b["@"+c]=[a[c]]);return[b]}function U(a,b){for(var c=b.length-1;c>=0;--c)if(b[c]["@id"]===a["@id"])return!0;return!1}function V(a,b,c){var d="@"+c,e=d in a?a[d][0]:b[c];return"embed"===c&&(e===!0?e="@last":e===!1?e="@never":"@always"!==e&&"@never"!==e&&"@link"!==e&&(e="@last")),e}function W(a){if(!ma(a)||1!==a.length||!ka(a[0]))throw new E("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:a})}function X(a,b,c,d){for(var e={},f=0;f<b.length;++f){var g=b[f],h=a.subjects[g];Y(h,c,d)&&(e[g]=h)}return e}function Y(b,c,d){if("@type"in c&&(1!==c["@type"].length||!ka(c["@type"][0]))){for(var e=c["@type"],f=0;f<e.length;++f)if(a.hasValue(b,"@type",e[f]))return!0;return!1}var g=!0,h=!1;for(var i in c){if(ja(i)){if("@id"!==i&&"@type"!==i)continue;if(g=!1,"@id"===i&&oa(c[i])){if(b[i]!==c[i])return!1;h=!0;continue}}if(g=!1,i in b){if(ma(c[i])&&0===c[i].length&&void 0!==b[i])return!1;h=!0}else{var j=ma(c[i])&&ka(c[i][0])&&"@default"in c[i][0];if(d.requireAll&&!j)return!1}}return g||h}function Z(b,c){var d=b.uniqueEmbeds,e=d[c],f=e.parent,g=e.property,h={"@id":c};if(ma(f)){for(var i=0;i<f.length;++i)if(a.compareValues(f[i],h)){f[i]=h;break}}else{var j=ma(f[g]);a.removeValue(f,g,h,{propertyIsArray:j}),a.addValue(f,g,h,{propertyIsArray:j})}var k=function(a){for(var b=Object.keys(d),c=0;c<b.length;++c){var e=b[c];e in d&&ka(d[e].parent)&&d[e].parent["@id"]===a&&(delete d[e],k(e))}};k(c)}function $(b,c,d){ka(b)?a.addValue(b,c,d,{propertyIsArray:!0}):b.push(d)}function _(b,c,d){if(ma(c)){for(var e=[],f=0;f<c.length;++f){var g=_(b,c[f],d);null!==g&&e.push(g)}c=e}else if(ka(c)){if("@preserve"in c)return"@null"===c["@preserve"]?null:c["@preserve"];if(wa(c))return c;if(xa(c))return c["@list"]=_(b,c["@list"],d),c;var h=ca(b,"@id");if(h in c){var i=c[h];if(i in d.link){var j=d.link[i].indexOf(c);if(j!==-1)return d.link[i][j];d.link[i].push(c)}else d.link[i]=[c]}for(var k in c){var g=_(b,c[k],d),l=a.getContextValue(b,k,"@container");d.compactArrays&&ma(g)&&1===g.length&&null===l&&(g=g[0]),c[k]=g}}return c}function aa(a,b){return a.length<b.length?-1:b.length<a.length?1:a===b?0:a<b?-1:1}function ba(a,b,c,d,e,f){null===f&&(f="@null");var g=[];if("@id"!==f&&"@reverse"!==f||!va(c))g.push(f);else{"@reverse"===f&&g.push("@reverse");var h=ca(a,c["@id"],null,{vocab:!0});h in a.mappings&&a.mappings[h]&&a.mappings[h]["@id"]===c["@id"]?g.push.apply(g,["@vocab","@id"]):g.push.apply(g,["@id","@vocab"])}g.push("@none");for(var i=a.inverse[b],j=0;j<d.length;++j){var k=d[j];if(k in i)for(var l=i[k][e],m=0;m<g.length;++m){var n=g[m];if(n in l)return l[n]}}return null}function ca(a,b,c,d,e){if(null===b)return b;ta(c)&&(c=null),ta(e)&&(e=!1),d=d||{};var f=a.getInverse();if(ja(b))return b in f?f[b]["@none"]["@type"]["@none"]:b;if(d.vocab&&b in f){var g=a["@language"]||"@none",h=[];ka(c)&&"@index"in c&&h.push("@index");var i="@language",j="@null";if(e)i="@type",j="@reverse",h.push("@set");else if(xa(c)){"@index"in c||h.push("@list");for(var k=c["@list"],l=0===k.length?g:null,m=null,n=0;n<k.length;++n){var o=k[n],p="@none",q="@none";if(wa(o)?"@language"in o?p=o["@language"]:"@type"in o?q=o["@type"]:p="@null":q="@id",null===l?l=p:p!==l&&wa(o)&&(l="@none"),null===m?m=q:q!==m&&(m="@none"),"@none"===l&&"@none"===m)break}l=l||"@none",m=m||"@none","@none"!==m?(i="@type",j=m):j=l}else wa(c)?"@language"in c&&!("@index"in c)?(h.push("@language"),j=c["@language"]):"@type"in c&&(i="@type",j=c["@type"]):(i="@type",j="@id"),h.push("@set");h.push("@none");var r=ba(a,b,c,h,i,j);if(null!==r)return r}if(d.vocab&&"@vocab"in a){var s=a["@vocab"];if(0===b.indexOf(s)&&b!==s){var t=b.substr(s.length);if(!(t in a.mappings))return t}}for(var u=null,v=0,w=[],x=a.fastCurieMap,y=b.length-1;v<y&&b[v]in x;++v)x=x[b[v]],""in x&&w.push(x[""][0]);for(var n=w.length-1;n>=0;--n)for(var z=w[n],A=z.terms,B=0;B<A.length;++B){var C=A[B]+":"+b.substr(z.iri.length),D=!(C in a.mappings)||null===c&&a.mappings[C]["@id"]===b;D&&(null===u||aa(C,u)<0)&&(u=C)}return null!==u?u:d.vocab?b:ha(a["@base"],b)}function da(b,c,d){if(wa(d)){var e=a.getContextValue(b,c,"@type"),f=a.getContextValue(b,c,"@language"),g=a.getContextValue(b,c,"@container"),h="@index"in d&&"@index"!==g;if(!h&&(d["@type"]===e||d["@language"]===f))return d["@value"];var i=Object.keys(d).length,j=1===i||2===i&&"@index"in d&&!h,k="@language"in b,l=oa(d["@value"]),m=b.mappings[c]&&null===b.mappings[c]["@language"];if(j&&(!k||!l||m))return d["@value"];var n={};return h&&(n[ca(b,"@index")]=d["@index"]),"@type"in d?n[ca(b,"@type")]=ca(b,d["@type"],null,{vocab:!0}):"@language"in d&&(n[ca(b,"@language")]=d["@language"]),n[ca(b,"@value")]=d["@value"],n}var o=fa(b,c,{vocab:!0}),e=a.getContextValue(b,c,"@type"),p=ca(b,d["@id"],null,{vocab:"@vocab"===e});if("@id"===e||"@vocab"===e||"@graph"===o)return p;var n={};return n[ca(b,"@id")]=p,n}function ea(a,b,c,d){if(c in d){if(d[c])return;throw new E("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:b,term:c})}if(d[c]=!1,ja(c))throw new E("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:b,term:c});if(""===c)throw new E("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:b});a.mappings[c]&&delete a.mappings[c];var e=b[c];if(null===e||ka(e)&&null===e["@id"])return a.mappings[c]=null,void(d[c]=!0);if(oa(e)&&(e={"@id":e}),!ka(e))throw new E("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:b});var f=a.mappings[c]={};if(f.reverse=!1,"@reverse"in e){if("@id"in e)throw new E("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:b});var g=e["@reverse"];if(!oa(g))throw new E("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});var h=fa(a,g,{vocab:!0,base:!1},b,d);if(!za(h))throw new E("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});f["@id"]=h,f.reverse=!0}else if("@id"in e){var h=e["@id"];if(!oa(h))throw new E("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});if(h!==c){if(h=fa(a,h,{vocab:!0,base:!1},b,d),!za(h)&&!ja(h))throw new E("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});f["@id"]=h}}var i=c.indexOf(":");if(f._termHasColon=i!==-1,!("@id"in f))if(f._termHasColon){var j=c.substr(0,i);if(j in b&&ea(a,b,j,d),a.mappings[j]){var k=c.substr(i+1);f["@id"]=a.mappings[j]["@id"]+k}else f["@id"]=c}else{if(!("@vocab"in a))throw new E("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b,term:c});f["@id"]=a["@vocab"]+c}if(d[c]=!0,"@type"in e){var l=e["@type"];if(!oa(l))throw new E("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:b});if("@id"!==l&&"@vocab"!==l){if(l=fa(a,l,{vocab:!0,base:!1},b,d),!za(l))throw new E("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:b});if(0===l.indexOf("_:"))throw new E("Invalid JSON-LD syntax; an @context @type values must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:b})}f["@type"]=l}if("@container"in e){var m=e["@container"];if("@list"!==m&&"@set"!==m&&"@index"!==m&&"@language"!==m)throw new E("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{code:"invalid container mapping",context:b});if(f.reverse&&"@index"!==m&&"@set"!==m&&null!==m)throw new E("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:b});f["@container"]=m}if("@language"in e&&!("@type"in e)){var n=e["@language"];if(null!==n&&!oa(n))throw new E("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:b});null!==n&&(n=n.toLowerCase()),f["@language"]=n}var h=f["@id"];if("@context"===h||"@preserve"===h)throw new E("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:b})}function fa(b,c,d,e,f){if(null===c||ja(c))return c;if(c=String(c),e&&c in e&&f[c]!==!0&&ea(b,e,c,f),d=d||{},d.vocab){var g=b.mappings[c];if(null===g)return null;if(g)return g["@id"]}var h=c.indexOf(":");if(h!==-1){var i=c.substr(0,h),j=c.substr(h+1);if("_"===i||0===j.indexOf("//"))return c;e&&i in e&&ea(b,e,i,f);var g=b.mappings[i];return g?g["@id"]+j:c}if(d.vocab&&"@vocab"in b)return b["@vocab"]+c;var k=c;return d.base&&(k=a.prependBase(b["@base"],k)),k}function ga(b,c){if(null===b)return c;if(c.indexOf(":")!==-1)return c;oa(b)&&(b=a.url.parse(b||""));var d=a.url.parse(c),e={protocol:b.protocol||""};if(null!==d.authority)e.authority=d.authority,e.path=d.path,e.query=d.query;else if(e.authority=b.authority,""===d.path)e.path=b.path,null!==d.query?e.query=d.query:e.query=b.query;else{if(0===d.path.indexOf("/"))e.path=d.path;else{var f=b.path;""!==d.path&&(f=f.substr(0,f.lastIndexOf("/")+1),f.length>0&&"/"!==f.substr(-1)&&(f+="/"),f+=d.path),e.path=f}e.query=d.query}e.path=La(e.path,!!e.authority);var g=e.protocol;return null!==e.authority&&(g+="//"+e.authority),g+=e.path,null!==e.query&&(g+="?"+e.query),null!==d.fragment&&(g+="#"+d.fragment),""===g&&(g="./"),g}function ha(b,c){if(null===b)return c;oa(b)&&(b=a.url.parse(b||""));var d="";if(""!==b.href?d+=(b.protocol||"")+"//"+(b.authority||""):c.indexOf("//")&&(d+="//"),0!==c.indexOf(d))return c;for(var e=a.url.parse(c.substr(d.length)),f=b.normalizedPath.split("/"),g=e.normalizedPath.split("/"),h=e.fragment||e.query?0:1;f.length>0&&g.length>h&&f[0]===g[0];)f.shift(),g.shift();var i="";if(f.length>0){f.pop();for(var j=0;j<f.length;++j)i+="../"}return i+=g.join("/"),null!==e.query&&(i+="?"+e.query),null!==e.fragment&&(i+="#"+e.fragment),""===i&&(i="./"),i}function ia(b){function d(){var a=this;if(a.inverse)return a.inverse;for(var b=a.inverse={},c=a.fastCurieMap={},d={},g=a["@language"]||"@none",h=a.mappings,i=Object.keys(h).sort(aa),j=0;j<i.length;++j){var k=i[j],l=h[k];if(null!==l){var m=l["@container"]||"@none",n=l["@id"];ma(n)||(n=[n]);for(var o=0;o<n.length;++o){var p=n[o],q=b[p],r=ja(p);if(q)r||l._termHasColon||d[p].push(k);else if(b[p]=q={},!r&&!l._termHasColon){d[p]=[k];var s={iri:p,terms:d[p]};p[0]in c?c[p[0]].push(s):c[p[0]]=[s]}if(q[m]||(q[m]={"@language":{},"@type":{}}),q=q[m],l.reverse)f(l,k,q["@type"],"@reverse");else if("@type"in l)f(l,k,q["@type"],l["@type"]);else if("@language"in l){
var t=l["@language"]||"@null";f(l,k,q["@language"],t)}else f(l,k,q["@language"],g),f(l,k,q["@type"],"@none"),f(l,k,q["@language"],"@none")}}}for(var u in c)e(c,u,1);return b}function e(a,b,c){for(var g,h,d=a[b],f=a[b]={},i=0;i<d.length;++i)g=d[i].iri,h=c>=g.length?"":g[c],h in f?f[h].push(d[i]):f[h]=[d[i]];for(var b in f)""!==b&&e(f,b,c+1)}function f(a,b,c,d){d in c||(c[d]=b)}function g(){var a={};return a["@base"]=this["@base"],a.mappings=Aa(this.mappings),a.clone=this.clone,a.inverse=null,a.getInverse=this.getInverse,"@language"in this&&(a["@language"]=this["@language"]),"@vocab"in this&&(a["@vocab"]=this["@vocab"]),a}var c=a.url.parse(b.base||"");return{"@base":c,mappings:{},inverse:null,getInverse:d,clone:g}}function ja(a){if(!oa(a))return!1;switch(a){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function ka(a){return"[object Object]"===Object.prototype.toString.call(a)}function la(a){return ka(a)&&0===Object.keys(a).length}function ma(a){return Array.isArray(a)}function na(a){if(!oa(a)&&!la(a)){var b=!1;if(ma(a)){b=!0;for(var c=0;c<a.length;++c)if(!oa(a[c])){b=!1;break}}if(!b)throw new E('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:a})}}function oa(a){return"string"==typeof a||"[object String]"===Object.prototype.toString.call(a)}function pa(a){return"number"==typeof a||"[object Number]"===Object.prototype.toString.call(a)}function qa(a){return pa(a)&&String(a).indexOf(".")!==-1}function ra(a){return!isNaN(parseFloat(a))&&isFinite(a)}function sa(a){return"boolean"==typeof a||"[object Boolean]"===Object.prototype.toString.call(a)}function ta(a){return"undefined"==typeof a}function ua(a){var b=!1;if(ka(a)&&!("@value"in a||"@set"in a||"@list"in a)){var c=Object.keys(a).length;b=c>1||!("@id"in a)}return b}function va(a){return ka(a)&&1===Object.keys(a).length&&"@id"in a}function wa(a){return ka(a)&&"@value"in a}function xa(a){return ka(a)&&"@list"in a}function ya(a){var b=!1;return ka(a)&&(b="@id"in a?0===a["@id"].indexOf("_:"):0===Object.keys(a).length||!("@value"in a||"@set"in a||"@list"in a)),b}function za(a){return oa(a)&&a.indexOf(":")!==-1}function Aa(a){if(a&&"object"==typeof a){var b;if(ma(a)){b=[];for(var c=0;c<a.length;++c)b[c]=Aa(a[c])}else if(ka(a)){b={};for(var d in a)b[d]=Aa(a[d])}else b=a.toString();return b}return a}function Ba(b,c,d,e){var f=Object.keys(c).length;if(ma(b)){for(var g=0;g<b.length;++g)Ba(b[g],c,d,e);return f<Object.keys(c).length}if(ka(b)){for(var h in b)if("@context"===h){var i=b[h];if(ma(i))for(var j=i.length,g=0;g<j;++g){var k=i[g];oa(k)&&(k=a.prependBase(e,k),d?(k=c[k],ma(k)?(Array.prototype.splice.apply(i,[g,1].concat(k)),g+=k.length-1,j=i.length):i[g]=k):k in c||(c[k]=!1))}else oa(i)&&(i=a.prependBase(e,i),d?b[h]=c[i]:i in c||(c[i]=!1))}else Ba(b[h],c,d,e);return f<Object.keys(c).length}return!1}function Ca(a,b,c){var d=null,e=b.documentLoader,f=function(a,b,c,e,g){if(Object.keys(b).length>D)return d=new E("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:D}),g(d);var h={},i=function(){Ba(a,h,!0,e),g(null,a)};Ba(a,h,!1,e)||i();var j=[];for(var k in h)h[k]===!1&&j.push(k);for(var l=j.length,m=0;m<j.length;++m)!function(a){if(a in b)return d=new E("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:a}),g(d);var e=Aa(b);e[a]=!0;var j=function(b,j){if(!d){var k=j?j.document:null;if(!b&&oa(k))try{k=JSON.parse(k)}catch(a){b=a}if(b?b=new E("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:a,cause:b}):ka(k)||(b=new E("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:a,cause:b})),b)return d=b,g(d);k="@context"in k?{"@context":k["@context"]}:{"@context":{}},j.contextUrl&&(ma(k["@context"])||(k["@context"]=[k["@context"]]),k["@context"].push(j.contextUrl)),f(k,e,c,a,function(b,c){return b?g(b):(h[a]=c["@context"],l-=1,void(0===l&&i()))})}},k=c(a,j);k&&"then"in k&&k.then(j.bind(null,null),j)}(j[m])};f(a,{},e,b.base,c)}function Da(a){for(var b="(?:<([^:]+:[^>]*)>)",c="(_:(?:[A-Za-z0-9]+))",d='"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"',e="(?:\\^\\^"+b+")",f="(?:@([a-z]+(?:-[a-z0-9]+)*))",g="(?:"+d+"(?:"+e+"|"+f+")?)",h="(?:#.*)?",i="[ \\t]+",j="[ \\t]*",k=/(?:\r\n)|(?:\n)|(?:\r)/g,l=new RegExp("^"+j+h+"$"),m="(?:"+b+"|"+c+")"+i,n=b+i,o="(?:"+b+"|"+c+"|"+g+")"+j,p="(?:\\.|(?:(?:"+b+"|"+c+")"+j+"\\.))",q=new RegExp("^"+j+m+n+o+p+j+h+"$"),s={},t=a.split(k),u=0,v=0;v<t.length;++v){var w=t[v];if(u++,!l.test(w)){var x=w.match(q);if(null===x)throw new E("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:u});var y={};if(ta(x[1])?y.subject={type:"blank node",value:x[2]}:y.subject={type:"IRI",value:x[1]},y.predicate={type:"IRI",value:x[3]},ta(x[4]))if(ta(x[5])){y.object={type:"literal"},ta(x[7])?ta(x[8])?y.object.datatype=r:(y.object.datatype=B,y.object.language=x[8]):y.object.datatype=x[7];var z=x[6].replace(/\\"/g,'"').replace(/\\t/g,"\t").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");y.object.value=z}else y.object={type:"blank node",value:x[5]};else y.object={type:"IRI",value:x[4]};var A="@default";if(ta(x[9])?ta(x[10])||(A=x[10]):A=x[9],A in s){for(var C=!0,D=s[A],F=0;C&&F<D.length;++F)N(D[F],y)&&(C=!1);C&&D.push(y)}else s[A]=[y]}}return s}function Ea(a){var b=[];for(var c in a)for(var d=a[c],e=0;e<d.length;++e){var f=d[e];"@default"===c&&(c=null),b.push(Fa(f,c))}return b.sort().join("")}function Fa(a,b){var c=a.subject,d=a.predicate,e=a.object,f=b||null;"name"in a&&a.name&&(f=a.name.value);var g="";if(g+="IRI"===c.type?"<"+c.value+">":c.value,g+=" ",g+="IRI"===d.type?"<"+d.value+">":d.value,g+=" ","IRI"===e.type)g+="<"+e.value+">";else if("blank node"===e.type)g+=e.value;else{var h=e.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"');g+='"'+h+'"',e.datatype===B?e.language&&(g+="@"+e.language):e.datatype!==r&&(g+="^^<"+e.datatype+">")}return null!==f&&void 0!==f&&(g+=0!==f.indexOf("_:")?" <"+f+">":" "+f),g+=" .\n"}function Ga(a){var b={};b["@default"]=[];for(var c=a.getSubjects(),d=0;d<c.length;++d){var e=c[d];if(null!==e){var f=a.getSubjectTriples(e);if(null!==f){var g=f.predicates;for(var h in g)for(var i=g[h].objects,j=0;j<i.length;++j){var k=i[j],l={};0===e.indexOf("_:")?l.subject={type:"blank node",value:e}:l.subject={type:"IRI",value:e},0===h.indexOf("_:")?l.predicate={type:"blank node",value:h}:l.predicate={type:"IRI",value:h};var o=k.value;if(k.type===z){m||Ka();var p=new m;o="";for(var q=0;q<k.value.length;q++)k.value[q].nodeType===n.ELEMENT_NODE?o+=p.serializeToString(k.value[q]):k.value[q].nodeType===n.TEXT_NODE&&(o+=k.value[q].nodeValue)}l.object={},k.type===A?0===k.value.indexOf("_:")?l.object.type="blank node":l.object.type="IRI":(l.object.type="literal",k.type===y?k.language?(l.object.datatype=B,l.object.language=k.language):l.object.datatype=r:l.object.datatype=k.type),l.object.value=o,b["@default"].push(l)}}}}return b}function Ha(a){this.prefix=a,this.counter=0,this.existing={}}function La(a,b){var c="";0===a.indexOf("/")&&(c="/");for(var d=a.split("/"),e=[];d.length>0;)"."===d[0]||""===d[0]&&d.length>1?d.shift():".."!==d[0]?e.push(d.shift()):(d.shift(),b||e.length>0&&".."!==e[e.length-1]?e.pop():e.push(".."));return c+e.join("/")}a.compact=function(b,c,d,e){function g(a,b,d,f){if(a)return e(a);f.compactArrays&&!f.graph&&ma(b)?1===b.length?b=b[0]:0===b.length&&(b={}):f.graph&&ka(b)&&(b=[b]),ka(c)&&"@context"in c&&(c=c["@context"]),c=Aa(c),ma(c)||(c=[c]);var g=c;c=[];for(var h=0;h<g.length;++h)(!ka(g[h])||Object.keys(g[h]).length>0)&&c.push(g[h]);var i=c.length>0;if(1===c.length&&(c=c[0]),ma(b)){var j=ca(d,"@graph"),k=b;b={},i&&(b["@context"]=c),b[j]=k}else if(ka(b)&&i){var k=b;b={"@context":c};for(var l in k)b[l]=k[l]}e(null,b,d)}if(arguments.length<2)return a.nextTick(function(){e(new TypeError("Could not compact, too few arguments."))});if("function"==typeof d&&(e=d,d={}),d=d||{},null===c)return a.nextTick(function(){e(new E("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"}))});if(null===b)return a.nextTick(function(){e(null,null)});"base"in d||(d.base="string"==typeof b?b:""),"compactArrays"in d||(d.compactArrays=!0),"graph"in d||(d.graph=!1),"skipExpansion"in d||(d.skipExpansion=!1),"documentLoader"in d||(d.documentLoader=a.loadDocument),"link"in d||(d.link=!1),d.link&&(d.skipExpansion=!0);var f=function(b,c,d){return c.skipExpansion?a.nextTick(function(){d(null,b)}):void a.expand(b,c,d)};f(b,d,function(b,f){if(b)return e(new E("Could not expand input before compaction.","jsonld.CompactError",{cause:b}));var h=ia(d);a.processContext(h,c,d,function(a,b){if(a)return e(new E("Could not process context before compaction.","jsonld.CompactError",{cause:a}));var c;try{c=(new F).compact(b,null,f,d)}catch(a){return e(a)}g(null,c,b,d)})})},a.expand=function(b,c,d){function e(a){"base"in c||(c.base=a.documentUrl||"");var b={document:Aa(a.document),remoteContext:{"@context":a.contextUrl}};if("expandContext"in c){var e=Aa(c.expandContext);"object"==typeof e&&"@context"in e?b.expandContext=e:b.expandContext={"@context":e}}Ca(b,c,function(a,b){if(a)return d(a);var e;try{var f=new F,g=ia(c),h=b.document,i=b.remoteContext["@context"];b.expandContext&&(g=f.processContext(g,b.expandContext["@context"],c)),i&&(g=f.processContext(g,i,c)),e=f.expand(g,null,h,c,!1),ka(e)&&"@graph"in e&&1===Object.keys(e).length?e=e["@graph"]:null===e&&(e=[]),ma(e)||(e=[e])}catch(a){return d(a)}d(null,e)})}return arguments.length<1?a.nextTick(function(){d(new TypeError("Could not expand, too few arguments."))}):("function"==typeof c&&(d=c,c={}),c=c||{},"documentLoader"in c||(c.documentLoader=a.loadDocument),"keepFreeFloatingNodes"in c||(c.keepFreeFloatingNodes=!1),void a.nextTick(function(){if("string"==typeof b){var a=function(a,b){if(a)return d(a);try{if(!b.document)throw new E("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof b.document&&(b.document=JSON.parse(b.document))}catch(a){return d(new E("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:a,remoteDoc:b}))}e(b)},f=c.documentLoader(b,a);return void(f&&"then"in f&&f.then(a.bind(null,null),a))}e({contextUrl:null,documentUrl:null,document:b})}))},a.flatten=function(b,c,d,e){return arguments.length<1?a.nextTick(function(){e(new TypeError("Could not flatten, too few arguments."))}):("function"==typeof d?(e=d,d={}):"function"==typeof c&&(e=c,c=null,d={}),d=d||{},"base"in d||(d.base="string"==typeof b?b:""),"documentLoader"in d||(d.documentLoader=a.loadDocument),void a.expand(b,d,function(b,f){if(b)return e(new E("Could not expand input before flattening.","jsonld.FlattenError",{cause:b}));var g;try{g=(new F).flatten(f)}catch(a){return e(a)}return null===c?e(null,g):(d.graph=!0,d.skipExpansion=!0,void a.compact(g,c,d,function(a,b){return a?e(new E("Could not compact flattened output.","jsonld.FlattenError",{cause:a})):void e(null,b)}))}))},a.frame=function(b,c,d,e){function f(c){var g,f=c.document;f?(g=f["@context"],c.contextUrl?(g?ma(g)?g.push(c.contextUrl):g=[g,c.contextUrl]:g=c.contextUrl,f["@context"]=g):g=g||{}):g={},a.expand(b,d,function(b,c){if(b)return e(new E("Could not expand input before framing.","jsonld.FrameError",{cause:b}));var h=Aa(d);h.isFrame=!0,h.keepFreeFloatingNodes=!0,a.expand(f,h,function(b,d){if(b)return e(new E("Could not expand frame before framing.","jsonld.FrameError",{cause:b}));var f;try{f=(new F).frame(c,d,h)}catch(a){return e(a)}h.graph=!0,h.skipExpansion=!0,h.link={},a.compact(f,g,h,function(a,b,c){if(a)return e(new E("Could not compact framed output.","jsonld.FrameError",{cause:a}));var d=ca(c,"@graph");h.link={},b[d]=_(c,b[d],h),e(null,b)})})})}return arguments.length<2?a.nextTick(function(){e(new TypeError("Could not frame, too few arguments."))}):("function"==typeof d&&(e=d,d={}),d=d||{},"base"in d||(d.base="string"==typeof b?b:""),"documentLoader"in d||(d.documentLoader=a.loadDocument),"embed"in d||(d.embed="@last"),d.explicit=d.explicit||!1,"requireAll"in d||(d.requireAll=!0),d.omitDefault=d.omitDefault||!1,void a.nextTick(function(){if("string"==typeof c){var a=function(a,b){if(a)return e(a);try{if(!b.document)throw new E("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof b.document&&(b.document=JSON.parse(b.document))}catch(a){return e(new E("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:a,remoteDoc:b}))}f(b)},b=d.documentLoader(c,a);return void(b&&"then"in b&&b.then(a.bind(null,null),a))}f({contextUrl:null,documentUrl:null,document:c})}))},a.link=function(b,c,d,e){var f={};c&&(f["@context"]=c),f["@embed"]="@link",a.frame(b,f,d,e)},a.objectify=function(b,c,d,e){"function"==typeof d&&(e=d,d={}),d=d||{},"base"in d||(d.base="string"==typeof b?b:""),"documentLoader"in d||(d.documentLoader=a.loadDocument),a.expand(b,d,function(b,f){if(b)return e(new E("Could not expand input before linking.","jsonld.LinkError",{cause:b}));var g;try{g=(new F).flatten(f)}catch(a){return e(a)}d.graph=!0,d.skipExpansion=!0,a.compact(g,c,d,function(b,c,d){if(b)return e(new E("Could not compact flattened output before linking.","jsonld.LinkError",{cause:b}));var f=ca(d,"@graph"),g=c[f][0],h=function(b){if(ka(b)||ma(b)){if(ka(b)){if(h.visited[b["@id"]])return;h.visited[b["@id"]]=!0}for(var c in b){var e=b[c],f="@id"===a.getContextValue(d,c,"@type");if(ma(e)||ka(e)||f)if(oa(e)&&f)b[c]=e=g[e],h(e);else if(ma(e))for(var i=0;i<e.length;++i)oa(e[i])&&f?e[i]=g[e[i]]:ka(e[i])&&"@id"in e[i]&&(e[i]=g[e[i]["@id"]]),h(e[i]);else if(ka(e)){var j=e["@id"];b[c]=e=g[j],h(e)}}}};h.visited={},h(g),c.of_type={};for(var i in g)if("@type"in g[i]){var j=g[i]["@type"];ma(j)||(j=[j]);for(var k=0;k<j.length;++k)j[k]in c.of_type||(c.of_type[j[k]]=[]),c.of_type[j[k]].push(g[i])}e(null,c)})})},a.normalize=function(b,c,d){if(arguments.length<1)return a.nextTick(function(){d(new TypeError("Could not normalize, too few arguments."))});if("function"==typeof c&&(d=c,c={}),c=c||{},"algorithm"in c||(c.algorithm="URGNA2012"),"base"in c||(c.base="string"==typeof b?b:""),"documentLoader"in c||(c.documentLoader=a.loadDocument),"inputFormat"in c){if("application/nquads"!==c.inputFormat)return d(new E("Unknown normalization input format.","jsonld.NormalizeError"));var e=Da(b);(new F).normalize(e,c,d)}else{var f=Aa(c);delete f.format,f.produceGeneralizedRdf=!1,a.toRDF(b,f,function(a,b){return a?d(new E("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:a})):void(new F).normalize(b,c,d)})}},a.fromRDF=function(b,c,d){return arguments.length<1?a.nextTick(function(){d(new TypeError("Could not convert from RDF, too few arguments."))}):("function"==typeof c&&(d=c,c={}),c=c||{},"useRdfType"in c||(c.useRdfType=!1),"useNativeTypes"in c||(c.useNativeTypes=!1),"format"in c||!oa(b)||"format"in c||(c.format="application/nquads"),void a.nextTick(function(){function f(a,b,c){(new F).fromRDF(a,b,c)}var a;if(c.format){if(a=c.rdfParser||l[c.format],!a)return d(new E("Unknown input format.","jsonld.UnknownFormat",{format:c.format}))}else a=function(){return b};var e=!1;try{b=a(b,function(a,b){return e=!0,a?d(a):void f(b,c,d)})}catch(a){if(!e)return d(a);throw a}if(b){if("then"in b)return b.then(function(a){f(a,c,d)},d);f(b,c,d)}}))},a.toRDF=function(b,c,d){return arguments.length<1?a.nextTick(function(){d(new TypeError("Could not convert to RDF, too few arguments."))}):("function"==typeof c&&(d=c,c={}),c=c||{},"base"in c||(c.base="string"==typeof b?b:""),"documentLoader"in c||(c.documentLoader=a.loadDocument),void a.expand(b,c,function(a,b){if(a)return d(new E("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:a}));var e;try{if(e=F.prototype.toRDF(b,c),c.format){if("application/nquads"===c.format)return d(null,Ea(e));throw new E("Unknown output format.","jsonld.UnknownFormat",{format:c.format})}}catch(a){return d(a)}d(null,e)}))},a.createNodeMap=function(b,c,d){return arguments.length<1?a.nextTick(function(){d(new TypeError("Could not create node map, too few arguments."))}):("function"==typeof c&&(d=c,c={}),c=c||{},"base"in c||(c.base="string"==typeof b?b:""),"documentLoader"in c||(c.documentLoader=a.loadDocument),void a.expand(b,c,function(a,b){if(a)return d(new E("Could not expand input before creating node map.","jsonld.CreateNodeMapError",{cause:a}));var e;try{e=(new F).createNodeMap(b,c)}catch(a){return d(a)}d(null,e)}))},a.merge=function(b,c,d,e){function l(a,b){if(!g){if(a)return g=a,e(new E("Could not expand input before flattening.","jsonld.FlattenError",{cause:a}));f.push(b),0===--h&&m(f)}}function m(b){var f=!0;"mergeNodes"in d&&(f=d.mergeNodes);var i,g=d.namer||d.issuer||new Ha("_:b"),h={"@default":{}};try{for(var j=0;j<b.length;++j){var k=b[j];k=a.relabelBlankNodes(k,{issuer:new Ha("_:b"+j+"-")});var l=f||0===j?h:{"@default":{}};if(Q(k,l,"@default",g),l!==h)for(var m in l){var n=l[m];if(m in h){var o=h[m];for(var p in n)p in o||(o[p]=n[p])}else h[m]=n}}i=R(h)}catch(a){return e(a)}for(var q=[],r=Object.keys(i).sort(),s=0;s<r.length;++s){var t=i[r[s]];va(t)||q.push(t)}return null===c?e(null,q):(d.graph=!0,d.skipExpansion=!0,void a.compact(q,c,d,function(a,b){return a?e(new E("Could not compact merged output.","jsonld.MergeError",{cause:a})):void e(null,b)}))}if(arguments.length<1)return a.nextTick(function(){e(new TypeError("Could not merge, too few arguments."))});if(!ma(b))return a.nextTick(function(){e(new TypeError('Could not merge, "docs" must be an array.'))});"function"==typeof d?(e=d,d={}):"function"==typeof c&&(e=c,c=null,d={}),d=d||{};for(var f=[],g=null,h=b.length,i=0;i<b.length;++i){var j={};for(var k in d)j[k]=d[k];a.expand(b[i],j,l)}},a.relabelBlankNodes=function(a,b){b=b||{};var c=b.namer||b.issuer||new Ha("_:b");return H(c,a)},a.prependBase=function(a,b){return ga(a,b)},a.documentLoader=function(b,c){var d=new E("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});return g?c(d,{contextUrl:null,documentUrl:b,document:null}):a.promisify(function(a){a(d)})},a.loadDocument=function(b,c){var d=a.documentLoader(b,c);d&&"then"in d&&d.then(c.bind(null,null),c)},a.promises=function(c){c=c||{};var d=Array.prototype.slice,f=a.promisify,g=c.api||{},h=c.version||"jsonld.js";"string"==typeof c.api&&(c.version||(h=c.api),g={}),g.expand=function(b){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");return f.apply(null,[a.expand].concat(d.call(arguments)))},g.compact=function(b,c){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");var e=function(b,c,d,e){a.compact(b,c,d,function(a,b){e(a,b)})};return f.apply(null,[e].concat(d.call(arguments)))},g.flatten=function(b){if(arguments.length<1)throw new TypeError("Could not flatten, too few arguments.");return f.apply(null,[a.flatten].concat(d.call(arguments)))},g.frame=function(b,c){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");return f.apply(null,[a.frame].concat(d.call(arguments)))},g.fromRDF=function(b){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");return f.apply(null,[a.fromRDF].concat(d.call(arguments)))},g.toRDF=function(b){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");return f.apply(null,[a.toRDF].concat(d.call(arguments)))},g.normalize=function(b){if(arguments.length<1)throw new TypeError("Could not normalize, too few arguments.");return f.apply(null,[a.normalize].concat(d.call(arguments)))},"jsonld.js"===h&&(g.link=function(b,c){if(arguments.length<2)throw new TypeError("Could not link, too few arguments.");return f.apply(null,[a.link].concat(d.call(arguments)))},g.objectify=function(b){return f.apply(null,[a.objectify].concat(d.call(arguments)))},g.createNodeMap=function(b){return f.apply(null,[a.createNodeMap].concat(d.call(arguments)))},g.merge=function(b){return f.apply(null,[a.merge].concat(d.call(arguments)))});try{a.Promise=e.Promise||b("es6-promise").Promise}catch(a){var i=function(){throw new Error("Unable to find a Promise implementation.")};for(var j in g)g[j]=i}return g},a.promisify=function(c){if(!a.Promise)try{a.Promise=e.Promise||b("es6-promise").Promise}catch(a){throw new Error("Unable to find a Promise implementation.")}var d=Array.prototype.slice.call(arguments,1);return new a.Promise(function(a,b){c.apply(null,d.concat(function(c,d){c?b(c):a(d)}))})},a.promises({api:a.promises}),c.prototype=a.promises({version:"json-ld-1.0"}),c.prototype.toString=function(){return this instanceof c?"[object JsonLdProcessor]":"[object JsonLdProcessorPrototype]"},a.JsonLdProcessor=c;var i=!!Object.defineProperty;if(i)try{Object.defineProperty({},"x",{})}catch(a){i=!1}i&&(Object.defineProperty(c,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(c.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:c})),h&&"undefined"==typeof e.JsonLdProcessor&&(i?Object.defineProperty(e,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:c}):e.JsonLdProcessor=c);var j="function"==typeof setImmediate&&setImmediate,k=j?function(a){j(a)}:function(a){setTimeout(a,0)};"object"==typeof d&&"function"==typeof d.nextTick?a.nextTick=d.nextTick:a.nextTick=k,a.setImmediate=j?k:a.nextTick,a.parseLinkHeader=function(a){for(var b={},c=a.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g),d=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,e=0;e<c.length;++e){var f=c[e].match(d);if(f){for(var g={target:f[1]},h=f[2],i=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;f=i.exec(h);)g[f[1]]=void 0===f[2]?f[3]:f[2];var j=g.rel||"";ma(b[j])?b[j].push(g):j in b?b[j]=[b[j],g]:b[j]=g}}return b},a.RequestQueue=function(){this._requests={}},a.RequestQueue.prototype.wrapLoader=function(a){return this._loader=a,this._usePromise=1===a.length,this.add.bind(this)},a.RequestQueue.prototype.add=function(b,c){var d=this;if(!c&&!d._usePromise)throw new Error("callback must be specified.");return d._usePromise?new a.Promise(function(a,c){var e=d._requests[b];e||(e=d._requests[b]=d._loader(b).then(function(a){return delete d._requests[b],a}).catch(function(a){throw delete d._requests[b],a})),e.then(function(b){a(b)}).catch(function(a){c(a)})}):void(b in d._requests?d._requests[b].push(c):(d._requests[b]=[c],d._loader(b,function(a,c){var e=d._requests[b];delete d._requests[b];for(var f=0;f<e.length;++f)e[f](a,c)})))},a.DocumentCache=function(a){this.order=[],this.cache={},this.size=a||50,this.expires=3e4},a.DocumentCache.prototype.get=function(a){if(a in this.cache){var b=this.cache[a];if(b.expires>=+new Date)return b.ctx;delete this.cache[a],this.order.splice(this.order.indexOf(a),1)}return null},a.DocumentCache.prototype.set=function(a,b){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(a),this.cache[a]={ctx:b,expires:+new Date+this.expires}},a.ActiveContextCache=function(a){this.order=[],this.cache={},this.size=a||100},a.ActiveContextCache.prototype.get=function(a,b){var c=JSON.stringify(a),d=JSON.stringify(b),e=this.cache[c];return e&&d in e?e[d]:null},a.ActiveContextCache.prototype.set=function(a,b,c){if(this.order.length===this.size){var d=this.order.shift();delete this.cache[d.activeCtx][d.localCtx]}var e=JSON.stringify(a),f=JSON.stringify(b);this.order.push({activeCtx:e,localCtx:f}),e in this.cache||(this.cache[e]={}),this.cache[e][f]=Aa(c)},a.cache={activeCtx:new a.ActiveContextCache},a.documentLoaders={},a.documentLoaders.jquery=function(b,c){function f(d,e){return 0!==d.indexOf("http:")&&0!==d.indexOf("https:")?e(new E('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:d}),{contextUrl:null,documentUrl:d,document:null}):c.secure&&0!==d.indexOf("https")?e(new E('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:d}),{contextUrl:null,documentUrl:d,document:null}):void b.ajax({url:d,accepts:{json:"application/ld+json, application/json"},headers:{Accept:"application/ld+json, application/json"},dataType:"json",crossDomain:!0,success:function(b,c,f){var g={contextUrl:null,documentUrl:d,document:b},h=f.getResponseHeader("Content-Type"),i=f.getResponseHeader("Link");if(i&&"application/ld+json"!==h){if(i=a.parseLinkHeader(i)[C],ma(i))return e(new E("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:d}),g);i&&(g.contextUrl=i.target)}e(null,g)},error:function(a,b,c){e(new E("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:d,cause:c}),{contextUrl:null,documentUrl:d,document:null})}})}c=c||{};var d=new a.RequestQueue,e="usePromise"in c?c.usePromise:"undefined"!=typeof Promise;return e?d.wrapLoader(function(b){return a.promisify(f,b)}):d.wrapLoader(f)},a.documentLoaders.node=function(c){function k(b,i,j){function o(c,d,f){if(l={contextUrl:null,documentUrl:b,document:f||null},c)return j(new E("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:b,cause:c}),l);var g=h.STATUS_CODES[d.statusCode];if(d.statusCode>=400)return j(new E("URL could not be dereferenced: "+g,"jsonld.InvalidUrl",{code:"loading document failed",url:b,httpStatusCode:d.statusCode}),l);if(d.headers.link&&"application/ld+json"!==d.headers["content-type"]){var m=a.parseLinkHeader(d.headers.link)[C];if(ma(m))return j(new E("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:b}),l);m&&(l.contextUrl=m.target)}return d.statusCode>=300&&d.statusCode<400&&d.headers.location?i.length===e?j(new E("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:b,httpStatusCode:d.statusCode,redirects:i}),l):i.indexOf(b)!==-1?j(new E("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:b,httpStatusCode:d.statusCode,redirects:i}),l):(i.push(b),k(d.headers.location,i,j)):(i.push(b),void j(c,l))}if(0!==b.indexOf("http:")&&0!==b.indexOf("https:"))return j(new E('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:b}),{contextUrl:null,documentUrl:b,document:null});if(c.secure&&0!==b.indexOf("https"))return j(new E('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:b}),{contextUrl:null,documentUrl:b,document:null});var l=null;if(null!==l)return j(null,l);var m={Accept:g};for(var n in c.headers)m[n]=c.headers[n];f({url:b,headers:m,strictSSL:d,followRedirect:!1},o)}c=c||{};var d=!("strictSSL"in c)||c.strictSSL,e="maxRedirects"in c?c.maxRedirects:-1,f="request"in c?c.request:b("request"),g="application/ld+json, application/json",h=b("http"),i=new a.RequestQueue;if(c.usePromise)return i.wrapLoader(function(b){return a.promisify(k,b,[])});var j=c.headers||{};if("Accept"in j||"accept"in j)throw new RangeError('Accept header may not be specified as an option; only "'+g+'" is supported.');return i.wrapLoader(function(a,b){k(a,[],b)})},a.documentLoaders.xhr=function(b){function f(d,e){if(0!==d.indexOf("http:")&&0!==d.indexOf("https:"))return e(new E('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:d}),{contextUrl:null,documentUrl:d,document:null});if(b.secure&&0!==d.indexOf("https"))return e(new E('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:d}),{contextUrl:null,documentUrl:d,document:null});var f=b.xhr||XMLHttpRequest,g=new f;g.onload=function(){if(g.status>=400)return e(new E("URL could not be dereferenced: "+g.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:d,httpStatusCode:g.status}),{contextUrl:null,documentUrl:d,document:null});var h,b={contextUrl:null,documentUrl:d,document:g.response},f=g.getResponseHeader("Content-Type");if(c.test(g.getAllResponseHeaders())&&(h=g.getResponseHeader("Link")),h&&"application/ld+json"!==f){if(h=a.parseLinkHeader(h)[C],ma(h))return e(new E("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:d}),b);h&&(b.contextUrl=h.target)}e(null,b)},g.onerror=function(){e(new E("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:d}),{contextUrl:null,documentUrl:d,document:null})},g.open("GET",d,!0),g.setRequestHeader("Accept","application/ld+json, application/json"),g.send()}b=b||{};var c=/(^|(\r\n))link:/i,d=new a.RequestQueue,e="usePromise"in b?b.usePromise:"undefined"!=typeof Promise;return e?d.wrapLoader(function(b){return a.promisify(f,b)}):d.wrapLoader(f)},a.useDocumentLoader=function(b){if(!(b in a.documentLoaders))throw new E('Unknown document loader type: "'+b+'"',"jsonld.UnknownDocumentLoader",{type:b});a.documentLoader=a.documentLoaders[b].apply(a,Array.prototype.slice.call(arguments,1))},a.processContext=function(b,c){var d={},e=2;arguments.length>3&&(d=arguments[2]||{},e+=1);var f=arguments[e];return"base"in d||(d.base=""),"documentLoader"in d||(d.documentLoader=a.loadDocument),null===c?f(null,ia(d)):(c=Aa(c),ka(c)&&"@context"in c||(c={"@context":c}),void Ca(c,d,function(a,c){if(a)return f(a);try{c=(new F).processContext(b,c,d)}catch(a){return f(a)}f(null,c)}))},a.hasProperty=function(a,b){var c=!1;if(b in a){var d=a[b];c=!ma(d)||d.length>0}return c},a.hasValue=function(b,c,d){var e=!1;if(a.hasProperty(b,c)){var f=b[c],g=xa(f);if(ma(f)||g){g&&(f=f["@list"]);for(var h=0;h<f.length;++h)if(a.compareValues(d,f[h])){e=!0;break}}else ma(d)||(e=a.compareValues(d,f))}return e},a.addValue=function(b,c,d,e){if(e=e||{},"propertyIsArray"in e||(e.propertyIsArray=!1),"allowDuplicate"in e||(e.allowDuplicate=!0),ma(d)){0!==d.length||!e.propertyIsArray||c in b||(b[c]=[]);for(var f=0;f<d.length;++f)a.addValue(b,c,d[f],e)}else if(c in b){var g=!e.allowDuplicate&&a.hasValue(b,c,d);ma(b[c])||g&&!e.propertyIsArray||(b[c]=[b[c]]),g||b[c].push(d)}else b[c]=e.propertyIsArray?[d]:d},a.getValues=function(a,b){var c=a[b]||[];return ma(c)||(c=[c]),c},a.removeProperty=function(a,b){delete a[b]},a.removeValue=function(b,c,d,e){e=e||{},"propertyIsArray"in e||(e.propertyIsArray=!1);var f=a.getValues(b,c).filter(function(b){return!a.compareValues(b,d)});0===f.length?a.removeProperty(b,c):1!==f.length||e.propertyIsArray?b[c]=f:b[c]=f[0]},a.compareValues=function(a,b){return a===b||(!(!wa(a)||!wa(b)||a["@value"]!==b["@value"]||a["@type"]!==b["@type"]||a["@language"]!==b["@language"]||a["@index"]!==b["@index"])||!!(ka(a)&&"@id"in a&&ka(b)&&"@id"in b)&&a["@id"]===b["@id"]);
},a.getContextValue=function(a,b,c){var d=null;if(null===b)return d;if("@language"===c&&c in a&&(d=a[c]),a.mappings[b]){var e=a.mappings[b];ta(c)?d=e:c in e&&(d=e[c])}return d};var l={};if(a.registerRDFParser=function(a,b){l[a]=b},a.unregisterRDFParser=function(a){delete l[a]},g){if("undefined"==typeof m)var m=null;if("undefined"==typeof n)var n={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var o="http://www.w3.org/2001/XMLSchema#boolean",p="http://www.w3.org/2001/XMLSchema#double",q="http://www.w3.org/2001/XMLSchema#integer",r="http://www.w3.org/2001/XMLSchema#string",s="http://www.w3.org/1999/02/22-rdf-syntax-ns#",t=s+"List",u=s+"first",v=s+"rest",w=s+"nil",x=s+"type",y=s+"PlainLiteral",z=s+"XMLLiteral",A=s+"object",B=s+"langString",C="http://www.w3.org/ns/json-ld#context",D=10,E=function(a,b,c){g?(Error.call(this),Error.captureStackTrace(this,this.constructor)):"undefined"!=typeof Error&&(this.stack=(new Error).stack),this.name=b||"jsonld.Error",this.message=a||"An unspecified JSON-LD error occurred.",this.details=c||{}};g?b("util").inherits(E,Error):"undefined"!=typeof Error&&(E.prototype=new Error);var F=function(){};F.prototype.compact=function(b,c,d,e){if(ma(d)){for(var f=[],g=0;g<d.length;++g){var h=this.compact(b,c,d[g],e);null!==h&&f.push(h)}if(e.compactArrays&&1===f.length){var i=a.getContextValue(b,c,"@container");null===i&&(f=f[0])}return f}if(ka(d)){if(e.link&&"@id"in d&&d["@id"]in e.link)for(var j=e.link[d["@id"]],g=0;g<j.length;++g)if(j[g].expanded===d)return j[g].compacted;if(wa(d)||va(d)){var f=da(b,c,d);return e.link&&va(d)&&(d["@id"]in e.link||(e.link[d["@id"]]=[]),e.link[d["@id"]].push({expanded:d,compacted:f})),f}var k="@reverse"===c,f={};e.link&&"@id"in d&&(d["@id"]in e.link||(e.link[d["@id"]]=[]),e.link[d["@id"]].push({expanded:d,compacted:f}));for(var l=Object.keys(d).sort(),m=0;m<l.length;++m){var n=l[m],o=d[n];if("@id"!==n&&"@type"!==n)if("@reverse"!==n)if("@index"!==n)if("@graph"!==n&&"@list"!==n&&ja(n)){var r=ca(b,n);a.addValue(f,r,o)}else{if(0===o.length){var w=ca(b,n,o,{vocab:!0},k);a.addValue(f,w,o,{propertyIsArray:!0})}for(var q=0;q<o.length;++q){var x=o[q],w=ca(b,n,x,{vocab:!0},k),i=a.getContextValue(b,w,"@container"),y=xa(x),z=null;y&&(z=x["@list"]);var A=this.compact(b,w,y?z:x,e);if(y)if(ma(A)||(A=[A]),"@list"!==i){var B={};B[ca(b,"@list")]=A,A=B,"@index"in x&&(A[ca(b,"@index")]=x["@index"])}else if(w in f)throw new E('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"});if("@language"===i||"@index"===i){var C;w in f?C=f[w]:f[w]=C={},"@language"===i&&wa(A)&&(A=A["@value"]),a.addValue(C,x[i],A)}else{var s=!e.compactArrays||"@set"===i||"@list"===i||ma(A)&&0===A.length||"@list"===n||"@graph"===n;a.addValue(f,w,A,{propertyIsArray:s})}}}else{var i=a.getContextValue(b,c,"@container");if("@index"===i)continue;var r=ca(b,n);a.addValue(f,r,o)}else{var p=this.compact(b,"@reverse",o,e);for(var t in p)if(b.mappings[t]&&b.mappings[t].reverse){var u=p[t],i=a.getContextValue(b,t,"@container"),v="@set"===i||!e.compactArrays;a.addValue(f,t,u,{propertyIsArray:v}),delete p[t]}if(Object.keys(p).length>0){var r=ca(b,n);a.addValue(f,r,p)}}else{var p;if(oa(o))p=ca(b,o,null,{vocab:"@type"===n});else{p=[];for(var q=0;q<o.length;++q)p.push(ca(b,o[q],null,{vocab:!0}))}var r=ca(b,n),s=ma(p)&&0===o.length;a.addValue(f,r,p,{propertyIsArray:s})}}return f}return d},F.prototype.expand=function(b,c,d,e,f){var g=this;if(null===d||void 0===d)return null;if(!ma(d)&&!ka(d))return f||null!==c&&"@graph"!==fa(b,c,{vocab:!0})?I(b,c,d):null;if(ma(d)){var h=[],i=a.getContextValue(b,c,"@container");f=f||"@list"===i;for(var j=0;j<d.length;++j){var k=g.expand(b,c,d[j],e);if(f&&(ma(k)||xa(k)))throw new E("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null!==k&&(ma(k)?h=h.concat(k):h.push(k))}return h}"@context"in d&&(b=g.processContext(b,d["@context"],e));for(var l=fa(b,c,{vocab:!0}),h={},m=Object.keys(d).sort(),n=0;n<m.length;++n){var q,o=m[n],p=d[o];if("@context"!==o){var r=fa(b,o,{vocab:!0});if(null!==r&&(za(r)||ja(r))){if(ja(r)){if("@reverse"===l)throw new E("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:p});if(r in h)throw new E("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:r})}if("@id"===r&&!oa(p)){if(!e.isFrame)throw new E('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:p});if(!ka(p))throw new E('Invalid JSON-LD syntax; "@id" value must be a string or an object.',"jsonld.SyntaxError",{code:"invalid @id value",value:p})}if("@type"===r&&na(p),"@graph"===r&&!ka(p)&&!ma(p))throw new E('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:p});if("@value"===r&&(ka(p)||ma(p)))throw new E('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:p});if("@language"===r){if(null===p)continue;if(!oa(p))throw new E('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:p});p=p.toLowerCase()}if("@index"===r&&!oa(p))throw new E('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:p});if("@reverse"!==r){var i=a.getContextValue(b,o,"@container");if("@language"===i&&ka(p))q=G(p);else if("@index"===i&&ka(p))q=function(c){for(var d=[],f=Object.keys(p).sort(),h=0;h<f.length;++h){var i=f[h],j=p[i];ma(j)||(j=[j]),j=g.expand(b,c,j,e,!1);for(var k=0;k<j.length;++k){var l=j[k];"@index"in l||(l["@index"]=i),d.push(l)}}return d}(o);else{var x="@list"===r;if(x||"@set"===r){var y=c;if(x&&"@graph"===l&&(y=null),q=g.expand(b,y,p,e,x),x&&xa(q))throw new E("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else q=g.expand(b,o,p,e,!1)}if(null!==q||"@value"===r)if("@list"===r||xa(q)||"@list"!==i||(q=ma(q)?q:[q],q={"@list":q}),b.mappings[o]&&b.mappings[o].reverse){var t=h["@reverse"]=h["@reverse"]||{};ma(q)||(q=[q]);for(var v=0;v<q.length;++v){var w=q[v];if(wa(w)||xa(w))throw new E('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:q});a.addValue(t,r,w,{propertyIsArray:!0})}}else{var z=["@index","@id","@type","@value","@language"].indexOf(r)===-1;a.addValue(h,r,q,{propertyIsArray:z})}}else{if(!ka(p))throw new E('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:p});if(q=g.expand(b,"@reverse",p,e),"@reverse"in q)for(var s in q["@reverse"])a.addValue(h,s,q["@reverse"][s],{propertyIsArray:!0});var t=h["@reverse"]||null;for(var s in q)if("@reverse"!==s){null===t&&(t=h["@reverse"]={}),a.addValue(t,s,[],{propertyIsArray:!0});for(var u=q[s],v=0;v<u.length;++v){var w=u[v];if(wa(w)||xa(w))throw new E('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:q});a.addValue(t,s,w,{propertyIsArray:!0})}}}}}}m=Object.keys(h);var A=m.length;if("@value"in h){if("@type"in h&&"@language"in h)throw new E('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:h});var B=A-1;if("@type"in h&&(B-=1),"@index"in h&&(B-=1),"@language"in h&&(B-=1),0!==B)throw new E('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:h});if(null===h["@value"])h=null;else{if("@language"in h&&!oa(h["@value"]))throw new E("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:h});if("@type"in h&&(!za(h["@type"])||0===h["@type"].indexOf("_:")))throw new E('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:h})}}else if("@type"in h&&!ma(h["@type"]))h["@type"]=[h["@type"]];else if("@set"in h||"@list"in h){if(A>1&&!(2===A&&"@index"in h))throw new E('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:h});"@set"in h&&(h=h["@set"],m=Object.keys(h),A=m.length)}else 1===A&&"@language"in h&&(h=null);return!ka(h)||e.keepFreeFloatingNodes||f||null!==c&&"@graph"!==l||(0===A||"@value"in h||"@list"in h||1===A&&"@id"in h)&&(h=null),h},F.prototype.createNodeMap=function(a,b){b=b||{};var c=b.namer||b.issuer||new Ha("_:b"),d={"@default":{}};return Q(a,d,"@default",c),R(d)},F.prototype.flatten=function(a){for(var b=this.createNodeMap(a),c=[],d=Object.keys(b).sort(),e=0;e<d.length;++e){var f=b[d[e]];va(f)||c.push(f)}return c},F.prototype.frame=function(a,b,c){var d={options:c,graphs:{"@default":{},"@merged":{}},subjectStack:[],link:{}},e=new Ha("_:b");Q(a,d.graphs,"@merged",e),d.subjects=d.graphs["@merged"];var f=[];return S(d,Object.keys(d.subjects).sort(),b,f,null),f},F.prototype.normalize=function(a,b,c){return"URDNA2015"===b.algorithm?new O(b).main(a,c):"URGNA2012"===b.algorithm?new P(b).main(a,c):void c(new Error("Invalid RDF Dataset Normalization algorithm: "+b.algorithm))},F.prototype.fromRDF=function(b,c,d){var e={},f={"@default":e},g={};for(var h in b){var i=b[h];h in f||(f[h]={}),"@default"===h||h in e||(e[h]={"@id":h});for(var j=f[h],k=0;k<i.length;++k){var l=i[k],m=l.subject.value,n=l.predicate.value,o=l.object;m in j||(j[m]={"@id":m});var p=j[m],q="IRI"===o.type||"blank node"===o.type;if(!q||o.value in j||(j[o.value]={"@id":o.value}),n!==x||c.useRdfType||!q){var r=M(o,c.useNativeTypes);if(a.addValue(p,n,r,{propertyIsArray:!0}),q)if(o.value===w){var s=j[o.value];"usages"in s||(s.usages=[]),s.usages.push({node:p,property:n,value:r})}else o.value in g?g[o.value]=!1:g[o.value]={node:p,property:n,value:r}}else a.addValue(p,"@type",o.value,{propertyIsArray:!0})}}for(var h in f){var y=f[h];if(w in y){for(var z=y[w],A=0;A<z.usages.length;++A){for(var B=z.usages[A],p=B.node,C=B.property,D=B.value,E=[],F=[],G=Object.keys(p).length;C===v&&ka(g[p["@id"]])&&ma(p[u])&&1===p[u].length&&ma(p[v])&&1===p[v].length&&(3===G||4===G&&ma(p["@type"])&&1===p["@type"].length&&p["@type"][0]===t)&&(E.push(p[u][0]),F.push(p["@id"]),B=g[p["@id"]],p=B.node,C=B.property,D=B.value,G=Object.keys(p).length,0===p["@id"].indexOf("_:")););if(C===u){if(p["@id"]===w)continue;D=y[D["@id"]][v][0],E.pop(),F.pop()}delete D["@id"],D["@list"]=E.reverse();for(var H=0;H<F.length;++H)delete y[F[H]]}delete z.usages}}for(var I=[],J=Object.keys(e).sort(),A=0;A<J.length;++A){var K=J[A],p=e[K];if(K in f)for(var i=p["@graph"]=[],y=f[K],L=Object.keys(y).sort(),N=0;N<L.length;++N){var O=y[L[N]];va(O)||i.push(O)}va(p)||I.push(p)}d(null,I)},F.prototype.toRDF=function(a,b){var c=new Ha("_:b"),d={"@default":{}};Q(a,d,"@default",c);for(var e={},f=Object.keys(d).sort(),g=0;g<f.length;++g){var h=f[g];("@default"===h||za(h))&&(e[h]=J(d[h],c,b))}return e},F.prototype.processContext=function(b,c,d){ka(c)&&"@context"in c&&ma(c["@context"])&&(c=c["@context"]);var e=ma(c)?c:[c];if(0===e.length)return b.clone();for(var f=b,g=0;g<e.length;++g){var h=e[g];if(null!==h){if(ka(h)&&"@context"in h&&(h=h["@context"]),!ka(h))throw new E("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:h});if(a.cache.activeCtx){var i=a.cache.activeCtx.get(b,h);if(i){f=b=i;continue}}b=f,f=f.clone();var j={};if("@base"in h){var k=h["@base"];if(null===k)k=null;else{if(!oa(k))throw new E('Invalid JSON-LD syntax; the value of "@base" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:h});if(""!==k&&!za(k))throw new E('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI or the empty string.',"jsonld.SyntaxError",{code:"invalid base IRI",context:h})}null!==k&&(k=a.url.parse(k||"")),f["@base"]=k,j["@base"]=!0}if("@vocab"in h){var l=h["@vocab"];if(null===l)delete f["@vocab"];else{if(!oa(l))throw new E('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:h});if(!za(l))throw new E('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:h});f["@vocab"]=l}j["@vocab"]=!0}if("@language"in h){var l=h["@language"];if(null===l)delete f["@language"];else{if(!oa(l))throw new E('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:h});f["@language"]=l.toLowerCase()}j["@language"]=!0}for(var m in h)ea(f,h,m,j);a.cache.activeCtx&&a.cache.activeCtx.set(b,h,f)}else f=b=ia(d)}return f};var O=function(){var b={subject:"s",object:"o",name:"g"},c=function(a){a=a||{},this.name="URDNA2015",this.options=a,this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new Ha("_:c14n"),this.quads=[],this.schedule={},"maxCallStackDepth"in a?this.schedule.MAX_DEPTH=a.maxCallStackDepth:this.schedule.MAX_DEPTH=500,"maxTotalCallStackDepth"in a?this.schedule.MAX_TOTAL_DEPTH=a.maxCallStackDepth:this.schedule.MAX_TOTAL_DEPTH=4294967295,this.schedule.depth=0,this.schedule.totalDepth=0,"timeSlice"in a?this.schedule.timeSlice=a.timeSlice:this.schedule.timeSlice=10};return c.prototype.doWork=function(b,c){var d=this.schedule;return d.totalDepth>=d.MAX_TOTAL_DEPTH?c(new Error("Maximum total call stack depth exceeded; normalization aborting.")):void function e(){if(d.depth===d.MAX_DEPTH)return d.depth=0,d.running=!1,a.nextTick(e);var f=(new Date).getTime();return d.running||(d.start=(new Date).getTime(),d.deadline=d.start+d.timeSlice),f<d.deadline?(d.running=!0,d.depth++,d.totalDepth++,b(function(a,b){d.depth--,d.totalDepth--,c(a,b)})):(d.depth=0,d.running=!1,void a.setImmediate(e))}()},c.prototype.forEach=function(a,b,c){var e,g,d=this,f=0;if(ma(a))g=a.length,e=function(){return f!==g&&(e.value=a[f++],e.key=f,!0)};else{var h=Object.keys(a);g=h.length,e=function(){return f!==g&&(e.key=h[f++],e.value=a[e.key],!0)}}!function a(f,g){return f?c(f):e()?d.doWork(function(){b(e.value,e.key,a)}):void c()}()},c.prototype.waterfall=function(a,b){var c=this;c.forEach(a,function(a,b,d){c.doWork(a,d)},b)},c.prototype.whilst=function(a,b,c){var d=this;!function e(f){return f?c(f):a()?void d.doWork(b,e):c()}()},c.prototype.main=function(a,b){var c=this;c.schedule.start=(new Date).getTime();var d;if(c.options.format&&"application/nquads"!==c.options.format)return b(new E("Unknown output format.","jsonld.UnknownFormat",{format:c.options.format}));var e={};c.waterfall([function(b){c.forEach(a,function(a,b,d){"@default"===b&&(b=null),c.forEach(a,function(a,d,f){null!==b&&(0===b.indexOf("_:")?a.name={type:"blank node",value:b}:a.name={type:"IRI",value:b}),c.quads.push(a),c.forEachComponent(a,function(b){if("blank node"===b.type){var d=b.value;d in c.blankNodeInfo?c.blankNodeInfo[d].quads.push(a):(e[d]=!0,c.blankNodeInfo[d]={quads:[a]})}}),f()},d)},b)},function(a){var b=!0;c.whilst(function(){return b},function(a){b=!1,c.hashToBlankNodes={},c.waterfall([function(a){c.forEach(e,function(a,b,d){c.hashFirstDegreeQuads(b,function(a,e){return a?d(a):(e in c.hashToBlankNodes?c.hashToBlankNodes[e].push(b):c.hashToBlankNodes[e]=[b],void d())})},a)},function(a){var d=Object.keys(c.hashToBlankNodes).sort();c.forEach(d,function(a,d,f){var g=c.hashToBlankNodes[a];if(g.length>1)return f();var h=g[0];c.canonicalIssuer.getId(h),delete e[h],delete c.hashToBlankNodes[a],b=!0,f()},a)}],a)},a)},function(a){var b=Object.keys(c.hashToBlankNodes).sort();c.forEach(b,function(a,b,d){var e=[],f=c.hashToBlankNodes[a];c.waterfall([function(a){c.forEach(f,function(a,b,d){if(c.canonicalIssuer.hasId(a))return d();var f=new Ha("_:b");f.getId(a),c.hashNDegreeQuads(a,f,function(a,b){return a?d(a):(e.push(b),void d())})},a)},function(a){e.sort(function(a,b){return a.hash<b.hash?-1:a.hash>b.hash?1:0}),c.forEach(e,function(a,b,d){for(var e in a.issuer.existing)c.canonicalIssuer.getId(e);d()},a)}],d)},a)},function(a){var b=[];c.waterfall([function(a){c.forEach(c.quads,function(a,d,e){c.forEachComponent(a,function(a){"blank node"===a.type&&0!==a.value.indexOf(c.canonicalIssuer.prefix)&&(a.value=c.canonicalIssuer.getId(a.value))}),b.push(Fa(a)),e()},a)},function(a){return b.sort(),"application/nquads"===c.options.format?(d=b.join(""),a()):(d=Da(b.join("")),void a())}],a)}],function(a){b(a,d)})},c.prototype.hashFirstDegreeQuads=function(a,b){var c=this,d=c.blankNodeInfo[a];if("hash"in d)return b(null,d.hash);var e=[],f=d.quads;c.forEach(f,function(b,d,f){var g={predicate:b.predicate};c.forEachComponent(b,function(b,d){g[d]=c.modifyFirstDegreeComponent(a,b,d)}),e.push(Fa(g)),f()},function(a){return a?b(a):(e.sort(),d.hash=Ja.hashNQuads(c.name,e),void b(null,d.hash))})},c.prototype.modifyFirstDegreeComponent=function(a,b){return"blank node"!==b.type?b:(b=Aa(b),b.value=b.value===a?"_:a":"_:z",b)},c.prototype.hashRelatedBlankNode=function(a,b,c,d,e){var g,f=this;f.waterfall([function(b){return f.canonicalIssuer.hasId(a)?(g=f.canonicalIssuer.getId(a),b()):c.hasId(a)?(g=c.getId(a),b()):void f.hashFirstDegreeQuads(a,function(a,c){return a?b(a):(g=c,void b())})}],function(a){if(a)return e(a);var c=new Ja(f.name);return c.update(d),"g"!==d&&c.update(f.getRelatedPredicate(b)),c.update(g),e(null,c.digest())})},c.prototype.getRelatedPredicate=function(a){return"<"+a.predicate.value+">"},c.prototype.hashNDegreeQuads=function(a,b,c){var e,d=this,f=new Ja(d.name);d.waterfall([function(c){d.createHashToRelated(a,b,function(a,b){return a?c(a):(e=b,void c())})},function(a){var c=Object.keys(e).sort();d.forEach(c,function(a,c,g){f.update(a);var i,h="",j=new Ia(e[a]);d.whilst(function(){return j.hasNext()},function(a){var c=j.next(),e=b.clone(),f="",g=[];d.waterfall([function(b){d.forEach(c,function(b,c,i){return d.canonicalIssuer.hasId(b)?f+=d.canonicalIssuer.getId(b):(e.hasId(b)||g.push(b),f+=e.getId(b)),0!==h.length&&f.length>=h.length&&f>h?a():void i()},b)},function(b){d.forEach(g,function(b,c,g){d.hashNDegreeQuads(b,e,function(c,d){return c?g(c):(f+=e.getId(b),f+="<"+d.hash+">",e=d.issuer,0!==h.length&&f.length>=h.length&&f>h?a():void g())})},b)},function(a){(0===h.length||f<h)&&(h=f,i=e),a()}],a)},function(a){return a?g(a):(f.update(h),b=i,void g())})},a)}],function(a){c(a,{hash:f.digest(),issuer:b})})},c.prototype.createHashToRelated=function(a,c,d){var e=this,f={},g=e.blankNodeInfo[a].quads;e.forEach(g,function(d,g,h){e.forEach(d,function(g,h,i){if("predicate"===h||"blank node"!==g.type||g.value===a)return i();var j=g.value,k=b[h];e.hashRelatedBlankNode(j,d,c,k,function(a,b){return a?i(a):(b in f?f[b].push(j):f[b]=[j],void i())})},h)},function(a){d(a,f)})},c.prototype.forEachComponent=function(a,b){for(var c in a)"predicate"!==c&&b(a[c],c,a)},c}(),P=function(){var a=function(a){O.call(this,a),this.name="URGNA2012"};return a.prototype=new O,a.prototype.modifyFirstDegreeComponent=function(a,b,c){return"blank node"!==b.type?b:(b=Aa(b),"name"===c?b.value="_:g":b.value=b.value===a?"_:a":"_:z",b)},a.prototype.getRelatedPredicate=function(a){return a.predicate.value},a.prototype.createHashToRelated=function(a,b,c){var d=this,e={},f=d.blankNodeInfo[a].quads;d.forEach(f,function(c,f,g){var h,i;if("blank node"===c.subject.type&&c.subject.value!==a)i=c.subject.value,h="p";else{if("blank node"!==c.object.type||c.object.value===a)return g();i=c.object.value,h="r"}d.hashRelatedBlankNode(i,c,b,h,function(a,b){b in e?e[b].push(i):e[b]=[i],g()})},function(a){c(a,e)})},a}();Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}),a.registerRDFParser("application/nquads",Da),a.registerRDFParser("rdfa-api",Ga),a.IdentifierIssuer=Ha,a.UniqueNamer=Ha,Ha.prototype.clone=function(){var a=new Ha(this.prefix);return a.counter=this.counter,a.existing=Aa(this.existing),a},Ha.prototype.getId=function(a){if(a&&a in this.existing)return this.existing[a];var b=this.prefix+this.counter;return this.counter+=1,a&&(this.existing[a]=b),b},Ha.prototype.getName=Ha.prototype.getName,Ha.prototype.hasId=function(a){return a in this.existing},Ha.prototype.isNamed=Ha.prototype.hasId;var Ia=function(a){this.list=a.sort(),this.done=!1,this.left={};for(var b=0;b<a.length;++b)this.left[a[b]]=!0};Ia.prototype.hasNext=function(){return!this.done},Ia.prototype.next=function(){for(var a=this.list.slice(),b=null,c=0,d=this.list.length,e=0;e<d;++e){var f=this.list[e],g=this.left[f];(null===b||f>b)&&(g&&e>0&&f>this.list[e-1]||!g&&e<d-1&&f>this.list[e+1])&&(b=f,c=e)}if(null===b)this.done=!0;else{var h=this.left[b]?c-1:c+1;this.list[c]=this.list[h],this.list[h]=b;for(var e=0;e<d;++e)this.list[e]>b&&(this.left[this.list[e]]=!this.left[this.list[e]])}return a};var Ja=function(a){if(!(this instanceof Ja))return new Ja(a);if(["URDNA2015","URGNA2012"].indexOf(a)===-1)throw new Error("Invalid RDF Dataset Normalization algorithm: "+a);Ja._init.call(this,a)};if(Ja.hashNQuads=function(a,b){for(var c=new Ja(a),d=0;d<b.length;++d)c.update(b[d]);return c.digest()},function(a){if(a){var c=b("crypto");return Ja._init=function(a){a="URDNA2015"===a?"sha256":"sha1",this.md=c.createHash(a)},Ja.prototype.update=function(a){return this.md.update(a,"utf8")},void(Ja.prototype.digest=function(){return this.md.digest("hex")})}Ja._init=function(a){a="URDNA2015"===a?new f.Algorithm:new e.Algorithm,this.md=new d(a)},Ja.prototype.update=function(a){return this.md.update(a)},Ja.prototype.digest=function(){return this.md.digest().toHex()};var d=function(a){if(!(this instanceof d))return new d(a);if(this._algorithm=a,!d._padding||d._padding.length<this._algorithm.blockSize){d._padding=String.fromCharCode(128);for(var b=String.fromCharCode(0),c=64;c>0;)1&c&&(d._padding+=b),c>>>=1,c>0&&(b+=b)}this.start()};d.prototype.start=function(){this.messageLength=0,this.fullMessageLength=[];for(var a=this._algorithm.messageLengthSize/4,b=0;b<a;++b)this.fullMessageLength.push(0);return this._input=new d.ByteBuffer,this.state=this._algorithm.start(),this},d.prototype.update=function(a){a=new d.ByteBuffer(unescape(encodeURIComponent(a))),this.messageLength+=a.length();var b=a.length();b=[b/4294967296>>>0,b>>>0];for(var c=this.fullMessageLength.length-1;c>=0;--c)this.fullMessageLength[c]+=b[1],b[1]=b[0]+(this.fullMessageLength[c]/4294967296>>>0),this.fullMessageLength[c]=this.fullMessageLength[c]>>>0,b[0]=b[1]/4294967296>>>0;for(this._input.putBytes(a.bytes());this._input.length()>=this._algorithm.blockSize;)this.state=this._algorithm.digest(this.state,this._input);return(this._input.read>2048||0===this._input.length())&&this._input.compact(),this},d.prototype.digest=function(){var a=new d.ByteBuffer;a.putBytes(this._input.bytes());var b=this.fullMessageLength[this.fullMessageLength.length-1]+this._algorithm.messageLengthSize,c=b&this._algorithm.blockSize-1;a.putBytes(d._padding.substr(0,this._algorithm.blockSize-c));for(var e=new d.ByteBuffer,f=0;f<this.fullMessageLength.length;++f)e.putInt32(this.fullMessageLength[f]<<3|this.fullMessageLength[f+1]>>>28);this._algorithm.writeMessageLength(a,e);var g=this._algorithm.digest(this.state.copy(),a),h=new d.ByteBuffer;return g.write(h),h},d.ByteBuffer=function(a){"string"==typeof a?this.data=a:this.data="",this.read=0},d.ByteBuffer.prototype.putInt32=function(a){this.data+=String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a)},d.ByteBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,a},d.ByteBuffer.prototype.putBytes=function(a){this.data+=a},d.ByteBuffer.prototype.bytes=function(){return this.data.slice(this.read)},d.ByteBuffer.prototype.length=function(){return this.data.length-this.read},d.ByteBuffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},d.ByteBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var c=this.data.charCodeAt(b);c<16&&(a+="0"),a+=c.toString(16)}return a};var e={_w:null};e.Algorithm=function(){this.name="sha1",this.blockSize=64,this.digestLength=20,this.messageLengthSize=8},e.Algorithm.prototype.start=function(){return e._w||(e._w=new Array(80)),e._createState()},e.Algorithm.prototype.writeMessageLength=function(a,b){a.putBytes(b.bytes())},e.Algorithm.prototype.digest=function(a,b){for(var c,d,f,g,h,i,j,k,l=b.length(),m=e._w;l>=64;){for(d=a.h0,f=a.h1,g=a.h2,h=a.h3,i=a.h4,k=0;k<16;++k)c=b.getInt32(),m[k]=c,j=h^f&(g^h),c=(d<<5|d>>>27)+j+i+1518500249+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;for(;k<20;++k)c=m[k-3]^m[k-8]^m[k-14]^m[k-16],c=c<<1|c>>>31,m[k]=c,j=h^f&(g^h),c=(d<<5|d>>>27)+j+i+1518500249+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;for(;k<32;++k)c=m[k-3]^m[k-8]^m[k-14]^m[k-16],c=c<<1|c>>>31,m[k]=c,j=f^g^h,c=(d<<5|d>>>27)+j+i+1859775393+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;for(;k<40;++k)c=m[k-6]^m[k-16]^m[k-28]^m[k-32],c=c<<2|c>>>30,m[k]=c,j=f^g^h,c=(d<<5|d>>>27)+j+i+1859775393+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;for(;k<60;++k)c=m[k-6]^m[k-16]^m[k-28]^m[k-32],c=c<<2|c>>>30,m[k]=c,j=f&g|h&(f^g),c=(d<<5|d>>>27)+j+i+2400959708+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;for(;k<80;++k)c=m[k-6]^m[k-16]^m[k-28]^m[k-32],c=c<<2|c>>>30,m[k]=c,j=f^g^h,c=(d<<5|d>>>27)+j+i+3395469782+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;a.h0=a.h0+d|0,a.h1=a.h1+f|0,a.h2=a.h2+g|0,a.h3=a.h3+h|0,a.h4=a.h4+i|0,l-=64}return a},e._createState=function(){var a={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520};return a.copy=function(){var b=e._createState();return b.h0=a.h0,b.h1=a.h1,b.h2=a.h2,b.h3=a.h3,b.h4=a.h4,b},a.write=function(b){b.putInt32(a.h0),b.putInt32(a.h1),b.putInt32(a.h2),b.putInt32(a.h3),b.putInt32(a.h4)},a};var f={_k:null,_w:null};f.Algorithm=function(){this.name="sha256",this.blockSize=64,this.digestLength=32,this.messageLengthSize=8},f.Algorithm.prototype.start=function(){return f._k||f._init(),f._createState()},f.Algorithm.prototype.writeMessageLength=function(a,b){a.putBytes(b.bytes())},f.Algorithm.prototype.digest=function(a,b){for(var c,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s=b.length(),t=f._k,u=f._w;s>=64;){for(j=0;j<16;++j)u[j]=b.getInt32();for(;j<64;++j)c=u[j-2],c=(c>>>17|c<<15)^(c>>>19|c<<13)^c>>>10,d=u[j-15],d=(d>>>7|d<<25)^(d>>>18|d<<14)^d>>>3,u[j]=c+u[j-7]+d+u[j-16]|0;for(k=a.h0,l=a.h1,m=a.h2,n=a.h3,o=a.h4,p=a.h5,q=a.h6,r=a.h7,j=0;j<64;++j)g=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),h=q^o&(p^q),e=(k>>>2|k<<30)^(k>>>13|k<<19)^(k>>>22|k<<10),i=k&l|m&(k^l),c=r+g+h+t[j]+u[j],d=e+i,r=q,q=p,p=o,o=n+c|0,n=m,m=l,l=k,k=c+d|0;a.h0=a.h0+k|0,a.h1=a.h1+l|0,a.h2=a.h2+m|0,a.h3=a.h3+n|0,a.h4=a.h4+o|0,a.h5=a.h5+p|0,a.h6=a.h6+q|0,a.h7=a.h7+r|0,s-=64}return a},f._createState=function(){var a={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225};return a.copy=function(){var b=f._createState();return b.h0=a.h0,b.h1=a.h1,b.h2=a.h2,b.h3=a.h3,b.h4=a.h4,b.h5=a.h5,b.h6=a.h6,b.h7=a.h7,b},a.write=function(b){b.putInt32(a.h0),b.putInt32(a.h1),b.putInt32(a.h2),b.putInt32(a.h3),b.putInt32(a.h4),b.putInt32(a.h5),b.putInt32(a.h6),b.putInt32(a.h7)},a},f._init=function(){f._k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],f._w=new Array(64)}}(g),!m)var Ka=function(){m=b("xmldom").XMLSerializer};if(a.url={},a.url.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},a.url.parse=function(b,c){for(var d={},e=a.url.parsers[c||"full"],f=e.regex.exec(b),g=e.keys.length;g--;)d[e.keys[g]]=void 0===f[g]?null:f[g];return d.normalizedPath=La(d.path,!!d.authority),d},g?a.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&a.useDocumentLoader("xhr"),g){a.use=function(c){switch(c){case"request":a.request=b("jsonld-request");break;default:throw new E("Unknown extension.","jsonld.UnknownExtension",{extension:c})}};var Ma={exports:{},filename:f};b("pkginfo")(Ma,"version"),a.version=Ma.exports.version}return a},j=function(){return i(function(){return j()})};return!g&&"function"==typeof a&&a.amd?a([],function(){return i(j),j}):(i(j),"function"==typeof b&&"undefined"!=typeof c&&c.exports&&(c.exports=j),h&&("undefined"==typeof jsonld?jsonld=jsonldjs=j:jsonldjs=j)),j}()}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},"/node_modules/jsonld/js")},{_process:23,crypto:12,"es6-promise":6,http:12,"jsonld-request":12,pkginfo:12,request:12,util:12,xmldom:12}],14:[function(a,b,c){var d=a;a=function(){};var c=b.exports={Lexer:a("./lib/N3Lexer"),Parser:a("./lib/N3Parser"),Writer:a("./lib/N3Writer"),Store:a("./lib/N3Store"),StreamParser:a("./lib/N3StreamParser"),StreamWriter:a("./lib/N3StreamWriter"),Util:a("./lib/N3Util")};Object.keys(c).forEach(function(a){Object.defineProperty(c,a,{configurable:!0,enumerable:!0,get:function(){return delete c[a],c[a]=d("./lib/N3"+a)}})})},{"./lib/N3Lexer":15,"./lib/N3Parser":16,"./lib/N3Store":17,"./lib/N3StreamParser":18,"./lib/N3StreamWriter":19,"./lib/N3Util":20,"./lib/N3Writer":21}],15:[function(a,b,c){function i(a){if(!(this instanceof i))return new i(a);if(a&&a.lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var b=this;this._tokenize=this.tokenize,this.tokenize=function(a,c){this._tokenize(a,function(a,d){!a&&/^(?:IRI|prefixed|literal|langcode|type|\.|eof)$/.test(d.type)?c&&c(a,d):c&&c(a||b._syntaxError(d.type,c=null))})}}}var d=String.fromCharCode,e="function"==typeof setImmediate?setImmediate:function(b){setTimeout(b,0)},f=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,g={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},h=/[\x00-\x20<>\\"\{\}\|\^\`]/;i.prototype={_iri:/^<((?:[^>\\]|\\[uU])+)>/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>/,_unescapedString:/^"[^"\\]+"(?=[^"\\])/,_singleQuotedString:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,
_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?=\.?[,;\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=[.,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;:\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<:])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(a,b){function o(b){a(b._syntaxError(/^\S*/.exec(c)[0]))}for(var c=this._input;;){for(var d;d=this._newline.exec(c);)c=c.substr(d[0].length,c.length),this._line++;if((d=this._whitespace.exec(c))&&(c=c.substr(d[0].length,c.length)),this._endOfFile.test(c))return b&&a(c=null,{line:this._line,type:"eof",value:"",prefix:""}),this._input=c;var m,e=this._line,f="",g="",i="",j=c[0],k=null,l=0,n=!1;switch(j){case"^":if(1===c.length)break;if("^"!==c[1])return o(this);if(this._prevTokenType="^",c=c.substr(2),"<"!==c[0]){n=!0;break}case"<":if(k=this._unescapedIri.exec(c))f="IRI",g=k[1];else if(k=this._iri.exec(c)){if(m=this._unescape(k[1]),null===m||h.test(m))return o(this);f="IRI",g=m}break;case"_":((k=this._blank.exec(c))||b&&(k=this._blank.exec(c+" ")))&&(f="prefixed",i="_",g=k[1]);break;case'"':case"'":if(k=this._unescapedString.exec(c))f="literal",g=k[0];else if(k=this._singleQuotedString.exec(c)){if(m=this._unescape(k[0]),null===m)return o(this);f="literal",g=m.replace(/^'|'$/g,'"')}else if(k=this._tripleQuotedString.exec(c)){if(m=k[1]||k[2],this._line+=m.split(/\r\n|\r|\n/).length-1,m=this._unescape(m),null===m)return o(this);f="literal",g=m.replace(/^'|'$/g,'"')}break;case"@":"literal"===this._prevTokenType&&(k=this._langcode.exec(c))?(f="langcode",g=k[1]):(k=this._keyword.exec(c))&&(f=k[0]);break;case".":if(1===c.length?b:c[1]<"0"||c[1]>"9"){f=".",l=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(k=this._number.exec(c))&&(f="literal",g='"'+k[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(k[1]?"double":/^[+\-]?\d+$/.test(k[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(k=this._sparqlKeyword.exec(c))?f=k[0].toUpperCase():n=!0;break;case"f":case"t":(k=this._boolean.exec(c))?(f="literal",g='"'+k[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):n=!0;break;case"a":(k=this._shortPredicates.exec(c))?(f="abbreviation",g="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):n=!0;break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":l=1,f=j;break;default:n=!0}if(n&&("@prefix"!==this._prevTokenType&&"PREFIX"!==this._prevTokenType||!(k=this._prefix.exec(c))?((k=this._prefixed.exec(c))||b&&(k=this._prefixed.exec(c+" ")))&&(f="prefixed",i=k[1]||"",g=this._unescape(k[2])):(f="prefix",g=k[1]||"")),"^"===this._prevTokenType&&(f="IRI"===f||"prefixed"===f?"type":""),!f)return b||!/^'''|^"""/.test(c)&&/\n|\r/.test(c)?o(this):this._input=c;a(null,{line:e,type:f,value:g,prefix:i}),this._prevTokenType=f,c=c.substr(l||k[0].length,c.length)}},_unescape:function(a){try{return a.replace(f,function(a,b,c,e){var f;if(b){if(f=parseInt(b,16),isNaN(f))throw new Error;return d(f)}if(c){if(f=parseInt(c,16),isNaN(f))throw new Error;return f<=65535?d(f):d(55296+(f-=65536)/1024,56320+(1023&f))}var h=g[e];if(!h)throw new Error;return h})}catch(a){return null}},_syntaxError:function(a){return this._input=null,new Error('Syntax error: unexpected "'+a+'" on line '+this._line+".")},tokenize:function(a,b){function d(a){null!==c._input&&(c._input+=a,c._tokenizeToEnd(b,!1))}function f(){null!==c._input&&c._tokenizeToEnd(b,!0)}var c=this;this._line=1,"string"==typeof a?(this._input=a,e(function(){c._tokenizeToEnd(b,!0)})):(this._input="",a&&"function"!=typeof a?("function"==typeof a.setEncoding&&a.setEncoding("utf8"),a.on("data",d),a.on("end",f)):(this.addChunk=d,this.end=f,b||(b=a)))}},b.exports=i},{}],16:[function(a,b,c){function n(a){if(!(this instanceof n))return new n(a);this._tripleStack=[],this._graph=null,a=a||{},this._setBase(a.documentIRI);var b="string"==typeof a.format&&a.format.match(/\w*$/)[0].toLowerCase(),c="turtle"===b,e="trig"===b,f=/triple/.test(b),g=/quad/.test(b),h=f||g;(this._supportsNamedGraphs=!c)||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(c||e||f),h&&(this._base="",this._resolveIRI=function(a){return this._error("Disallowed relative IRI",a),this._callback=o,this._subject=null}),this._blankNodePrefix="string"!=typeof a.blankNodePrefix?"":"_:"+a.blankNodePrefix.replace(/^_:/,""),this._lexer=a.lexer||new d({lineMode:h})}function o(){}var d=a("./N3Lexer"),e="http://www.w3.org/1999/02/22-rdf-syntax-ns#",f=e+"nil",g=e+"first",h=e+"rest",i=/^[a-z][a-z0-9+.-]*:/i,j=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,k=/(?:^|\/)\.\.?(?:$|[\/#?])/,l=0,m=0;n._resetBlankNodeIds=function(){l=m=0},n.prototype={_setBase:function(a){if(a){if(a.indexOf("#")>=0)throw new Error("Invalid base IRI "+a)}else a=null;(this._base=a)&&(this._basePath=a.replace(/[^\/?]*(?:\?.*)?$/,""),a=a.match(j),this._baseRoot=a[0],this._baseScheme=a[1])},_readInTopContext:function(a){switch(a.type){case"eof":return null!==this._graph?this._error("Unclosed graph",a):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"@prefix":return this._sparqlStyle=!1,this._readPrefix;case"PREFIX":return this._sparqlStyle=!0,this._readPrefix;case"@base":return this._sparqlStyle=!1,this._readBaseIRI;case"BASE":return this._sparqlStyle=!0,this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(a)}},_readSubject:function(a){switch(this._predicate=null,a.type){case"IRI":null===this._base||i.test(a.value)?this._subject=a.value:this._subject=this._resolveIRI(a);break;case"prefixed":var b=this._prefixes[a.prefix];if(void 0===b)return this._error('Undefined prefix "'+a.prefix+':"',a);this._subject=b+a.value;break;case"[":return this._subject="_:b"+m++,this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:f,predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;case"}":return this._readPunctuation(a);default:return this._error("Expected subject but got "+a.type,a)}return this._readPredicateOrNamedGraph},_readPredicate:function(a){var b=a.type;switch(b){case"IRI":case"abbreviation":null===this._base||i.test(a.value)?this._predicate=a.value:this._predicate=this._resolveIRI(a);break;case"prefixed":if("_"===a.prefix)return this._error("Disallowed blank node as predicate",a);var c=this._prefixes[a.prefix];if(void 0===c)return this._error('Undefined prefix "'+a.prefix+':"',a);this._predicate=c+a.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+b,a):(this._subject=null,"]"===b?this._readBlankNodeTail(a):this._readPunctuation(a));case";":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',a)}return this._readObject},_readObject:function(a){switch(a.type){case"IRI":null===this._base||i.test(a.value)?this._object=a.value:this._object=this._resolveIRI(a);break;case"prefixed":var b=this._prefixes[a.prefix];if(void 0===b)return this._error('Undefined prefix "'+a.prefix+':"',a);this._object=b+a.value;break;case"literal":return this._object=a.value,this._readDataTypeOrLang;case"[":var c="_:b"+m++;return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:c,type:"blank"}),this._subject=c,this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:f,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',a)}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(a){return"{"===a.type?this._readGraph(a):this._readPredicate(a)},_readGraph:function(a){return"{"!==a.type?this._error("Expected graph but got "+a.type,a):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(a){return"]"===a.type?(this._subject=null,this._readBlankNodeTail(a)):(this._predicate=null,this._readPredicate(a))},_readBlankNodeTail:function(a){if("]"!==a.type)return this._readBlankNodePunctuation(a);null!==this._subject&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""});var b=this._tripleStack.pop();return this._subject=b.subject,null!==b.object?(this._predicate=b.predicate,this._object=b.object,this._getTripleEndReader()):null!==this._predicate?this._readPredicate:this._readPredicateOrNamedGraph},_readDataTypeOrLang:function(a){switch(a.type){case"type":var b;if(""===a.prefix)b=null===this._base||i.test(a.value)?a.value:this._resolveIRI(a);else{var c=this._prefixes[a.prefix];if(void 0===c)return this._error('Undefined prefix "'+a.prefix+':"',a);b=c+a.value}return this._object+="^^"+b,this._getTripleEndReader();case"langcode":return this._object+="@"+a.value.toLowerCase(),this._getTripleEndReader();default:return this._getTripleEndReader().call(this,a)}},_readListItem:function(a){var b=null,c=null,d=this._subject,e=this._tripleStack,j=e[e.length-1],k=this._readListItem;switch(a.type){case"IRI":b=null===this._base||i.test(a.value)?a.value:this._resolveIRI(a);break;case"prefixed":var l=this._prefixes[a.prefix];if(void 0===l)return this._error('Undefined prefix "'+a.prefix+':"',a);b=l+a.value;break;case"literal":b=a.value,k=this._readDataTypeOrLang;break;case"[":c="_:b"+m++,b="_:b"+m++,e.push({subject:c,predicate:g,object:b,type:"blank"}),this._subject=b,k=this._readBlankNodeHead;break;case"(":c="_:b"+m++,e.push({subject:c,predicate:g,object:f,type:"list"}),this._subject=null,k=this._readListItem;break;case")":if(e.pop(),0!==e.length&&"list"===e[e.length-1].type&&this._callback(null,{subject:j.subject,predicate:j.predicate,object:j.object,graph:this._graph||""}),this._subject=j.subject,null===j.predicate){if(k=this._readPredicate,j.subject===f)return k}else if(this._predicate=j.predicate,this._object=j.object,k=this._getTripleEndReader(),j.object===f)return k;c=f;break;default:return this._error('Expected list item instead of "'+a.type+'"',a)}return null===c&&(this._subject=c="_:b"+m++),null===d?j.object===f?j.object=c:j.subject=c:this._callback(null,{subject:d,predicate:h,object:c,graph:this._graph||""}),null!==b&&this._callback(null,{subject:c,predicate:g,object:b,graph:this._graph||""}),k},_readPunctuation:function(a){var b,c=this._subject,d=this._graph;switch(a.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",a);this._graph=null;case".":this._subject=null,b=this._readInTopContext;break;case";":b=this._readPredicate;break;case",":b=this._readObject;break;case"IRI":if(this._supportsQuads&&null===this._graph){d=null===this._base||i.test(a.value)?a.value:this._resolveIRI(a),c=this._subject,b=this._readQuadPunctuation;break}case"prefixed":if(this._supportsQuads&&null===this._graph){var e=this._prefixes[a.prefix];if(void 0===e)return this._error('Undefined prefix "'+a.prefix+':"',a);d=e+a.value,b=this._readQuadPunctuation;break}default:return this._error('Expected punctuation to follow "'+this._object+'"',a)}return null!==c&&this._callback(null,{subject:c,predicate:this._predicate,object:this._object,graph:d||""}),b},_readBlankNodePunctuation:function(a){var b;switch(a.type){case";":b=this._readPredicate;break;case",":b=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',a)}return this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""}),b},_readQuadPunctuation:function(a){return"."!==a.type?this._error("Expected dot to follow quad",a):this._readInTopContext},_readPrefix:function(a){return"prefix"!==a.type?this._error("Expected prefix to follow @prefix",a):(this._prefix=a.value,this._readPrefixIRI)},_readPrefixIRI:function(a){if("IRI"!==a.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',a);var b;return b=null===this._base||i.test(a.value)?a.value:this._resolveIRI(a),this._prefixes[this._prefix]=b,this._prefixCallback(this._prefix,b),this._readDeclarationPunctuation},_readBaseIRI:function(a){if("IRI"!==a.type)return this._error("Expected IRI to follow base declaration",a);try{this._setBase(null===this._base||i.test(a.value)?a.value:this._resolveIRI(a))}catch(b){this._error(b.message,a)}return this._readDeclarationPunctuation},_readNamedGraphLabel:function(a){switch(a.type){case"IRI":case"prefixed":return this._readSubject(a),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",a)}},_readNamedGraphBlankLabel:function(a){return"]"!==a.type?this._error("Invalid graph label",a):(this._subject="_:b"+m++,this._readGraph)},_readDeclarationPunctuation:function(a){return this._sparqlStyle?this._readInTopContext(a):"."!==a.type?this._error("Expected declaration to end with a dot",a):this._readInTopContext},_getTripleEndReader:function(){var a=this._tripleStack;if(0===a.length)return this._readPunctuation;switch(a[a.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem}},_error:function(a,b){this._callback(new Error(a+" at line "+b.line+"."))},_resolveIRI:function(a){var b=a.value;switch(b[0]){case void 0:return this._base;case"#":return this._base+b;case"?":return this._base.replace(/(?:\?.*)?$/,b);case"/":return("/"===b[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(b);default:return this._removeDotSegments(this._basePath+b)}},_removeDotSegments:function(a){if(!k.test(a))return a;for(var b="",c=a.length,d=-1,e=-1,f=0,g="/";d<c;){switch(g){case":":if(e<0&&"/"===a[++d]&&"/"===a[++d])for(;(e=d+1)<c&&"/"!==a[e];)d=e;break;case"?":case"#":d=c;break;case"/":if("."===a[d+1])switch(g=a[++d+1]){case"/":b+=a.substring(f,d-1),f=d+1;break;case void 0:case"?":case"#":return b+a.substring(f,d)+a.substr(d+1);case".":if(g=a[++d+1],void 0===g||"/"===g||"?"===g||"#"===g){if(b+=a.substring(f,d-2),(f=b.lastIndexOf("/"))>=e&&(b=b.substr(0,f)),"/"!==g)return b+"/"+a.substr(d+1);f=d+1}}}g=a[++d]}return b+a.substring(f)},parse:function(a,b,c){this._readCallback=this._readInTopContext,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+l++ +"_","function"==typeof a&&(c=b,b=a,a=null),this._callback=b||o,this._prefixCallback=c||o;var d=this;this._lexer.tokenize(a,function(a,b){null!==a?(d._callback(a),d._callback=o):void 0!==d._readCallback&&(d._readCallback=d._readCallback(b))}),a||(this.addChunk=this._lexer.addChunk,this.end=this._lexer.end)}},b.exports=n},{"./N3Lexer":15}],17:[function(a,b,c){function e(a,b){return this instanceof e?(this._size=0,this._graphs=Object.create(null),this._entities=Object.create(null),this._entities["><"]=0,this._entityCount=0,this._blankNodeIndex=0,b||!a||a[0]||(b=a,a=null),this._prefixes=Object.create(null),b&&b.prefixes&&this.addPrefixes(b.prefixes),void(a&&this.addTriples(a))):new e(a,b)}var d=a("./N3Util").expandPrefixedName;e.prototype={get size(){var a=this._size;if(null!==a)return a;var c,d,b=this._graphs;for(var e in b)for(var f in c=b[e].subjects)for(var g in d=c[f])a+=Object.keys(d[g]).length;return this._size=a},_addToIndex:function(a,b,c,d){var e=a[b]||(a[b]={}),f=e[c]||(e[c]={});f[d]=null},_removeFromIndex:function(a,b,c,d){var g,e=a[b],f=e[c];delete f[d];for(g in f)return;delete e[c];for(g in e)return;delete a[b]},_findInIndex:function(a,b,c,d,e,f,g,h){var k,l,m,i=[],j=Object.keys(this._entities);b&&((k=a,a={})[b]=k[b]);for(var n in a){var o=j[n];if(l=a[n]){c&&((k=l,l={})[c]=k[c]);for(var p in l){var q=j[p];if(m=l[p])for(var r=(d?d in m?[d]:[]:Object.keys(m)),s=r.length-1;s>=0;s--){var t={subject:"",predicate:"",object:"",graph:h};t[e]=o,t[f]=q,t[g]=j[r[s]],i.push(t)}}}}return i},_countInIndex:function(a,b,c,d){var f,g,h,e=0;b&&((f=a,a={})[b]=f[b]);for(var i in a)if(g=a[i]){c&&((f=g,g={})[c]=f[c]);for(var j in g)(h=g[j])&&(d?d in h&&e++:e+=Object.keys(h).length)}return e},addTriple:function(a,b,c,d){b||(d=a.graph,c=a.object,b=a.predicate,a=a.subject),d=d||"";var e=this._graphs[d];e||(e=this._graphs[d]={subjects:{},predicates:{},objects:{}},Object.freeze(e));var f=this._entities;a=f[a]||(f[a]=++this._entityCount),b=f[b]||(f[b]=++this._entityCount),c=f[c]||(f[c]=++this._entityCount),this._addToIndex(e.subjects,a,b,c),this._addToIndex(e.predicates,b,c,a),this._addToIndex(e.objects,c,a,b),this._size=null},addTriples:function(a){for(var b=a.length-1;b>=0;b--)this.addTriple(a[b])},addPrefix:function(a,b){this._prefixes[a]=b},addPrefixes:function(a){for(var b in a)this.addPrefix(b,a[b])},removeTriple:function(a,b,c,d){b||(d=a.graph,c=a.object,b=a.predicate,a=a.subject),d=d||"";var e,f=this._entities,g=this._graphs;if((a=f[a])&&(b=f[b])&&(c=f[c])&&(e=g[d])){var h,i;if((h=e.subjects[a])&&(i=h[b])&&c in i){this._removeFromIndex(e.subjects,a,b,c),this._removeFromIndex(e.predicates,b,c,a),this._removeFromIndex(e.objects,c,a,b),null!==this._size&&this._size--;for(a in e.subjects)return;delete g[d]}}},removeTriples:function(a){for(var b=a.length-1;b>=0;b--)this.removeTriple(a[b])},find:function(a,b,c,e){var f=this._prefixes;return this.findByIRI(d(a,f),d(b,f),d(c,f),d(e,f))},findByIRI:function(a,b,c,d){d=d||"";var e=this._graphs[d],f=this._entities;return e?a&&!(a=f[a])?[]:b&&!(b=f[b])?[]:c&&!(c=f[c])?[]:a?c?this._findInIndex(e.objects,c,a,b,"object","subject","predicate",d):this._findInIndex(e.subjects,a,b,null,"subject","predicate","object",d):b?this._findInIndex(e.predicates,b,c,null,"predicate","object","subject",d):c?this._findInIndex(e.objects,c,null,null,"object","subject","predicate",d):this._findInIndex(e.subjects,null,null,null,"subject","predicate","object",d):[]},count:function(a,b,c,e){var f=this._prefixes;return this.countByIRI(d(a,f),d(b,f),d(c,f),d(e,f))},countByIRI:function(a,b,c,d){d=d||"";var e=this._graphs[d],f=this._entities;return e?a&&!(a=f[a])?0:b&&!(b=f[b])?0:c&&!(c=f[c])?0:a?c?this._countInIndex(e.objects,c,a,b):this._countInIndex(e.subjects,a,b,c):b?this._countInIndex(e.predicates,b,c,a):this._countInIndex(e.objects,c,a,b):0},createBlankNode:function(a){var b,c;if(a)for(b=a="_:"+a,c=1;this._entities[b];)b=a+c++;else do b="_:b"+this._blankNodeIndex++;while(this._entities[b]);return this._entities[b]=++this._entityCount,b}},b.exports=e},{"./N3Util":20}],18:[function(a,b,c){function g(a){if(!(this instanceof g))return new g(a);d.call(this,{decodeStrings:!0}),this._readableState.objectMode=!0;var b=this,c=new f(a);c.parse(function(a,c){c&&b.push(c)||a&&b.emit("error",a)},this.emit.bind(this,"prefix")),this._transform=function(a,b,d){c.addChunk(a),d()},this._flush=function(a){c.end(),a()}}var d=a("stream").Transform,e=a("util"),f=a("./N3Parser.js");e.inherits(g,d),b.exports=g},{"./N3Parser.js":16,stream:34,util:38}],19:[function(a,b,c){function g(a){if(!(this instanceof g))return new g(a);d.call(this,{encoding:"utf8"}),this._writableState.objectMode=!0;var b=this,c=new f({write:function(a,c,d){b.push(a),d&&d()},end:function(a){b.push(null),a&&a()}},a);this._transform=function(a,b,d){c.addTriple(a,d)},this._flush=function(a){c.end(a)}}var d=a("stream").Transform,e=a("util"),f=a("./N3Writer.js");e.inherits(g,d),b.exports=g},{"./N3Writer.js":21,stream:34,util:38}],20:[function(a,b,c){function k(a,b){for(var c in j)b?a.prototype[c]=l(j[c]):a[c]=j[c];return a}function l(a){return function(b){return a(this,b)}}var d="http://www.w3.org/2001/XMLSchema#",e=d+"string",f=d+"integer",g=d+"decimal",h=d+"boolean",i="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",j={isIRI:function(a){if(!a)return a;var b=a[0];return'"'!==b&&"_"!==b},isLiteral:function(a){return a&&'"'===a[0]},isBlank:function(a){return a&&"_:"===a.substr(0,2)},getLiteralValue:function(a){var b=/^"([^]*)"/.exec(a);if(!b)throw new Error(a+" is not a literal");return b[1]},getLiteralType:function(a){var b=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(a);if(!b)throw new Error(a+" is not a literal");return b[1]||(b[2]?i:e)},getLiteralLanguage:function(a){var b=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(a);if(!b)throw new Error(a+" is not a literal");return b[1]?b[1].toLowerCase():""},isPrefixedName:function(a){return a&&/^[^:\/"']*:[^:\/"']+$/.test(a)},expandPrefixedName:function(a,b){var d,e,f,c=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(a);return c&&(d=c[1],e=b[d],f=c.index),void 0===e?a:0===f?e+a.substr(d.length+1):a.substr(0,f+3)+e+a.substr(f+d.length+4)},createIRI:function(a){return a&&'"'===a[0]?j.getLiteralValue(a):a},createLiteral:function(a,b){if(!b)switch(typeof a){case"boolean":b=h;break;case"number":if(isFinite(a)){b=a%1===0?f:g;break}default:return'"'+a+'"'}return'"'+a+(/^[a-z]+(-[a-z0-9]+)*$/i.test(b)?'"@'+b.toLowerCase():'"^^'+b)}};b.exports=k(k)},{}],21:[function(a,b,c){function j(a,b){if(!(this instanceof j))return new j(a,b);if(a&&"function"!=typeof a.write&&(b=a,a=null),b=b||{},a)this._outputStream=a,this._endStream=void 0===b.end||!!b.end;else{var c="";this._outputStream={write:function(a,b,d){c+=a,d&&d()},end:function(a){a&&a(null,c)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(b.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),b.prefixes&&this.addPrefixes(b.prefixes))}function k(a){var b=i[a];return void 0===b&&(1===a.length?(b=a.charCodeAt(0).toString(16),b="\\u0000".substr(0,6-b.length)+b):(b=(1024*(a.charCodeAt(0)-55296)+a.charCodeAt(1)+9216).toString(16),b="\\U00000000".substr(0,10-b.length)+b)),b}var d=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,e="http://www.w3.org/1999/02/22-rdf-syntax-ns#",f=e+"type",g=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,h=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,i={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};j.prototype={_write:function(a,b){this._outputStream.write(a,"utf8",b)},_writeTriple:function(a,b,c,d,e){try{this._graph!==d&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(d?this._encodeIriOrBlankNode(d)+" {\n":"")),this._subject=null,this._graph="["!==d[0]?d:"]"),this._subject===a?this._predicate===b?this._write(", "+this._encodeObject(c),e):this._write(";\n    "+this._encodePredicate(this._predicate=b)+" "+this._encodeObject(c),e):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=a)+" "+this._encodePredicate(this._predicate=b)+" "+this._encodeObject(c),e)}catch(a){e&&e(a)}},_writeTripleLine:function(a,b,c,d,e){delete this._prefixMatch;try{this._write(this._encodeIriOrBlankNode(a)+" "+this._encodeIriOrBlankNode(b)+" "+this._encodeObject(c)+(d?" "+this._encodeIriOrBlankNode(d)+".\n":".\n"),e)}catch(a){e&&e(a)}},_encodeIriOrBlankNode:function(a){var b=a[0];if("["===b||"("===b||"_"===b&&":"===a[1])return a;g.test(a)&&(a=a.replace(h,k));var c=this._prefixRegex.exec(a);return c?c[1]?this._prefixIRIs[c[1]]+c[2]:a:"<"+a+">"},_encodeLiteral:function(a,b,c){return g.test(a)&&(a=a.replace(h,k)),c?'"'+a+'"@'+c:b?'"'+a+'"^^'+this._encodeIriOrBlankNode(b):'"'+a+'"'},_encodeSubject:function(a){if('"'===a[0])throw new Error("A literal as subject is not allowed: "+a);return"["===a[0]&&(this._subject="]"),this._encodeIriOrBlankNode(a)},_encodePredicate:function(a){if('"'===a[0])throw new Error("A literal as predicate is not allowed: "+a);return a===f?"a":this._encodeIriOrBlankNode(a)},_encodeObject:function(a){if('"'!==a[0])return this._encodeIriOrBlankNode(a);var b=d.exec(a);if(!b)throw new Error("Invalid literal: "+a);return this._encodeLiteral(b[1],b[2],b[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(a,b,c,d,e){void 0===c?this._writeTriple(a.subject,a.predicate,a.object,a.graph||"",b):"string"!=typeof d?this._writeTriple(a,b,c,"",d):this._writeTriple(a,b,c,d,e)},addTriples:function(a){for(var b=0;b<a.length;b++)this.addTriple(a[b])},addPrefix:function(a,b,c){var d={};d[a]=b,this.addPrefixes(d,c)},addPrefixes:function(a,b){var c=this._prefixIRIs,d=!1;for(var e in a){var f=a[e];/[#\/]$/.test(f)&&c[f]!==(e+=":")&&(d=!0,c[f]=e,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+e+" <"+f+">.\n"))}if(d){var g="",h="";for(var i in c)g+=g?"|"+i:i,h+=(h?"|":"")+c[i];g=g.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+h+")[^/]*$|^("+g+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(d?"\n":"",b)},blank:function(a,b){var d,e,c=a;switch(void 0===a?c=[]:"string"==typeof a?c=[{predicate:a,object:b}]:"length"in a||(c=[a]),e=c.length){case 0:return"[]";case 1:if(d=c[0],"["!==d.object[0])return"[ "+this._encodePredicate(d.predicate)+" "+this._encodeObject(d.object)+" ]";default:for(var f="[",g=0;g<e;g++)d=c[g],d.predicate===a?f+=", "+this._encodeObject(d.object):(f+=(g?";\n  ":"\n  ")+this._encodePredicate(d.predicate)+" "+this._encodeObject(d.object),a=d.predicate);return f+"\n]"}},list:function(a){for(var b=a&&a.length||0,c=new Array(b),d=0;d<b;d++)c[d]=this._encodeObject(a[d]);return"("+c.join(" ")+")"},_prefixRegex:/$0^/,end:function(a){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var b=a&&function(c,d){b=null,a(c,d)};if(this._endStream)try{return this._outputStream.end(b)}catch(a){}b&&b()}},b.exports=j},{}],22:[function(a,b,c){(function(a){"use strict";function c(b,c,d,e){if("function"!=typeof b)throw new TypeError('"callback" argument must be a function');var g,h,f=arguments.length;switch(f){case 0:case 1:return a.nextTick(b);case 2:return a.nextTick(function(){b.call(null,c)});case 3:return a.nextTick(function(){b.call(null,c,d)});case 4:return a.nextTick(function(){b.call(null,c,d,e)});default:for(g=new Array(f-1),h=0;h<g.length;)g[h++]=arguments[h];return a.nextTick(function(){b.apply(null,g)})}}!a.version||0===a.version.indexOf("v0.")||0===a.version.indexOf("v1.")&&0!==a.version.indexOf("v1.8.")?b.exports=c:b.exports=a.nextTick}).call(this,a("_process"))},{_process:23}],23:[function(a,b,c){function g(a){if(e===setTimeout)return setTimeout(a,0);try{return e(a,0)}catch(b){try{return e.call(null,a,0)}catch(b){return e.call(this,a,0)}}}function h(a){if(f===clearTimeout)return clearTimeout(a);try{return f(a)}catch(b){try{return f.call(null,a)}catch(b){return f.call(this,a)}}}function m(){j&&k&&(j=!1,k.length?i=k.concat(i):l=-1,i.length&&n())}function n(){if(!j){var a=g(m);j=!0;for(var b=i.length;b;){for(k=i,i=[];++l<b;)k&&k[l].run();l=-1,b=i.length}k=null,j=!1,h(a)}}function o(a,b){this.fun=a,this.array=b}function p(){}var e,f,d=b.exports={};!function(){try{e=setTimeout}catch(a){e=function(){throw new Error("setTimeout is not defined")}}try{f=clearTimeout}catch(a){f=function(){throw new Error("clearTimeout is not defined")}}}();var k,i=[],j=!1,l=-1;d.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];i.push(new o(a,b)),1!==i.length||j||g(n)},o.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=p,d.addListener=p,d.once=p,d.off=p,d.removeListener=p,d.removeAllListeners=p,d.emit=p,d.binding=function(a){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(a){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],24:[function(a,b,c){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":25}],25:[function(a,b,c){"use strict";function l(a){return this instanceof l?(g.call(this,a),h.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",m)):new l(a)}function m(){this.allowHalfOpen||this._writableState.ended||e(n,this)}function n(a){a.end()}var d=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};b.exports=l;var e=a("process-nextick-args"),f=a("core-util-is");f.inherits=a("inherits");var g=a("./_stream_readable"),h=a("./_stream_writable");f.inherits(l,g);for(var i=d(h.prototype),j=0;j<i.length;j++){var k=i[j];l.prototype[k]||(l.prototype[k]=h.prototype[k])}},{"./_stream_readable":27,"./_stream_writable":29,"core-util-is":5,inherits:9,"process-nextick-args":22}],26:[function(a,b,c){"use strict";function f(a){return this instanceof f?void d.call(this,a):new f(a)}b.exports=f;var d=a("./_stream_transform"),e=a("core-util-is");e.inherits=a("inherits"),e.inherits(f,d),f.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":28,"core-util-is":5,inherits:9}],27:[function(a,b,c){(function(c){"use strict";function o(b,c){n=n||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof n&&(this.objectMode=this.objectMode||!!b.readableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(m||(m=a("string_decoder/").StringDecoder),this.decoder=new m(b.encoding),this.encoding=b.encoding)}function p(b){return n=n||a("./_stream_duplex"),this instanceof p?(this._readableState=new o(b,this),this.readable=!0,b&&"function"==typeof b.read&&(this._read=b.read),void i.call(this)):new p(b)}function q(a,b,c,d,e){var f=v(b,c);if(f)a.emit("error",f);else if(null===c)b.reading=!1,w(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var g=new Error("stream.push() after EOF");a.emit("error",g)}else if(b.endEmitted&&e){
var g=new Error("stream.unshift() after end event");a.emit("error",g)}else{var h;!b.decoder||e||d||(c=b.decoder.write(c),h=!b.objectMode&&0===c.length),e||(b.reading=!1),h||(b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&x(a))),z(a,b)}else e||(b.reading=!1);return r(b)}function r(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function t(a){return a>=s?a=s:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a}function u(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:null===a||isNaN(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:a<=0?0:(a>b.highWaterMark&&(b.highWaterMark=t(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function v(a,b){var c=null;return f.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function w(a,b){if(!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,x(a)}}function x(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(l("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?d(y,a):y(a))}function y(a){l("emit readable"),a.emit("readable"),F(a)}function z(a,b){b.readingMore||(b.readingMore=!0,d(A,a,b))}function A(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(l("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function B(a){return function(){var b=a._readableState;l("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&h(a,"data")&&(b.flowing=!0,F(a))}}function C(a){l("readable nexttick read 0"),a.read(0)}function D(a,b){b.resumeScheduled||(b.resumeScheduled=!0,d(E,a,b))}function E(a,b){b.reading||(l("resume read 0"),a.read(0)),b.resumeScheduled=!1,a.emit("resume"),F(a),b.flowing&&!b.reading&&a.read(0)}function F(a){var b=a._readableState;if(l("flow",b.flowing),b.flowing)do var c=a.read();while(null!==c&&b.flowing)}function G(a,b){var h,c=b.buffer,d=b.length,e=!!b.decoder,g=!!b.objectMode;if(0===c.length)return null;if(0===d)h=null;else if(g)h=c.shift();else if(!a||a>=d)h=e?c.join(""):1===c.length?c[0]:f.concat(c,d),c.length=0;else if(a<c[0].length){var i=c[0];h=i.slice(0,a),c[0]=i.slice(a)}else if(a===c[0].length)h=c.shift();else{h=e?"":new f(a);for(var j=0,k=0,l=c.length;k<l&&j<a;k++){var i=c[0],m=Math.min(a-j,i.length);e?h+=i.slice(0,m):i.copy(h,j,0,m),m<i.length?c[0]=i.slice(m):c.shift(),j+=m}}return h}function H(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");b.endEmitted||(b.ended=!0,d(I,b,a))}function I(a,b){a.endEmitted||0!==a.length||(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function J(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)}function K(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}b.exports=p;var d=a("process-nextick-args"),e=a("isarray"),f=a("buffer").Buffer;p.ReadableState=o;var i,h=(a("events"),function(a,b){return a.listeners(b).length});!function(){try{i=a("stream")}catch(a){}finally{i||(i=a("events").EventEmitter)}}();var f=a("buffer").Buffer,j=a("core-util-is");j.inherits=a("inherits");var k=a("util"),l=void 0;l=k&&k.debuglog?k.debuglog("stream"):function(){};var m;j.inherits(p,i);var n,n;p.prototype.push=function(a,b){var c=this._readableState;return c.objectMode||"string"!=typeof a||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new f(a,b),b="")),q(this,c,a,b,!1)},p.prototype.unshift=function(a){var b=this._readableState;return q(this,b,a,"",!0)},p.prototype.isPaused=function(){return this._readableState.flowing===!1},p.prototype.setEncoding=function(b){return m||(m=a("string_decoder/").StringDecoder),this._readableState.decoder=new m(b),this._readableState.encoding=b,this};var s=8388608;p.prototype.read=function(a){l("read",a);var b=this._readableState,c=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return l("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?H(this):x(this),null;if(a=u(a,b),0===a&&b.ended)return 0===b.length&&H(this),null;var d=b.needReadable;l("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,l("length less than watermark",d)),(b.ended||b.reading)&&(d=!1,l("reading or ended",d)),d&&(l("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=u(c,b));var e;return e=a>0?G(a,b):null,null===e&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),c!==a&&b.ended&&0===b.length&&H(this),null!==e&&this.emit("data",e),e},p.prototype._read=function(a){this.emit("error",new Error("not implemented"))},p.prototype.pipe=function(a,b){function k(a){l("onunpipe"),a===f&&p()}function m(){l("onend"),a.end()}function p(){l("cleanup"),a.removeListener("close",s),a.removeListener("finish",t),a.removeListener("drain",n),a.removeListener("error",r),a.removeListener("unpipe",k),f.removeListener("end",m),f.removeListener("end",p),f.removeListener("data",q),o=!0,!g.awaitDrain||a._writableState&&!a._writableState.needDrain||n()}function q(b){l("ondata");var c=a.write(b);!1===c&&(1!==g.pipesCount||g.pipes[0]!==a||1!==f.listenerCount("data")||o||(l("false write response, pause",f._readableState.awaitDrain),f._readableState.awaitDrain++),f.pause())}function r(b){l("onerror",b),u(),a.removeListener("error",r),0===h(a,"error")&&a.emit("error",b)}function s(){a.removeListener("finish",t),u()}function t(){l("onfinish"),a.removeListener("close",s),u()}function u(){l("unpipe"),f.unpipe(a)}var f=this,g=this._readableState;switch(g.pipesCount){case 0:g.pipes=a;break;case 1:g.pipes=[g.pipes,a];break;default:g.pipes.push(a)}g.pipesCount+=1,l("pipe count=%d opts=%j",g.pipesCount,b);var i=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,j=i?m:p;g.endEmitted?d(j):f.once("end",j),a.on("unpipe",k);var n=B(f);a.on("drain",n);var o=!1;return f.on("data",q),a._events&&a._events.error?e(a._events.error)?a._events.error.unshift(r):a._events.error=[r,a._events.error]:a.on("error",r),a.once("close",s),a.once("finish",t),a.emit("pipe",f),g.flowing||(l("pipe resume"),f.resume()),a},p.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;e<d;e++)c[e].emit("unpipe",this);return this}var f=K(b.pipes,a);return f===-1?this:(b.pipes.splice(f,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},p.prototype.on=function(a,b){var c=i.prototype.on.call(this,a,b);if("data"===a&&!1!==this._readableState.flowing&&this.resume(),"readable"===a&&!this._readableState.endEmitted){var e=this._readableState;e.readableListening||(e.readableListening=!0,e.emittedReadable=!1,e.needReadable=!0,e.reading?e.length&&x(this,e):d(C,this))}return c},p.prototype.addListener=p.prototype.on,p.prototype.resume=function(){var a=this._readableState;return a.flowing||(l("resume"),a.flowing=!0,D(this,a)),this},p.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this},p.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(l("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(l("wrapped data"),b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)void 0===this[e]&&"function"==typeof a[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return J(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){l("wrapped _read",b),c&&(c=!1,a.resume())},d},p._fromList=G}).call(this,a("_process"))},{"./_stream_duplex":25,_process:23,buffer:4,"core-util-is":5,events:7,inherits:9,isarray:11,"process-nextick-args":22,"string_decoder/":35,util:3}],28:[function(a,b,c){"use strict";function f(a){this.afterTransform=function(b,c){return g(a,b,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function g(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function h(a){if(!(this instanceof h))return new h(a);d.call(this,a),this._transformState=new f(this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,a&&("function"==typeof a.transform&&(this._transform=a.transform),"function"==typeof a.flush&&(this._flush=a.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(a){i(b,a)}):i(b)})}function i(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=a._transformState;if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=h;var d=a("./_stream_duplex"),e=a("core-util-is");e.inherits=a("inherits"),e.inherits(h,d),h.prototype.push=function(a,b){return this._transformState.needTransform=!1,d.prototype.push.call(this,a,b)},h.prototype._transform=function(a,b,c){throw new Error("not implemented")},h.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},h.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0}},{"./_stream_duplex":25,"core-util-is":5,inherits:9}],29:[function(a,b,c){(function(c){"use strict";function j(){}function k(a,b,c){this.chunk=a,this.encoding=b,this.callback=c,this.next=null}function m(b,c){l=l||a("./_stream_duplex"),b=b||{},this.objectMode=!!b.objectMode,c instanceof l&&(this.objectMode=this.objectMode||!!b.writableObjectMode);var d=b.highWaterMark,e=this.objectMode?16:16384;this.highWaterMark=d||0===d?d:e,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=b.decodeStrings===!1;this.decodeStrings=!f,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){v(c,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new D(this),this.corkedRequestsFree.next=new D(this)}function n(b){return l=l||a("./_stream_duplex"),this instanceof n||this instanceof l?(this._writableState=new m(b,this),this.writable=!0,b&&("function"==typeof b.write&&(this._write=b.write),"function"==typeof b.writev&&(this._writev=b.writev)),void i.call(this)):new n(b)}function o(a,b){var c=new Error("write after end");a.emit("error",c),d(b,c)}function p(a,b,c,e){var g=!0;if(!f.isBuffer(c)&&"string"!=typeof c&&null!==c&&void 0!==c&&!b.objectMode){var h=new TypeError("Invalid non-string/buffer chunk");a.emit("error",h),d(e,h),g=!1}return g}function q(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new f(b,c)),b}function r(a,b,c,d,e){c=q(b,c,d),f.isBuffer(c)&&(d="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;if(h||(b.needDrain=!0),b.writing||b.corked){var i=b.lastBufferedRequest;b.lastBufferedRequest=new k(c,d,e),i?i.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest,b.bufferedRequestCount+=1}else s(a,b,!1,g,c,d,e);return h}function s(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function t(a,b,c,e,f){--b.pendingcb,c?d(f,e):f(e),a._writableState.errorEmitted=!0,a.emit("error",e)}function u(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function v(a,b){var c=a._writableState,d=c.sync,f=c.writecb;if(u(c),b)t(a,c,d,b,f);else{var g=z(c);g||c.corked||c.bufferProcessing||!c.bufferedRequest||y(a,c),d?e(w,a,c,g,f):w(a,c,g,f)}}function w(a,b,c,d){c||x(a,b),b.pendingcb--,d(),B(a,b)}function x(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function y(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){var d=b.bufferedRequestCount,e=new Array(d),f=b.corkedRequestsFree;f.entry=c;for(var g=0;c;)e[g]=c,c=c.next,g+=1;s(a,b,!0,b.length,e,"",f.finish),b.pendingcb++,b.lastBufferedRequest=null,b.corkedRequestsFree=f.next,f.next=null}else{for(;c;){var h=c.chunk,i=c.encoding,j=c.callback,k=b.objectMode?1:h.length;if(s(a,b,!1,k,h,i,j),c=c.next,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequestCount=0,b.bufferedRequest=c,b.bufferProcessing=!1}function z(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function A(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function B(a,b){var c=z(b);return c&&(0===b.pendingcb?(A(a,b),b.finished=!0,a.emit("finish")):A(a,b)),c}function C(a,b,c){b.ending=!0,B(a,b),c&&(b.finished?d(c):a.once("finish",c)),b.ended=!0,a.writable=!1}function D(a){var b=this;this.next=null,this.entry=null,this.finish=function(c){var d=b.entry;for(b.entry=null;d;){var e=d.callback;a.pendingcb--,e(c),d=d.next}a.corkedRequestsFree?a.corkedRequestsFree.next=b:a.corkedRequestsFree=b}}b.exports=n;var d=a("process-nextick-args"),e=!c.browser&&["v0.10","v0.9."].indexOf(c.version.slice(0,5))>-1?setImmediate:d,f=a("buffer").Buffer;n.WritableState=m;var g=a("core-util-is");g.inherits=a("inherits");var i,h={deprecate:a("util-deprecate")};!function(){try{i=a("stream")}catch(a){}finally{i||(i=a("events").EventEmitter)}}();var f=a("buffer").Buffer;g.inherits(n,i);var l;m.prototype.getBuffer=function(){for(var b=this.bufferedRequest,c=[];b;)c.push(b),b=b.next;return c},function(){try{Object.defineProperty(m.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(a){}}();var l;n.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},n.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return"function"==typeof b&&(c=b,b=null),f.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),"function"!=typeof c&&(c=j),d.ended?o(this,c):p(this,d,a,c)&&(d.pendingcb++,e=r(this,d,a,b,c)),e},n.prototype.cork=function(){var a=this._writableState;a.corked++},n.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.bufferedRequest||y(this,a))},n.prototype.setDefaultEncoding=function(b){if("string"==typeof b&&(b=b.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((b+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+b);this._writableState.defaultEncoding=b},n.prototype._write=function(a,b,c){c(new Error("not implemented"))},n.prototype._writev=null,n.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!==a&&void 0!==a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||C(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":25,_process:23,buffer:4,"core-util-is":5,events:7,inherits:9,"process-nextick-args":22,"util-deprecate":36}],30:[function(a,b,c){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":26}],31:[function(a,b,c){var d=function(){try{return a("stream")}catch(a){}}();c=b.exports=a("./lib/_stream_readable.js"),c.Stream=d||c,c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":25,"./lib/_stream_passthrough.js":26,"./lib/_stream_readable.js":27,"./lib/_stream_transform.js":28,"./lib/_stream_writable.js":29}],32:[function(a,b,c){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":28}],33:[function(a,b,c){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":29}],34:[function(a,b,c){function f(){d.call(this)}b.exports=f;var d=a("events").EventEmitter,e=a("inherits");e(f,d),f.Readable=a("readable-stream/readable.js"),f.Writable=a("readable-stream/writable.js"),f.Duplex=a("readable-stream/duplex.js"),f.Transform=a("readable-stream/transform.js"),f.PassThrough=a("readable-stream/passthrough.js"),f.Stream=f,f.prototype.pipe=function(a,b){function e(b){a.writable&&!1===a.write(b)&&c.pause&&c.pause()}function f(){c.readable&&c.resume&&c.resume()}function h(){g||(g=!0,a.end())}function i(){g||(g=!0,"function"==typeof a.destroy&&a.destroy())}function j(a){if(k(),0===d.listenerCount(this,"error"))throw a}function k(){c.removeListener("data",e),a.removeListener("drain",f),c.removeListener("end",h),c.removeListener("close",i),c.removeListener("error",j),a.removeListener("error",j),c.removeListener("end",k),c.removeListener("close",k),a.removeListener("close",k)}var c=this;c.on("data",e),a.on("drain",f),a._isStdio||b&&b.end===!1||(c.on("end",h),c.on("close",i));var g=!1;return c.on("error",j),a.on("error",j),c.on("end",k),c.on("close",k),a.on("close",k),a.emit("pipe",c),a}},{events:7,inherits:9,"readable-stream/duplex.js":24,"readable-stream/passthrough.js":30,"readable-stream/readable.js":31,"readable-stream/transform.js":32,"readable-stream/writable.js":33}],35:[function(a,b,c){function f(a){if(a&&!e(a))throw new Error("Unknown encoding: "+a)}function h(a){return a.toString(this.encoding)}function i(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function j(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}var d=a("buffer").Buffer,e=d.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},g=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),f(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=i;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=j;break;default:return void(this.write=h)}this.charBuffer=new d(6),this.charReceived=0,this.charLength=0};g.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&d<=56319)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&d<=56319){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},g.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(b<=2&&c>>4==14){this.charLength=3;break}if(b<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=b},g.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:4}],36:[function(a,b,c){(function(a){function c(a,b){function e(){if(!c){if(d("throwDeprecation"))throw new Error(b);d("traceDeprecation")?console.trace(b):console.warn(b),c=!0}return a.apply(this,arguments)}if(d("noDeprecation"))return a;var c=!1;return e}function d(b){try{if(!a.localStorage)return!1}catch(a){return!1}var c=a.localStorage[b];return null!=c&&"true"===String(c).toLowerCase()}b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(a,b,c){b.exports=function(b){return b&&"object"==typeof b&&"function"==typeof b.copy&&"function"==typeof b.fill&&"function"==typeof b.readUInt8}},{}],38:[function(a,b,c){(function(b,d){function h(a,b){var d={seen:[],stylize:j};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),s(b)?d.showHidden=b:b&&c._extend(d,b),y(d.showHidden)&&(d.showHidden=!1),y(d.depth)&&(d.depth=2),y(d.colors)&&(d.colors=!1),y(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=i),l(d,a,d.depth)}function i(a,b){var c=h.styles[b];return c?"["+h.colors[c][0]+"m"+a+"["+h.colors[c][1]+"m":a}function j(a,b){return a}function k(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function l(a,b,d){if(a.customInspect&&b&&D(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return w(e)||(e=l(a,e,d)),e}var f=m(a,b);if(f)return f;var g=Object.keys(b),h=k(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),C(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return n(b);if(0===g.length){if(D(b)){var i=b.name?": "+b.name:"";return a.stylize("[Function"+i+"]","special")}if(z(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(B(b))return a.stylize(Date.prototype.toString.call(b),"date");if(C(b))return n(b)}var j="",s=!1,t=["{","}"];if(r(b)&&(s=!0,t=["[","]"]),D(b)){var u=b.name?": "+b.name:"";j=" [Function"+u+"]"}if(z(b)&&(j=" "+RegExp.prototype.toString.call(b)),B(b)&&(j=" "+Date.prototype.toUTCString.call(b)),C(b)&&(j=" "+n(b)),0===g.length&&(!s||0==b.length))return t[0]+j+t[1];if(d<0)return z(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var v;return v=s?o(a,b,d,h,g):g.map(function(c){return p(a,b,d,h,c,s)}),a.seen.pop(),q(v,j,t)}function m(a,b){if(y(b))return a.stylize("undefined","undefined");if(w(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return v(b)?a.stylize(""+b,"number"):s(b)?a.stylize(""+b,"boolean"):t(b)?a.stylize("null","null"):void 0}function n(a){return"["+Error.prototype.toString.call(a)+"]"}function o(a,b,c,d,e){for(var f=[],g=0,h=b.length;g<h;++g)J(b,String(g))?f.push(p(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(p(a,b,c,d,e,!0))}),f}function p(a,b,c,d,e,f){var g,h,i;if(i=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},i.get?h=i.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):i.set&&(h=a.stylize("[Setter]","special")),J(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(i.value)<0?(h=t(c)?l(a,i.value,null):l(a,i.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),y(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function q(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function r(a){return Array.isArray(a)}function s(a){return"boolean"==typeof a}function t(a){return null===a}function u(a){return null==a}function v(a){return"number"==typeof a}function w(a){return"string"==typeof a}function x(a){return"symbol"==typeof a}function y(a){return void 0===a}function z(a){return A(a)&&"[object RegExp]"===F(a)}function A(a){return"object"==typeof a&&null!==a}function B(a){return A(a)&&"[object Date]"===F(a)}function C(a){return A(a)&&("[object Error]"===F(a)||a instanceof Error)}function D(a){return"function"==typeof a}function E(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function F(a){return Object.prototype.toString.call(a)}function G(a){return a<10?"0"+a.toString(10):a.toString(10)}function I(){var a=new Date,b=[G(a.getHours()),G(a.getMinutes()),G(a.getSeconds())].join(":");return[a.getDate(),H[a.getMonth()],b].join(" ")}function J(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var e=/%[sdj%]/g;c.format=function(a){if(!w(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(h(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(e,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),i=d[c];c<f;i=d[++c])g+=t(i)||!A(i)?" "+i:" "+h(i);return g},c.deprecate=function(a,e){function g(){if(!f){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),f=!0}return a.apply(this,arguments)}if(y(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var f=!1;return g};var g,f={};c.debuglog=function(a){if(y(g)&&(g=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!f[a])if(new RegExp("\\b"+a+"\\b","i").test(g)){var d=b.pid;f[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else f[a]=function(){};return f[a]},c.inspect=h,h.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},h.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=r,c.isBoolean=s,c.isNull=t,c.isNullOrUndefined=u,c.isNumber=v,c.isString=w,c.isSymbol=x,c.isUndefined=y,c.isRegExp=z,c.isObject=A,c.isDate=B,c.isError=C,c.isFunction=D,c.isPrimitive=E,c.isBuffer=a("./support/isBuffer");var H=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",I(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!A(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":37,_process:23,inherits:9}],39:[function(a,b,c){function d(a){this.options=a||{locator:{}}}function e(a,b,c){function g(b){var f=a[b];!f&&e&&(f=2==a.length?function(c){a(b,c)}:a),d[b]=f&&function(a){f("[xmldom "+b+"]\t"+a+h(c))}||function(){}}if(!a){if(b instanceof f)return b;a=b}var d={},e=a instanceof Function;return c=c||{},g("warning"),g("error"),g("fatalError"),d}function f(){this.cdata=!1}function g(a,b){b.lineNumber=a.lineNumber,b.columnNumber=a.columnNumber}function h(a){if(a)return"\n@"+(a.systemId||"")+"#[line:"+a.lineNumber+",col:"+a.columnNumber+"]"}function i(a,b,c){return"string"==typeof a?a.substr(b,c):a.length>=b+c||b?new java.lang.String(a,b,c)+"":a}function j(a,b){a.currentElement?a.currentElement.appendChild(b):a.document.appendChild(b)}if(d.prototype.parseFromString=function(a,b){var c=this.options,d=new k,g=c.domBuilder||new f,h=c.errorHandler,i=c.locator,j=c.xmlns||{},l={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return i&&g.setDocumentLocator(i),d.errorHandler=e(h,g,i),d.domBuilder=c.domBuilder||g,/\/x?html?$/.test(b)&&(l.nbsp=" ",l.copy="©",j[""]="http://www.w3.org/1999/xhtml"),j.xml=j.xml||"http://www.w3.org/XML/1998/namespace",a?d.parse(a,j,l):d.errorHandler.error("invalid document source"),g.document},f.prototype={startDocument:function(){this.document=(new l).createDocument(null,null,null),this.locator&&(this.document.documentURI=this.locator.systemId)},startElement:function(a,b,c,d){var e=this.document,f=e.createElementNS(a,c||b),h=d.length;j(this,f),this.currentElement=f,this.locator&&g(this.locator,f);for(var i=0;i<h;i++){var a=d.getURI(i),k=d.getValue(i),c=d.getQName(i),l=e.createAttributeNS(a,c);l.getOffset&&g(l.getOffset(1),l),l.value=l.nodeValue=k,f.setAttributeNode(l)}},endElement:function(a,b,c){var d=this.currentElement;d.tagName;this.currentElement=d.parentNode},startPrefixMapping:function(a,b){},endPrefixMapping:function(a){},processingInstruction:function(a,b){var c=this.document.createProcessingInstruction(a,b);this.locator&&g(this.locator,c),j(this,c)},ignorableWhitespace:function(a,b,c){},characters:function(a,b,c){if(a=i.apply(this,arguments),this.currentElement&&a){if(this.cdata){var d=this.document.createCDATASection(a);this.currentElement.appendChild(d)}else{var d=this.document.createTextNode(a);this.currentElement.appendChild(d)}this.locator&&g(this.locator,d)}},skippedEntity:function(a){},endDocument:function(){this.document.normalize()},setDocumentLocator:function(a){(this.locator=a)&&(a.lineNumber=0)},comment:function(a,b,c){a=i.apply(this,arguments);var d=this.document.createComment(a);this.locator&&g(this.locator,d),j(this,d)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(a,b,c){var d=this.document.implementation;if(d&&d.createDocumentType){var e=d.createDocumentType(a,b,c);this.locator&&g(this.locator,e),j(this,e)}},warning:function(a){console.warn("[xmldom warning]\t"+a,h(this.locator))},error:function(a){console.error("[xmldom error]\t"+a,h(this.locator))},fatalError:function(a){throw console.error("[xmldom fatalError]\t"+a,h(this.locator)),a}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(a){f.prototype[a]=function(){return null}}),"function"==typeof a){var k=a("./sax").XMLReader,l=c.DOMImplementation=a("./dom").DOMImplementation;c.XMLSerializer=a("./dom").XMLSerializer,c.DOMParser=d}},{"./dom":40,"./sax":41}],40:[function(a,b,c){function d(a,b){for(var c in a)b[c]=a[c]}function e(a,b){function f(){}var c=a.prototype;if(Object.create){var e=Object.create(b.prototype);c.__proto__=e}c instanceof b||(f.prototype=b.prototype,f=new f,d(c,f),a.prototype=c=f),c.constructor!=a&&("function"!=typeof a&&console.error("unknow Class:"+a),c.constructor=a)}function K(a,b){if(b instanceof Error)var c=b;else c=this,Error.call(this,u[a]),this.message=u[a],Error.captureStackTrace&&Error.captureStackTrace(this,K);return c.code=a,b&&(this.message=this.message+": "+b),c}function L(){}function M(a,b){this._node=a,this._refresh=b,N(this)}function N(a){var b=a._node._inc||a._node.ownerDocument._inc;if(a._inc!=b){var c=a._refresh(a._node);ra(a,"length",c.length),d(c,a),a._inc=b}}function O(){}function P(a,b){for(var c=a.length;c--;)if(a[c]===b)return c}function Q(a,b,c,d){if(d?b[P(b,d)]=c:b[b.length++]=c,a){c.ownerElement=a;var e=a.ownerDocument;e&&(d&&Y(e,a,d),X(e,a,c))}}function R(a,b,c){var d=P(b,c);if(!(d>=0))throw K(C,new Error);for(var e=b.length-1;d<e;)b[d]=b[++d];
if(b.length=e,a){var f=a.ownerDocument;f&&(Y(f,a,c),c.ownerElement=null)}}function S(a){if(this._features={},a)for(var b in a)this._features=a[b]}function T(){}function U(a){return"<"==a&&"&lt;"||">"==a&&"&gt;"||"&"==a&&"&amp;"||'"'==a&&"&quot;"||"&#"+a.charCodeAt()+";"}function V(a,b){if(b(a))return!0;if(a=a.firstChild)do if(V(a,b))return!0;while(a=a.nextSibling)}function W(){}function X(a,b,c){a&&a._inc++;var d=c.namespaceURI;"http://www.w3.org/2000/xmlns/"==d&&(b._nsMap[c.prefix?c.localName:""]=c.value)}function Y(a,b,c,d){a&&a._inc++;var e=c.namespaceURI;"http://www.w3.org/2000/xmlns/"==e&&delete b._nsMap[c.prefix?c.localName:""]}function Z(a,b,c){if(a&&a._inc){a._inc++;var d=b.childNodes;if(c)d[d.length++]=c;else{for(var e=b.firstChild,f=0;e;)d[f++]=e,e=e.nextSibling;d.length=f}}}function $(a,b){var c=b.previousSibling,d=b.nextSibling;return c?c.nextSibling=d:a.firstChild=d,d?d.previousSibling=c:a.lastChild=c,Z(a.ownerDocument,a),b}function _(a,b,c){var d=b.parentNode;if(d&&d.removeChild(b),b.nodeType===r){var e=b.firstChild;if(null==e)return b;var f=b.lastChild}else e=f=b;var g=c?c.previousSibling:a.lastChild;e.previousSibling=g,f.nextSibling=c,g?g.nextSibling=e:a.firstChild=e,null==c?a.lastChild=f:c.previousSibling=f;do e.parentNode=a;while(e!==f&&(e=e.nextSibling));return Z(a.ownerDocument||a,a),b.nodeType==r&&(b.firstChild=b.lastChild=null),b}function aa(a,b){var c=b.parentNode;if(c){var d=a.lastChild;c.removeChild(b);var d=a.lastChild}var d=a.lastChild;return b.parentNode=a,b.previousSibling=d,b.nextSibling=null,d?d.nextSibling=b:a.firstChild=b,a.lastChild=b,Z(a.ownerDocument,a,b),b}function ba(){this._nsMap={}}function ca(){}function da(){}function ea(){}function fa(){}function ga(){}function ha(){}function ia(){}function ja(){}function ka(){}function la(){}function ma(){}function na(){}function oa(a,b,c,d){switch(a.nodeType){case h:var e=a.attributes,g=e.length,m=a.firstChild,s=a.tagName;d=f===a.namespaceURI||d,b.push("<",s),c&&b.sort.apply(e,c);for(var t=0;t<g;t++)oa(e.item(t),b,c,d);if(m||d&&!/^(?:meta|link|img|br|hr|input|button)$/i.test(s)){if(b.push(">"),d&&/^script$/i.test(s))m&&b.push(m.data);else for(;m;)oa(m,b,c,d),m=m.nextSibling;b.push("</",s,">")}else b.push("/>");return;case p:case r:for(var m=a.firstChild;m;)oa(m,b,c,d),m=m.nextSibling;return;case i:return b.push(" ",a.name,'="',a.value.replace(/[<&"]/g,U),'"');case j:return b.push(a.data.replace(/[<&]/g,U));case k:return b.push("<![CDATA[",a.data,"]]>");case o:return b.push("<!--",a.data,"-->");case q:var u=a.publicId,v=a.systemId;if(b.push("<!DOCTYPE ",a.name),u)b.push(' PUBLIC "',u),v&&"."!=v&&b.push('" "',v),b.push('">');else if(v&&"."!=v)b.push(' SYSTEM "',v,'">');else{var w=a.internalSubset;w&&b.push(" [",w,"]"),b.push(">")}return;case n:return b.push("<?",a.target," ",a.data,"?>");case l:return b.push("&",a.nodeName,";");default:b.push("??",a.nodeName)}}function pa(a,b,c){var d;switch(b.nodeType){case h:d=b.cloneNode(!1),d.ownerDocument=a;case r:break;case i:c=!0}if(d||(d=b.cloneNode(!1)),d.ownerDocument=a,d.parentNode=null,c)for(var e=b.firstChild;e;)d.appendChild(pa(a,e,c)),e=e.nextSibling;return d}function qa(a,b,c){var d=new b.constructor;for(var e in b){var f=b[e];"object"!=typeof f&&f!=d[e]&&(d[e]=f)}switch(b.childNodes&&(d.childNodes=new L),d.ownerDocument=a,d.nodeType){case h:var g=b.attributes,j=d.attributes=new O,k=g.length;j._ownerElement=d;for(var l=0;l<k;l++)d.setAttributeNode(qa(a,g.item(l),!0));break;case i:c=!0}if(c)for(var m=b.firstChild;m;)d.appendChild(qa(a,m,c)),m=m.nextSibling;return d}function ra(a,b,c){a[b]=c}function sa(a){switch(a.nodeType){case 1:case 11:var b=[];for(a=a.firstChild;a;)7!==a.nodeType&&8!==a.nodeType&&b.push(sa(a)),a=a.nextSibling;return b.join("");default:return a.nodeValue}}var f="http://www.w3.org/1999/xhtml",g={},h=g.ELEMENT_NODE=1,i=g.ATTRIBUTE_NODE=2,j=g.TEXT_NODE=3,k=g.CDATA_SECTION_NODE=4,l=g.ENTITY_REFERENCE_NODE=5,m=g.ENTITY_NODE=6,n=g.PROCESSING_INSTRUCTION_NODE=7,o=g.COMMENT_NODE=8,p=g.DOCUMENT_NODE=9,q=g.DOCUMENT_TYPE_NODE=10,r=g.DOCUMENT_FRAGMENT_NODE=11,s=g.NOTATION_NODE=12,t={},u={},C=(t.INDEX_SIZE_ERR=(u[1]="Index size error",1),t.DOMSTRING_SIZE_ERR=(u[2]="DOMString size error",2),t.HIERARCHY_REQUEST_ERR=(u[3]="Hierarchy request error",3),t.WRONG_DOCUMENT_ERR=(u[4]="Wrong document",4),t.INVALID_CHARACTER_ERR=(u[5]="Invalid character",5),t.NO_DATA_ALLOWED_ERR=(u[6]="No data allowed",6),t.NO_MODIFICATION_ALLOWED_ERR=(u[7]="No modification allowed",7),t.NOT_FOUND_ERR=(u[8]="Not found",8)),E=(t.NOT_SUPPORTED_ERR=(u[9]="Not supported",9),t.INUSE_ATTRIBUTE_ERR=(u[10]="Attribute in use",10));t.INVALID_STATE_ERR=(u[11]="Invalid state",11),t.SYNTAX_ERR=(u[12]="Syntax error",12),t.INVALID_MODIFICATION_ERR=(u[13]="Invalid modification",13),t.NAMESPACE_ERR=(u[14]="Invalid namespace",14),t.INVALID_ACCESS_ERR=(u[15]="Invalid access",15);K.prototype=Error.prototype,d(t,K),L.prototype={length:0,item:function(a){return this[a]||null},toString:function(){for(var a=[],b=0;b<this.length;b++)oa(this[b],a);return a.join("")}},M.prototype.item=function(a){return N(this),this[a]},e(M,L),O.prototype={length:0,item:L.prototype.item,getNamedItem:function(a){for(var b=this.length;b--;){var c=this[b];if(c.nodeName==a)return c}},setNamedItem:function(a){var b=a.ownerElement;if(b&&b!=this._ownerElement)throw new K(E);var c=this.getNamedItem(a.nodeName);return Q(this._ownerElement,this,a,c),c},setNamedItemNS:function(a){var c,b=a.ownerElement;if(b&&b!=this._ownerElement)throw new K(E);return c=this.getNamedItemNS(a.namespaceURI,a.localName),Q(this._ownerElement,this,a,c),c},removeNamedItem:function(a){var b=this.getNamedItem(a);return R(this._ownerElement,this,b),b},removeNamedItemNS:function(a,b){var c=this.getNamedItemNS(a,b);return R(this._ownerElement,this,c),c},getNamedItemNS:function(a,b){for(var c=this.length;c--;){var d=this[c];if(d.localName==b&&d.namespaceURI==a)return d}return null}},S.prototype={hasFeature:function(a,b){var c=this._features[a.toLowerCase()];return!(!c||b&&!(b in c))},createDocument:function(a,b,c){var d=new W;if(d.implementation=this,d.childNodes=new L,d.doctype=c,c&&d.appendChild(c),b){var e=d.createElementNS(a,b);d.appendChild(e)}return d},createDocumentType:function(a,b,c){var d=new ha;return d.name=a,d.nodeName=a,d.publicId=b,d.systemId=c,d}},T.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(a,b){return _(this,a,b)},replaceChild:function(a,b){this.insertBefore(a,b),b&&this.removeChild(b)},removeChild:function(a){return $(this,a)},appendChild:function(a){return this.insertBefore(a,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(a){return qa(this.ownerDocument||this,this,a)},normalize:function(){for(var a=this.firstChild;a;){var b=a.nextSibling;b&&b.nodeType==j&&a.nodeType==j?(this.removeChild(b),a.appendData(b.data)):(a.normalize(),a=b)}},isSupported:function(a,b){return this.ownerDocument.implementation.hasFeature(a,b)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(a){for(var b=this;b;){var c=b._nsMap;if(c)for(var d in c)if(c[d]==a)return d;b=2==b.nodeType?b.ownerDocument:b.parentNode}return null},lookupNamespaceURI:function(a){for(var b=this;b;){var c=b._nsMap;if(c&&a in c)return c[a];b=2==b.nodeType?b.ownerDocument:b.parentNode}return null},isDefaultNamespace:function(a){var b=this.lookupPrefix(a);return null==b}},d(g,T),d(g,T.prototype),W.prototype={nodeName:"#document",nodeType:p,doctype:null,documentElement:null,_inc:1,insertBefore:function(a,b){if(a.nodeType==r){for(var c=a.firstChild;c;){var d=c.nextSibling;this.insertBefore(c,b),c=d}return a}return null==this.documentElement&&1==a.nodeType&&(this.documentElement=a),_(this,a,b),a.ownerDocument=this,a},removeChild:function(a){return this.documentElement==a&&(this.documentElement=null),$(this,a)},importNode:function(a,b){return pa(this,a,b)},getElementById:function(a){var b=null;return V(this.documentElement,function(c){if(1==c.nodeType&&c.getAttribute("id")==a)return b=c,!0}),b},createElement:function(a){var b=new ba;b.ownerDocument=this,b.nodeName=a,b.tagName=a,b.childNodes=new L;var c=b.attributes=new O;return c._ownerElement=b,b},createDocumentFragment:function(){var a=new la;return a.ownerDocument=this,a.childNodes=new L,a},createTextNode:function(a){var b=new ea;return b.ownerDocument=this,b.appendData(a),b},createComment:function(a){var b=new fa;return b.ownerDocument=this,b.appendData(a),b},createCDATASection:function(a){var b=new ga;return b.ownerDocument=this,b.appendData(a),b},createProcessingInstruction:function(a,b){var c=new ma;return c.ownerDocument=this,c.tagName=c.target=a,c.nodeValue=c.data=b,c},createAttribute:function(a){var b=new ca;return b.ownerDocument=this,b.name=a,b.nodeName=a,b.localName=a,b.specified=!0,b},createEntityReference:function(a){var b=new ka;return b.ownerDocument=this,b.nodeName=a,b},createElementNS:function(a,b){var c=new ba,d=b.split(":"),e=c.attributes=new O;return c.childNodes=new L,c.ownerDocument=this,c.nodeName=b,c.tagName=b,c.namespaceURI=a,2==d.length?(c.prefix=d[0],c.localName=d[1]):c.localName=b,e._ownerElement=c,c},createAttributeNS:function(a,b){var c=new ca,d=b.split(":");return c.ownerDocument=this,c.nodeName=b,c.name=b,c.namespaceURI=a,c.specified=!0,2==d.length?(c.prefix=d[0],c.localName=d[1]):c.localName=b,c}},e(W,T),ba.prototype={nodeType:h,hasAttribute:function(a){return null!=this.getAttributeNode(a)},getAttribute:function(a){var b=this.getAttributeNode(a);return b&&b.value||""},getAttributeNode:function(a){return this.attributes.getNamedItem(a)},setAttribute:function(a,b){var c=this.ownerDocument.createAttribute(a);c.value=c.nodeValue=""+b,this.setAttributeNode(c)},removeAttribute:function(a){var b=this.getAttributeNode(a);b&&this.removeAttributeNode(b)},appendChild:function(a){return a.nodeType===r?this.insertBefore(a,null):aa(this,a)},setAttributeNode:function(a){return this.attributes.setNamedItem(a)},setAttributeNodeNS:function(a){return this.attributes.setNamedItemNS(a)},removeAttributeNode:function(a){return this.attributes.removeNamedItem(a.nodeName)},removeAttributeNS:function(a,b){var c=this.getAttributeNodeNS(a,b);c&&this.removeAttributeNode(c)},hasAttributeNS:function(a,b){return null!=this.getAttributeNodeNS(a,b)},getAttributeNS:function(a,b){var c=this.getAttributeNodeNS(a,b);return c&&c.value||""},setAttributeNS:function(a,b,c){var d=this.ownerDocument.createAttributeNS(a,b);d.value=d.nodeValue=""+c,this.setAttributeNode(d)},getAttributeNodeNS:function(a,b){return this.attributes.getNamedItemNS(a,b)},getElementsByTagName:function(a){return new M(this,function(b){var c=[];return V(b,function(d){d===b||d.nodeType!=h||"*"!==a&&d.tagName!=a||c.push(d)}),c})},getElementsByTagNameNS:function(a,b){return new M(this,function(c){var d=[];return V(c,function(e){e===c||e.nodeType!==h||"*"!==a&&e.namespaceURI!==a||"*"!==b&&e.localName!=b||d.push(e)}),d})}},W.prototype.getElementsByTagName=ba.prototype.getElementsByTagName,W.prototype.getElementsByTagNameNS=ba.prototype.getElementsByTagNameNS,e(ba,T),ca.prototype.nodeType=i,e(ca,T),da.prototype={data:"",substringData:function(a,b){return this.data.substring(a,a+b)},appendData:function(a){a=this.data+a,this.nodeValue=this.data=a,this.length=a.length},insertData:function(a,b){this.replaceData(a,0,b)},appendChild:function(a){throw new Error(u[3])},deleteData:function(a,b){this.replaceData(a,b,"")},replaceData:function(a,b,c){var d=this.data.substring(0,a),e=this.data.substring(a+b);c=d+c+e,this.nodeValue=this.data=c,this.length=c.length}},e(da,T),ea.prototype={nodeName:"#text",nodeType:j,splitText:function(a){var b=this.data,c=b.substring(a);b=b.substring(0,a),this.data=this.nodeValue=b,this.length=b.length;var d=this.ownerDocument.createTextNode(c);return this.parentNode&&this.parentNode.insertBefore(d,this.nextSibling),d}},e(ea,da),fa.prototype={nodeName:"#comment",nodeType:o},e(fa,da),ga.prototype={nodeName:"#cdata-section",nodeType:k},e(ga,da),ha.prototype.nodeType=q,e(ha,T),ia.prototype.nodeType=s,e(ia,T),ja.prototype.nodeType=m,e(ja,T),ka.prototype.nodeType=l,e(ka,T),la.prototype.nodeName="#document-fragment",la.prototype.nodeType=r,e(la,T),ma.prototype.nodeType=n,e(ma,T),na.prototype.serializeToString=function(a,b){return a.toString(b)},T.prototype.toString=function(a){var b=[];return oa(this,b,a),b.join("")};try{Object.defineProperty&&(Object.defineProperty(M.prototype,"length",{get:function(){return N(this),this.$$length}}),Object.defineProperty(T.prototype,"textContent",{get:function(){return sa(this)},set:function(a){switch(this.nodeType){case 1:case 11:for(;this.firstChild;)this.removeChild(this.firstChild);(a||String(a))&&this.appendChild(this.ownerDocument.createTextNode(a));break;default:this.data=a,this.value=value,this.nodeValue=a}}}),ra=function(a,b,c){a["$$"+b]=c})}catch(a){}"function"==typeof a&&(c.DOMImplementation=S,c.XMLSerializer=na)},{}],41:[function(a,b,c){function o(){}function p(a,b,c,d,e){function f(a){if(a>65535){a-=65536;var b=55296+(a>>10),c=56320+(1023&a);return String.fromCharCode(b,c)}return String.fromCharCode(a)}function g(a){var b=a.slice(1,-1);return b in c?c[b]:"#"===b.charAt(0)?f(parseInt(b.substr(1).replace("x","0x"))):(e.error("entity not found:"+a),a)}function h(b){if(b>p){var c=a.substring(p,b).replace(/&#?\w+;/g,g);m&&i(p),d.characters(c,0,b-p),p=b}}function i(b,c){for(;b>=k&&(c=l.exec(a));)j=c.index,k=j+c[0].length,m.lineNumber++;m.columnNumber=b-j+1}for(var j=0,k=0,l=/.+(?:\r\n?|\n)|.*$/g,m=d.locator,n=[{currentNSMap:b}],o={},p=0;;){try{var v=a.indexOf("<",p);if(v<0){if(!a.substr(p).match(/^\s*$/)){var z=d.document,A=z.createTextNode(a.substr(p));z.appendChild(A),d.currentElement=A}return}switch(v>p&&h(v),a.charAt(v+1)){case"/":var B=a.indexOf(">",v+3),C=a.substring(v+2,B),D=n.pop(),E=D.localNSMap;if(D.tagName!=C&&e.fatalError("end tag name: "+C+" is not match the current start tagName:"+D.tagName),d.endElement(D.uri,D.localName,C),E)for(var F in E)d.endPrefixMapping(F);B++;break;case"?":m&&i(v),B=x(a,v,d);break;case"!":m&&i(v),B=w(a,v,d,e);break;default:m&&i(v);var G=new y,B=r(a,v,G,g,e),H=G.length;if(m){if(H)for(var I=0;I<H;I++){var J=G[I];i(J.offset),J.offset=q(m,{})}i(B)}!G.closed&&u(a,B,G.tagName,o)&&(G.closed=!0,c.nbsp||e.warning("unclosed xml attribute")),s(G,d,n),"http://www.w3.org/1999/xhtml"!==G.uri||G.closed?B++:B=t(a,B,G.tagName,g,d)}}catch(a){e.error("element parse error: "+a),B=-1}B>p?p=B:h(Math.max(v,p)+1)}}function q(a,b){return b.lineNumber=a.lineNumber,b.columnNumber=a.columnNumber,b}function r(a,b,c,d,e){for(var f,o,p=++b,q=g;;){var r=a.charAt(p);switch(r){case"=":if(q===h)f=a.slice(b,p),q=j;else{if(q!==i)throw new Error("attribute equal must after attrName");q=j}break;case"'":case'"':if(q===j){if(b=p+1,p=a.indexOf(r,b),!(p>0))throw new Error("attribute value no end '"+r+"' match");o=a.slice(b,p).replace(/&#?\w+;/g,d),c.add(f,o,b-1),q=l}else{if(q!=k)throw new Error('attribute value must after "="');o=a.slice(b,p).replace(/&#?\w+;/g,d),c.add(f,o,b),e.warning('attribute "'+f+'" missed start quot('+r+")!!"),b=p+1,q=l}break;case"/":switch(q){case g:c.setTagName(a.slice(b,p));case l:case m:case n:q=n,c.closed=!0;case k:case h:case i:break;default:throw new Error("attribute invalid close char('/')")}break;case"":e.error("unexpected end of input");case">":switch(q){case g:c.setTagName(a.slice(b,p));case l:case m:case n:break;case k:case h:o=a.slice(b,p),"/"===o.slice(-1)&&(c.closed=!0,o=o.slice(0,-1));case i:q===i&&(o=f),q==k?(e.warning('attribute "'+o+'" missed quot(")!!'),c.add(f,o.replace(/&#?\w+;/g,d),b)):(e.warning('attribute "'+o+'" missed value!! "'+o+'" instead!!'),c.add(o,o,b));break;case j:throw new Error("attribute value missed!!")}return p;case"":r=" ";default:if(r<=" ")switch(q){case g:c.setTagName(a.slice(b,p)),q=m;break;case h:f=a.slice(b,p),q=i;break;case k:var o=a.slice(b,p).replace(/&#?\w+;/g,d);e.warning('attribute "'+o+'" missed quot(")!!'),c.add(f,o,b);case l:q=m}else switch(q){case i:e.warning('attribute "'+f+'" missed value!! "'+f+'" instead!!'),c.add(f,f,b),b=p,q=h;break;case l:e.warning('attribute space is required"'+f+'"!!');case m:q=h,b=p;break;case j:q=k,b=p;break;case n:throw new Error("elements closed character '/' and '>' must be connected to")}}p++}}function s(a,b,c){for(var d=a.tagName,e=null,f=c[c.length-1].currentNSMap,g=a.length;g--;){var h=a[g],i=h.qName,j=h.value,k=i.indexOf(":");if(k>0)var l=h.prefix=i.slice(0,k),m=i.slice(k+1),n="xmlns"===l&&m;else m=i,l=null,n="xmlns"===i&&"";h.localName=m,n!==!1&&(null==e&&(e={},v(f,f={})),f[n]=e[n]=j,h.uri="http://www.w3.org/2000/xmlns/",b.startPrefixMapping(n,j))}for(var g=a.length;g--;){h=a[g];var l=h.prefix;l&&("xml"===l&&(h.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==l&&(h.uri=f[l]))}var k=d.indexOf(":");k>0?(l=a.prefix=d.slice(0,k),m=a.localName=d.slice(k+1)):(l=null,m=a.localName=d);var o=a.uri=f[l||""];if(b.startElement(o,m,d,a),a.closed){if(b.endElement(o,m,d),e)for(l in e)b.endPrefixMapping(l)}else a.currentNSMap=f,a.localNSMap=e,c.push(a)}function t(a,b,c,d,e){if(/^(?:script|textarea)$/i.test(c)){var f=a.indexOf("</"+c+">",b),g=a.substring(b+1,f);if(/[&<]/.test(g))return/^script$/i.test(c)?(e.characters(g,0,g.length),f):(g=g.replace(/&#?\w+;/g,d),e.characters(g,0,g.length),f)}return b+1}function u(a,b,c,d){var e=d[c];return null==e&&(e=d[c]=a.lastIndexOf("</"+c+">")),e<b}function v(a,b){for(var c in a)b[c]=a[c]}function w(a,b,c,d){var e=a.charAt(b+2);switch(e){case"-":if("-"===a.charAt(b+3)){var f=a.indexOf("-->",b+4);return f>b?(c.comment(a,b+4,f-b-4),f+3):(d.error("Unclosed comment"),-1)}return-1;default:if("CDATA["==a.substr(b+3,6)){var f=a.indexOf("]]>",b+9);return c.startCDATA(),c.characters(a,b+9,f-b-9),c.endCDATA(),f+3}var g=A(a,b),h=g.length;if(h>1&&/!doctype/i.test(g[0][0])){var i=g[1][0],j=h>3&&/^public$/i.test(g[2][0])&&g[3][0],k=h>4&&g[4][0],l=g[h-1];return c.startDTD(i,j&&j.replace(/^(['"])(.*?)\1$/,"$2"),k&&k.replace(/^(['"])(.*?)\1$/,"$2")),c.endDTD(),l.index+l[0].length}}return-1}function x(a,b,c){var d=a.indexOf("?>",b);if(d){var e=a.substring(b,d).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(e){e[0].length;return c.processingInstruction(e[1],e[2]),d+2}return-1}return-1}function y(a){}function z(a,b){return a.__proto__=b,a}function A(a,b){var c,d=[],e=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(e.lastIndex=b,e.exec(a);c=e.exec(a);)if(d.push(c),c[1])return d}var d=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,e=new RegExp("[\\-\\.0-9"+d.source.slice(1,-1)+"·̀-ͯ\\u203F-⁀]"),f=new RegExp("^"+d.source+e.source+"*(?::"+d.source+e.source+"*)?$"),g=0,h=1,i=2,j=3,k=4,l=5,m=6,n=7;o.prototype={parse:function(a,b,c){var d=this.domBuilder;d.startDocument(),v(b,b={}),p(a,b,c,d,this.errorHandler),d.endDocument()}},y.prototype={setTagName:function(a){if(!f.test(a))throw new Error("invalid tagName:"+a);this.tagName=a},add:function(a,b,c){if(!f.test(a))throw new Error("invalid attribute:"+a);this[this.length++]={qName:a,value:b,offset:c}},length:0,getLocalName:function(a){return this[a].localName},getOffset:function(a){return this[a].offset},getQName:function(a){return this[a].qName},getURI:function(a){return this[a].uri},getValue:function(a){return this[a].value}},z({},z.prototype)instanceof z||(z=function(a,b){function c(){}c.prototype=b,c=new c;for(b in a)c[b]=a[b];return c}),"function"==typeof a&&(c.XMLReader=o)},{}],42:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./class-order"),i=a("./node"),j=function(a){function b(a){e(this,b);var c=f(this,Object.getPrototypeOf(b).call(this));return c.termType=b.termType,c.id=b.nextId++,c.value=a||c.id.toString(),c}return g(b,a),d(b,[{key:"compareTerm",value:function(b){return this.classOrder<b.classOrder?-1:this.classOrder>b.classOrder?1:this.id<b.id?-1:this.id>b.id?1:0}},{key:"copy",value:function(c){var d=new b;return c.copyTo(this,d),d}},{key:"toCanonical",value:function(){return"_:"+this.value}},{key:"toString",value:function(){return b.NTAnonymousNodePrefix+this.id}}]),b}(i);j.nextId=0,j.termType="BlankNode",j.NTAnonymousNodePrefix="_:n",j.prototype.classOrder=h.BlankNode,j.prototype.isBlank=1,j.prototype.isVar=1,b.exports=j},{"./class-order":43,"./node":58}],43:[function(a,b,c){"use strict";var d={Literal:1,Collection:3,Formula:4,NamedNode:5,BlankNode:6,Variable:7};b.exports=d},{}],44:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./blank-node"),i=a("./class-order"),j=a("./node"),k=function(a){function b(a){e(this,b);var c=f(this,Object.getPrototypeOf(b).call(this));return c.termType=b.termType,c.id=h.nextId++,c.elements=[],c.closed=!1,a&&a.length>0&&a.forEach(function(a){c.elements.push(j.fromValue(a))}),c}return g(b,a),d(b,[{key:"append",value:function(b){return this.elements.push(b)}},{key:"close",value:function(){return this.closed=!0,this.closed}},{key:"shift",value:function(){return this.elements.shift()}},{key:"substitute",value:function(c){var d=this.elements.map(function(a){a.substitute(c)});return new b(d)}},{key:"toNT",value:function(){return h.NTAnonymousNodePrefix+this.id}},{key:"toString",value:function(){return"("+this.elements.join(" ")+")"}},{key:"unshift",value:function(b){return this.elements.unshift(b)}}]),b}(j);k.termType="collection",k.prototype.classOrder=i.Collection,k.prototype.compareTerm=h.prototype.compareTerm,k.prototype.isVar=0,b.exports=k},{"./blank-node":42,"./class-order":43,"./node":58}],45:[function(a,b,c){"use strict";function g(a,b){var c,g=f.Parser(),h=f.Writer({format:"N-Quads"});d.waterfall([function(b){g.parse(a,b)},function(a,b,c){null!==a&&h.addTriple(a),"function"==typeof c&&h.end(c)},function(a,b){try{e.fromRDF(a,{format:"application/nquads"},b)}catch(a){b(a)}},function(a,d){c=JSON.stringify(a),b(null,c)}],function(a,d){b(a,c)})}function h(a,b){var c,e=f.Parser(),g=f.Writer({format:"N-Quads"});d.waterfall([function(b){e.parse(a,b)},function(a,b,c){null!==a&&g.addTriple(a),"function"==typeof c&&g.end(c)},function(a,d){c=a,b(null,c)}],function(a,d){b(a,c)})}b.exports.convertToJson=g,b.exports.convertToNQuads=h;var d=a("async"),e=a("jsonld"),f=a("n3")},{async:1,jsonld:13,n3:14}],46:[function(a,b,c){"use strict";function m(a){return new d(a)}function n(a){return new e(a)}function o(){return new f}function p(a,b,c){return new g(a,b,c)}function q(){return new h}function r(a,b,c){return new i(""+a,b,c)}function s(a,b){return"string"==typeof b?b.indexOf(":")===-1?new i(a,b):new i(a,null,t(b)):new i(a,null,b)}function t(a){return new j(a)}function u(a,b,c,d){return d=d||new f,new k(a,b,c,d)}function v(a,b,c,d){return new k(a,b,c,d)}function w(a,b,c){return u(a,b,c)}function x(a){return new l(a)}var d=a("./blank-node"),e=a("./collection"),f=a("./default-graph"),g=a("./fetcher"),h=a("./indexed-formula"),i=a("./literal"),j=a("./named-node"),k=a("./statement"),l=a("./variable");b.exports.blankNode=m,b.exports.defaultGraph=o,b.exports.graph=q,b.exports.literal=s,b.exports.namedNode=t,b.exports.quad=u,b.exports.triple=w,b.exports.variable=x,b.exports.collection=n,b.exports.fetcher=p,b.exports.lit=r,b.exports.st=v},{"./blank-node":42,"./collection":44,"./default-graph":47,"./fetcher":49,"./indexed-formula":51,"./literal":53,"./named-node":56,"./statement":68,"./variable":73}],47:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./node"),i=function(a){function b(){e(this,b);var a=f(this,Object.getPrototypeOf(b).call(this));return a.termType="DefaultGraph",a.value="",a}return g(b,a),d(b,[{key:"toCanonical",value:function(){return this.value}}]),b}(h);b.exports=i},{"./node":58}],48:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./node"),i=function(a){function b(){e(this,b);var a=f(this,Object.getPrototypeOf(b).call(this));return a.termType=b.termType,a}return g(b,a),d(b,[{key:"toString",value:function(){return"()"}}]),b}(h);i.termType="empty",b.exports=i},{"./node":58}],49:[function(a,b,c){"use strict";var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},e=a("./log"),f=a("./n3parser"),g=a("./named-node"),h=a("./namespace"),i=a("./parse"),j=a("./rdfaparser").parseRDFaDOM,k=a("./rdfxmlparser"),l=a("./uri"),m=a("./util"),n={"text/n3":!0,"text/turtle":!0,"application/rdf+xml":!0,"application/xhtml+xml":!0,"text/html":!0,"application/ld+json":!0},o=function a(b,c,o){this.store=b,this.thisURI="http://dig.csail.mit.edu/2005/ajar/ajaw/rdf/sources.js#SourceFetcher",this.timeout=c||3e4,this.async=null==o||o,this.appNode=this.store.bnode(),this.store.fetcher=this,this.requested={},this.redirectedTo={},this.fetchCallbacks={},this.nonexistant={},this.lookedUp={},this.handlers=[],this.mediatypes={};var p=this,q=this.store,r={};r.link=h("http://www.w3.org/2007/ont/link#"),r.http=h("http://www.w3.org/2007/ont/http#"),r.httph=h("http://www.w3.org/2007/ont/httph#"),r.rdf=h("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),r.rdfs=h("http://www.w3.org/2000/01/rdf-schema#"),r.dc=h("http://purl.org/dc/elements/1.1/"),p.mediatypes["image/*"]={q:.9},a.crossSiteProxy=function(b){return a.crossSiteProxyTemplate?a.crossSiteProxyTemplate.replace("{uri}",encodeURIComponent(b)):void 0},a.RDFXMLHandler=function(a){a&&(this.dom=a[0]),this.handlerFactory=function(a){a.handle=function(b){var c=p.store;this.dom||(this.dom=m.parseXML(a.responseText));var d=this.dom.documentElement;if("parsererror"===d.nodeName)throw p.failFetch(a,"Badly formed XML in "+a.resource.uri),new Error("Badly formed XML in "+a.resource.uri);var e=new k(c);try{e.parse(this.dom,a.original.uri,a.original)}catch(b){p.addStatus(a.req,"Syntax error parsing RDF/XML! "+b),console.log("Syntax error parsing RDF/XML! "+b)}a.options.noMeta||c.add(a.original,r.rdf("type"),r.link("RDFDocument"),p.appNode),b()}}},a.RDFXMLHandler.toString=function(){return"RDFXMLHandler"},a.RDFXMLHandler.register=function(a){a.mediatypes["application/rdf+xml"]={}},a.RDFXMLHandler.pattern=new RegExp("application/rdf\\+xml"),a.XHTMLHandler=function(a){a&&(this.dom=a[0]),this.handlerFactory=function(a){a.handle=function(b){var c,d;this.dom||(this.dom=m.parseXML(a.responseText));var e=p.store,f=this.dom.getElementsByTagName("title");f.length>0&&e.add(a.resource,r.dc("title"),e.literal(f[0].textContent),a.resource);for(var g=this.dom.getElementsByTagName("link"),h=g.length-1;h>=0;h--)c=g[h].getAttribute("rel"),d=!1,c||(c=g[h].getAttribute("rev"),d=!0),c&&p.linkData(a,c,g[h].getAttribute("href"),a.resource,d);for(var k=this.dom.getElementsByTagName("script"),l=0;l<k.length;l++){var o=k[l].getAttribute("type");n[o]&&i(k[l].textContent,e,a.original.uri,o)}if(a.options.noMeta||e.add(a.resource,r.rdf("type"),r.link("WebPage"),p.appNode),!a.options.noRDFa&&j)try{j(this.dom,e,a.original.uri)}catch(b){var q="Error trying to parse "+a.resource+" as RDFa:\n"+b+":\n"+b.stack;return void p.failFetch(a,q)}b()}}},a.XHTMLHandler.toString=function(){return"XHTMLHandler"},a.XHTMLHandler.register=function(a){a.mediatypes["application/xhtml+xml"]={}},a.XHTMLHandler.pattern=new RegExp("application/xhtml"),a.XMLHandler=function(){this.handlerFactory=function(a){a.handle=function(b){for(var c=m.parseXML(a.responseText),d=0;d<c.childNodes.length;d++)if(1===c.childNodes[d].nodeType){var e=c.childNodes[d].namespaceURI;if(e&&e===e.rdf)return p.addStatus(a.req,"Has XML root element in the RDF namespace, so assume RDF/XML."),void p.switchHandler("RDFXMLHandler",a,b,[c]);break}if(c.doctype&&"html"===c.doctype.name&&c.doctype.publicId.match(/^-\/\/W3C\/\/DTD XHTML/)&&c.doctype.systemId.match(/http:\/\/www.w3.org\/TR\/xhtml/))return p.addStatus(a.req,"Has XHTML DOCTYPE. Switching to XHTML Handler.\n"),void p.switchHandler("XHTMLHandler",a,b);var f=c.getElementsByTagName("html")[0];if(f){var g=f.getAttribute("xmlns");if(g&&g.match(/^http:\/\/www.w3.org\/1999\/xhtml/))return p.addStatus(a.req,"Has a default namespace for XHTML. Switching to XHTMLHandler.\n"),void p.switchHandler("XHTMLHandler",a,b)}p.failFetch(a,"Unsupported dialect of XML: not RDF or XHTML namespace, etc.\n"+a.responseText.slice(0,80))}}},a.XMLHandler.toString=function(){return"XMLHandler"},a.XMLHandler.register=function(a){a.mediatypes["text/xml"]={q:.2},a.mediatypes["application/xml"]={q:.2}},a.XMLHandler.pattern=new RegExp("(text|application)/(.*)xml"),a.HTMLHandler=function(){this.handlerFactory=function(a){a.handle=function(b){var c=a.responseText;if(c.match(/\s*<\?xml\s+version\s*=[^<>]+\?>/))return p.addStatus(a.req,"Has an XML declaration. We'll assume it's XHTML as the content-type was text/html.\n"),void p.switchHandler("XHTMLHandler",a,b);if(c.match(/.*<!DOCTYPE\s+html[^<]+-\/\/W3C\/\/DTD XHTML[^<]+http:\/\/www.w3.org\/TR\/xhtml[^<]+>/))return p.addStatus(a.req,"Has XHTML DOCTYPE. Switching to XHTMLHandler.\n"),
void p.switchHandler("XHTMLHandler",a,b);if(c.match(/[^(<html)]*<html\s+[^<]*xmlns=['"]http:\/\/www.w3.org\/1999\/xhtml["'][^<]*>/))return p.addStatus(a.req,"Has default namespace for XHTML, so switching to XHTMLHandler.\n"),void p.switchHandler("XHTMLHandler",a,b);var d=new RegExp("<title>([\\s\\S]+?)</title>","im").exec(c);if(d){var e=p.store;return e.add(a.resource,r.dc("title"),e.literal(d[1]),a.resource),e.add(a.resource,r.rdf("type"),r.link("WebPage"),p.appNode),void b()}p.addStatus(a.req,"non-XML HTML document, not parsed for data."),p.doneFetch(a)}}},a.HTMLHandler.toString=function(){return"HTMLHandler"},a.HTMLHandler.register=function(a){a.mediatypes["text/html"]={q:.3}},a.HTMLHandler.pattern=new RegExp("text/html"),a.TextHandler=function(){this.handlerFactory=function(a){a.handle=function(b){var c=a.responseText;return c.match(/\s*<\?xml\s+version\s*=[^<>]+\?>/)?(p.addStatus(a.req,"Warning: "+a.resource+" has an XML declaration. We'll assume it's XML but its content-type wasn't XML.\n"),void p.switchHandler("XMLHandler",a,b)):c.slice(0,500).match(/xmlns:/)?(p.addStatus(a.req,"May have an XML namespace. We'll assume it's XML but its content-type wasn't XML.\n"),void p.switchHandler("XMLHandler",a,b)):(p.addStatus(a.req,"Plain text document, no known RDF semantics."),void p.doneFetch(a))}}},a.TextHandler.toString=function(){return"TextHandler"},a.TextHandler.register=function(a){a.mediatypes["text/plain"]={q:.1}},a.TextHandler.pattern=new RegExp("text/plain"),a.N3Handler=function(){this.handlerFactory=function(a){a.handle=function(b){var c=f(q,q,a.original.uri,a.original.uri,null,null,"",null);try{c.loadBuf(a.responseText)}catch(b){var d="Error trying to parse "+a.resource+" as Notation3:\n"+b+":\n"+b.stack;return void p.failFetch(a,d)}p.addStatus(a.req,"N3 parsed: "+c.statementCount+" triples in "+c.lines+" lines."),p.store.add(a.original,r.rdf("type"),r.link("RDFDocument"),p.appNode),p.doneFetch(a)}}},a.N3Handler.toString=function(){return"N3Handler"},a.N3Handler.register=function(a){a.mediatypes["text/n3"]={q:"1.0"},a.mediatypes["application/x-turtle"]={q:1},a.mediatypes["text/turtle"]={q:1}},a.N3Handler.pattern=new RegExp("(application|text)/(x-)?(rdf\\+)?(n3|turtle)"),m.callbackify(this,["request","recv","headers","load","fail","refresh","retract","done"]),this.addHandler=function(a){p.handlers.push(a),a.register(p)},this.switchHandler=function(b,c,e,f){for(var g=null,h=0;h<this.handlers.length;h++)""+this.handlers[h]===b&&(g=this.handlers[h]);if(!g)throw new Error("web.js: switchHandler: name="+b+" , this.handlers ="+this.handlers+"\nswitchHandler: switching to "+g+"; sf="+p+"; typeof Fetcher="+("undefined"==typeof a?"undefined":d(a))+";\n\t Fetcher.HTMLHandler="+a.HTMLHandler+"\n\n\tsf.handlers="+p.handlers+"\n");new g(f).handlerFactory(c),c.handle(e)},this.addStatus=function(a,b){var c=new Date;b="["+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()+"."+c.getMilliseconds()+"] "+b;var d=this.store,f=d.the(a,r.link("status"));f&&f.append?f.append(d.literal(b)):e.warn("web.js: No list to add to: "+f+","+b)},this.failFetch=function(a,b){for(this.addStatus(a.req,b),a.options.noMeta||q.add(a.original,r.link("error"),b),a.resource.sameTerm(a.original)?console.log("@@ Recording failure for "+a.original+": "+a.status):console.log("@@ Recording failure original "+a.original+"( as "+a.resource+") : "+a.status),this.requested[l.docpart(a.original.uri)]=a.status;this.fetchCallbacks[a.original.uri]&&this.fetchCallbacks[a.original.uri].length;)this.fetchCallbacks[a.original.uri].shift()(!1,"Fetch of <"+a.original.uri+"> failed: "+b,a);return delete this.fetchCallbacks[a.original.uri],this.fireCallbacks("fail",[a.original.uri,b]),a.abort(),a},this.linkData=function(a,b,c,d,e){if(c){var f,g=q.sym(l.join(c,a.original.uri));if("alternate"===b||"seeAlso"===b||"meta"===b||"describedby"===b){if(g.uri===a.original.uri)return;f=r.rdfs("seeAlso")}else f="type"===b?q.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):q.sym(l.join(b,"http://www.iana.org/assignments/link-relations/"));e?q.add(g,f,a.original,d):q.add(a.original,f,g,d)}},this.parseLinkHeader=function(a,b){var c;try{c=a.getResponseHeader("link")}catch(a){}if(c)for(var d=/<[^>]*>\s*(\s*;\s*[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*")))*(,|$)/g,e=/[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*"))/g,f=c.match(d),g=0;g<f.length;g++)for(var h=f[g].split(">"),i=h[0].substring(1),j=h[1],k=j.match(e),l=0;l<k.length;l++){var m=k[l],n=m.split("="),o=n[1].replace(/["']/g,"");this.linkData(a,o,i,b)}},this.doneFetch=function(a){for(this.addStatus(a.req,"Done."),this.requested[a.original.uri]="done";this.fetchCallbacks[a.original.uri]&&this.fetchCallbacks[a.original.uri].length;)this.fetchCallbacks[a.original.uri].shift()(!0,void 0,a);delete this.fetchCallbacks[a.original.uri],this.fireCallbacks("done",[a.original.uri])};var s=[a.RDFXMLHandler,a.XHTMLHandler,a.XMLHandler,a.HTMLHandler,a.TextHandler,a.N3Handler];s.map(this.addHandler),this.nowKnownAs=function(a,b){this.lookedUp[a.uri]?this.lookedUp[b.uri]||this.lookUpThing(b,a):this.lookedUp[b.uri]&&(this.lookedUp[a.uri]||this.lookUpThing(a,b))},this.webOperation=function(a,b,c){b=b.uri||b,c=c||{},b=this.proxyIfNecessary(b);var d=this;return new Promise(function(e,f){var g=m.XMLHTTPFactory();g.options=c,g.original=d.store.sym(b),c.noMeta||"undefined"==typeof tabulator||d.saveRequestMetadata(g,d.store,b),g.onreadystatechange=function(){if(4===g.readyState){var a=!g.status||g.status>=200&&g.status<300;c.noMeta||"undefined"==typeof tabulator||d.saveResponseMetadata(g,d.store),a?e(g):f(g.status+" "+g.statusText)}},g.open(a,b,!0),c.contentType&&g.setRequestHeader("Content-type",c.contentType),g.send(c.data?c.data:void 0)})},this.webCopy=function(a,b,c){var d=this;return a=a.uri||a,new Promise(function(e,f){d.webOperation("GET",a).then(function(a){d.webOperation("PUT",b,{data:a.responseText,contentType:c}).then(function(a){e(a)}).catch(function(a){f(a)})}).catch(function(a){f(a)})})},this.lookUpThing=function(a,b,c,d,e){var j,f=q.uris(a),g=!0,h="",i={};if(c===!1||c===!0?(j=c,c={force:j}):(void 0===c&&(c={}),j=!!c.force),"undefined"!=typeof f)for(var k=0;k<f.length;k++){var m=f[k];i[m]=!0,this.lookedUp[m]=!0;var n=this,o=function(f){n.requestURI(l.docpart(f),b,c,function(a,b,c){a?d&&d(!0,f):(d&&d(!1,b),g=!1,h+=b+"\n"),delete i[m],Object.keys(i).length>0||e&&e(g,h)})};o(m)}return f.length},this.load=function(a,b){var c=this;if(a instanceof Array){var d=a.map(function(a){return c.load(a)});return Promise.all(d)}return a=a.uri||a,new Promise(function(d,e){c.nowOrWhenFetched(a,b,function(a,b,c){a?d(c):e(b)})})},this.nowOrWhenFetched=function(a,b,c,d){a=a.uri||a,"function"==typeof b?(d={},c=b):"undefined"==typeof b||(d=b instanceof g?{referingTerm:b}:b),this.requestURI(a,b,d||{},c)},this.get=this.nowOrWhenFetched,this.getHeader=function(a,b){for(var c=this.store,d=c.each(void 0,r.link("requestedURI"),a.uri),e=0;e<d.length;e++){var f=d[e];if(void 0!==f){var g=c.any(f,r.link("response"));if(void 0!==f){var h=c.each(g,r.httph(b.toLowerCase()));return h.length?h.map(function(a){return a.value}):[]}}}},this.proxyIfNecessary=function(b){if("undefined"!=typeof tabulator&&tabulator.isExtension)return b;if("undefined"!=typeof $SolidTestEnvironment&&$SolidTestEnvironment.localSiteMap){var c=b.split("/").slice(2),d=function a(b,c){var d=c[b.shift()];return d?"string"==typeof d?d+b.join("/"):b?a(b,d):null:null},e=d(c,$SolidTestEnvironment.localSiteMap);if(e)return e}return a.crossSiteProxyTemplate&&"undefined"!=typeof document&&document.location&&"https:"===(""+document.location).slice(0,6)&&"http:"===b.slice(0,5)?a.crossSiteProxyTemplate.replace("{uri}",encodeURIComponent(b)):b},this.saveRequestMetadata=function(a,b,c){var d=b.bnode();if(a.resource=b.sym(c),a.req=d,!a.options.noMeta){var e=new Date,f="["+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+"] ";b.add(d,r.rdfs("label"),b.literal(f+" Request for "+c),this.appNode),b.add(d,r.link("requestedURI"),b.literal(c),this.appNode),a.original&&a.original.uri!==c&&b.add(d,r.link("orginalURI"),b.literal(a.original.uri),this.appNode),b.add(d,r.link("status"),b.collection(),this.appNode)}return d},this.saveResponseMetadata=function(a,b){var c=b.bnode();if(a.req&&b.add(a.req,r.link("response"),c),b.add(c,r.http("status"),b.literal(a.status),c),b.add(c,r.http("statusText"),b.literal(a.statusText),c),a.headers={},"http"===l.protocol(a.resource.uri)||"https"===l.protocol(a.resource.uri)){a.headers=m.getHTTPHeaders(a);for(var d in a.headers)b.add(c,r.httph(d.toLowerCase()),a.headers[d].trim(),c)}return c},this.requestURI=function(b,c,d,f){b=b.uri||b,b=b.split("#")[0],"boolean"==typeof d&&(d={force:d}),"undefined"==typeof d&&(d={});var g=!!d.force,h=this.store,i=arguments,j=d.baseURI||b;d.userCallback=f;var k=l.protocol(b);if("tel"===k||"mailto"===k||"urn"===k)return console.log("Unsupported protocol in: "+b),f(!1,"Unsupported protocol",{status:900})||void 0;var n=h.sym(b),o=this.getState(b);if(g)delete this.nonexistant[b];else{if("fetched"===o)return f?f(!0):void 0;if("failed"===o)return f?f(!1,"Previously failed. "+this.requested[b],{status:this.requested[b]}):void 0}if(this.fireCallbacks("request",i),f&&(this.fetchCallbacks[b]?this.fetchCallbacks[b].push(f):this.fetchCallbacks[b]=[f]),this.requested[b]!==!0){this.requested[b]=!0,!d.noMeta&&c&&c.uri&&h.add(n.uri,r.link("requestedBy"),c.uri,this.appNode);var p=m.XMLHTTPFactory(),q=p.req=h.bnode();p.original=h.sym(j),p.options=d,p.resource=n;var s=this,t=new Date,u="["+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()+"] ";d.noMeta||(h.add(q,r.rdfs("label"),h.literal(u+" Request for "+b),this.appNode),h.add(q,r.link("requestedURI"),h.literal(b),this.appNode),h.add(q,r.link("status"),h.collection(),this.appNode));var v=function(){if(!p.withCredentials)return!1;if(p.retriedWithCredentials)return!0;p.retriedWithCredentials=!0,console.log("web: Retrying with no credentials for "+p.resource),p.abort(),delete s.requested[b];var e={};for(var f in d)d.hasOwnProperty(f)&&(e[f]=d[f]);return e.withCredentials=!1,s.addStatus(p.req,"Abort: Will retry with credentials SUPPRESSED to see if that helps"),s.requestURI(b,c,e,p.userCallback),!0},w=function(c){return function(b){if(c.onErrorWasCalled=!0,"undefined"!=typeof document&&a.crossSiteProxyTemplate&&document.location&&!c.proxyUsed){var d=l.hostpart,e=""+document.location,f=c.resource.uri;if(d(e)&&d(f)&&d(e)!==d(f))if(401===c.status||403===c.status||404===c.status)x(c)();else{if(v(c))return;var g=a.crossSiteProxy(f);if(console.log("web: Direct failed so trying proxy "+g),s.addStatus(c.req,"BLOCKED -> Cross-site Proxy to <"+g+">"),c.aborted)return;var h=s.store,i=c.req;c.options.noMeta||h.add(i,r.http("redirectedTo"),h.sym(g),i),c.abort(),c.aborted=!0,s.addStatus(i,"redirected to new request"),s.requested[c.resource.uri]="redirected",s.redirectedTo[c.resource.uri]=g,s.fetchCallbacks[c.resource.uri]&&(s.fetchCallbacks[g]||(s.fetchCallbacks[g]=[]),s.fetchCallbacks[g]===s.fetchCallbacks[g].concat(s.fetchCallbacks[c.resource.uri]),delete s.fetchCallbacks[c.resource.uri]);var j=s.requestURI(g,c.resource,c.options,c.userCallback);if(j&&(j.proxyUsed=!0,j.original=c.original,console.log("Proxying but original still "+j.original)),j&&j.req)return void(c.options.noMeta||h.add(c.req,h.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),j.req,s.appNode))}c.status=999}}},x=function(c){return function(){var a=function(){if(!c.handleResponseDone){c.handleResponseDone=!0;var e=null,f=c.req;s.fireCallbacks("recv",i);var h=s.store;if(s.saveResponseMetadata(c,h),s.fireCallbacks("headers",[{uri:b,headers:c.headers}]),0===c.status){if(console.log("Masked error - status 0 for "+c.resource.uri),v(c))return;return void(c.status=900)}if(c.status>=400){if(404===c.status&&(h.fetcher.nonexistant[c.resource.uri]=!0),c.responseText.length>10){var j=h.bnode();h.add(j,r.http("content"),h.literal(c.responseText),j),c.statusText&&h.add(j,r.http("statusText"),h.literal(c.statusText),j)}return void s.failFetch(c,"HTTP error for "+c.resource+": "+c.status+" "+c.statusText)}var o,k=c.headers["content-location"],m=function(b){var c=f;if(k){var d=h.any(c,r.link("requestedURI"));d!==k&&h.add(h.sym(k),r.rdf("type"),b,s.appNode)}for(;;){var e=h.any(c,r.link("requestedURI"));if(e&&e.value&&h.add(h.sym(e.value),r.rdf("type"),b,s.appNode),c=h.any(void 0,h.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),c),!c)break;var g=h.any(c,h.sym("http://www.w3.org/2007/ont/link#response"));if(!g)break;var i=h.any(g,h.sym("http://www.w3.org/2007/ont/http#status"));if(!i)break;if("301"!==i&&"302"!==i)break}},n={rdf:"application/rdf+xml",owl:"application/rdf+xml",n3:"text/n3",ttl:"text/turtle",nt:"text/n3",acl:"text/n3",html:"text/html",xml:"text/xml"};if(200===c.status){m(r.link("Document"));var p=c.headers["content-type"];d.forceContentType&&(c.headers["content-type"]=d.forceContentType),(!p||p.indexOf("application/octet-stream")>=0)&&(o=n[c.resource.uri.split(".").pop()],o&&(c.headers["content-type"]=o)),p&&(0!==p.indexOf("image/")&&0!==p.indexOf("application/pdf")||m(h.sym("http://purl.org/dc/terms/Image"))),d.clearPreviousData&&h.removeDocument(c.resource)}if("file"!==l.protocol(c.resource.uri)&&"chrome"!==l.protocol(c.resource.uri)||(d.forceContentType?c.headers["content-type"]=d.forceContentType:(o=n[c.resource.uri.split(".").pop()],o?c.headers["content-type"]=o:c.headers["content-type"]="text/xml")),k){var q=l.join(c.resource.uri,k);if(!g&&q!==c.resource.uri&&s.requested[q]&&"done"===s.requested[q])return s.doneFetch(c),void c.abort();s.requested[q]=!0}for(var t=0;t<s.handlers.length;t++)if(c.headers["content-type"]&&c.headers["content-type"].match(s.handlers[t].pattern)){e=new s.handlers[t];break}if(s.parseLinkHeader(c,f),!e)return void s.doneFetch(c);try{e.handlerFactory(c)}catch(a){s.failFetch(c,"Exception handling content-type "+c.headers["content-type"]+" was: "+a)}}};switch(c.readyState){case 0:var f,e=c.resource.uri;if(this.crossSiteProxyTemplate&&"undefined"!=typeof document&&document.location){var h=l.hostpart,j=""+document.location;if(h(j)&&h(e)&&h(j)!==h(e)){if(f=this.crossSiteProxyTemplate.replace("{uri}",encodeURIComponent(e)),s.addStatus(c.req,"BLOCKED -> Cross-site Proxy to <"+f+">"),c.aborted)return;var k=s.store,m=c.req;k.add(m,r.http("redirectedTo"),k.sym(f),m);var n=c.req=k.bnode();k.add(m,r.http("redirectedRequest"),n,c.req);var o=new Date,p="["+o.getHours()+":"+o.getMinutes()+":"+o.getSeconds()+"] ";k.add(n,r.rdfs("label"),k.literal(p+" Request for "+f),this.appNode),k.add(n,r.link("status"),k.collection(),this.appNode),k.add(n,r.link("requestedURI"),k.literal(f),this.appNode);var q=k.bnode();k.add(m,r.link("response"),q),c.abort(),c.aborted=!0,c.redirected=!0,s.addStatus(m,"redirected XHR"),s.fetchCallbacks[c.resource.uri]&&(s.fetchCallbacks[f]||(s.fetchCallbacks[f]=[]),s.fetchCallbacks[f]===s.fetchCallbacks[f].concat(s.fetchCallbacks[c.resource.uri]),delete s.fetchCallbacks[c.resource.uri]),s.fireCallbacks("redirected",i),s.requested[c.resource.uri]="redirected";var t=s.requestURI(f,c.resource,c.options||{},c.userCallback);if(t&&t.req)return void k.add(c.req,k.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),t.req,s.appNode)}}s.failFetch(c,"HTTP Blocked. (ReadyState 0) Cross-site violation for <"+b+">");break;case 3:break;case 4:if(a(),c.handle&&void 0!==c.responseText){if("redirected"===s.requested[c.resource.uri])break;s.fireCallbacks("load",i),c.handle(function(){s.doneFetch(c)})}else c.redirected?s.addStatus(c.req,"Aborted and redirected to new request."):s.addStatus(c.req,"Fetch over. No data handled. Aborted = "+c.aborted)}}},y=b;"undefined"!=typeof tabulator&&tabulator.preferences.get("offlineModeUsingLocalhost")&&"http://"===y.slice(0,7)&&"localhost/"!==y.slice(7,17)&&(y="http://localhost/"+y.slice(7),e.warn("Localhost kludge for offline use: actually getting <"+y+">"));var z="https:"===y.slice(0,6);void 0!==d.withCredentials&&(z=d.withCredentials);var A=this.proxyIfNecessary(y);p.onerror=w(p),p.onreadystatechange=x(p),p.timeout=s.timeout,p.withCredentials=z,p.actualProxyURI=A,p.req=q,p.options=d,p.options=d,p.resource=n,p.requestedURI=y,p.ontimeout=function(){s.failFetch(p,"requestTimeout")};try{p.open("GET",A,this.async)}catch(a){return this.failFetch(p,"XHR open for GET failed for <"+y+">:\n\t"+a)}if(g&&p.setRequestHeader("Cache-control","no-cache"),"undefined"!=typeof tabulator&&tabulator.isExtension&&p.channel&&("http"===l.protocol(p.resource.uri)||"https"===l.protocol(p.resource.uri)))try{p.channel.notificationCallbacks={getInterface:function(b){return b.equals(Components.interfaces.nsIChannelEventSink)?{onChannelRedirect:function(b,e,f){if(!p.aborted){var g=s.store,h=e.URI.spec,j=p.req;if(!p.options.noMeta){s.addStatus(p.req,"Redirected: "+p.status+" to <"+h+">"),g.add(j,r.http("redirectedTo"),g.sym(h),p.req);var k=p.req=g.bnode();g.add(j,r.http("redirectedRequest"),k,this.appNode);var m=new Date,n="["+m.getHours()+":"+m.getMinutes()+":"+m.getSeconds()+"] ";g.add(k,r.rdfs("label"),g.literal(n+" Request for "+h),this.appNode),g.add(k,r.link("status"),g.collection(),this.appNode),g.add(k,r.link("requestedURI"),g.literal(h),this.appNode);var o=g.bnode();g.add(j,r.link("response"),o),g.add(o,r.http("status"),g.literal(p.status),o),p.statusText&&g.add(o,r.http("statusText"),g.literal(p.statusText),o)}if(p.status-0!==303&&(g.HTTPRedirects[p.resource.uri]=h),p.status-0===301&&c){var q=l.docpart(c.uri),t="Warning: "+p.resource+" has moved to <"+h+">.";c&&(t+=" Link in <"+q+" >should be changed",g.add(q,g.sym("http://www.w3.org/2007/ont/link#warning"),t,s.appNode))}p.abort(),p.aborted=!0,s.fetchCallbacks[p.resource.uri]&&(s.fetchCallbacks[h]||(s.fetchCallbacks[h]=[]),s.fetchCallbacks[h]===s.fetchCallbacks[h].concat(s.fetchCallbacks[p.resource.uri]),delete s.fetchCallbacks[p.resource.uri]),s.addStatus(j,"redirected"),s.fireCallbacks("redirected",i),s.requested[p.resource.uri]="redirected",s.redirectedTo[p.resource.uri]=h;var u=h.indexOf("#");u>=0&&(p.options.noMeta||g.add(p.resource,g.sym("http://www.w3.org/2007/ont/link#warning"),"Warning: "+p.resource+" HTTP redirects to"+h+' which should not contain a "#" sign'),h=h.slice(0,u));var v=s.requestURI(h,p.resource,p.options,p.userCallback);v&&v.req&&!d.noMeta&&g.add(p.req,g.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),v.req,s.appNode)}},asyncOnChannelRedirect:function(b,d,e,f){if(!p.aborted){var g=s.store,h=d.URI.spec,i=p.req;s.addStatus(p.req,"Redirected: "+p.status+" to <"+h+">"),g.add(i,r.http("redirectedTo"),g.sym(h),p.req);var j=p.req=g.bnode();g.add(i,r.http("redirectedRequest"),j,p.req);var k=new Date,m="["+k.getHours()+":"+k.getMinutes()+":"+k.getSeconds()+"] ";g.add(j,r.rdfs("label"),g.literal(m+" Request for "+h),this.appNode),g.add(j,r.link("status"),g.collection(),this.appNode),g.add(j,r.link("requestedURI"),g.literal(h),this.appNode);var n=g.bnode();if(g.add(i,r.link("response"),n),g.add(n,r.http("status"),g.literal(p.status),n),p.statusText&&g.add(n,r.http("statusText"),g.literal(p.statusText),n),p.status-0!==303&&(g.HTTPRedirects[p.resource.uri]=h),p.status-0===301&&c){var o=l.docpart(c.uri),q="Warning: "+p.resource+" has moved to <"+h+">.";c&&(q+=" Link in <"+o+" >should be changed",g.add(o,g.sym("http://www.w3.org/2007/ont/link#warning"),q,s.appNode))}p.abort(),p.aborted=!0;var t=h.indexOf("#");if(t>=0){var u="Warning: "+p.resource+" HTTP redirects to"+h+' which do not normally contain a "#" sign';g.add(p.resource,g.sym("http://www.w3.org/2007/ont/link#warning"),u),h=h.slice(0,t)}s.requested[p.resource.uri]="redirected",s.redirectedTo[p.resource.uri]=h;var v=s.requestURI(h,p.resource,p.options,p.userCallback);v&&(v.original=p.original,v.req&&g.add(p.req,g.sym("http://www.w3.org/2007/ont/link#redirectedRequest"),v.req,s.appNode))}}}:Components.results.NS_NOINTERFACE}}}catch(a){return s.failFetch(p,"@@ Couldn't set callback for redirects: "+a)}try{var B="";for(var C in this.mediatypes){""!==B&&(B+=", "),B+=C;for(var D in this.mediatypes[C])B+=";"+D+"="+this.mediatypes[C][D]}p.setRequestHeader("Accept",B),this.addStatus(p.req,"Accept: "+B)}catch(a){throw new Error("Can't set Accept header: "+a)}try{p.send(null)}catch(a){return this.failFetch(p,"XHR send failed:"+a)}return setTimeout(function(){4!==p.readyState&&s.isPending(p.resource.uri)&&s.failFetch(p,"requestTimeout")},this.timeout),this.addStatus(p.req,"HTTP Request sent."),p}},this.objectRefresh=function(a){var b=q.uris(a);if("undefined"!=typeof b)for(var c=0;c<b.length;c++)this.refresh(this.store.sym(l.docpart(b[c])))},this.unload=function(a){this.store.removeMany(void 0,void 0,void 0,a),delete this.requested[a.uri]},this.refresh=function(a,b){this.fireCallbacks("refresh",arguments),this.requestURI(a.uri,void 0,{force:!0,clearPreviousData:!0},b)},this.retract=function(a){this.store.removeMany(void 0,void 0,void 0,a),a.uri&&delete this.requested[l.docpart(a.uri)],this.fireCallbacks("retract",arguments)},this.getState=function(a){return"undefined"==typeof this.requested[a]?"unrequested":this.requested[a]===!0?"requested":"done"===this.requested[a]?"fetched":"redirected"===this.requested[a]?this.getState(this.redirectedTo[a]):"failed"},this.isPending=function(a){return this.requested[a]===!0}};b.exports=o},{"./log":54,"./n3parser":55,"./named-node":56,"./namespace":57,"./parse":59,"./rdfaparser":63,"./rdfxmlparser":64,"./uri":71,"./util":72}],50:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./blank-node"),i=a("./class-order"),j=a("./collection"),k=a("./literal"),l=a("./log"),m=a("./named-node"),n=a("./node"),o=a("./serialize"),p=a("./statement"),q=a("./variable"),r=function(a){function b(a,c,d,g){e(this,b);var h=f(this,Object.getPrototypeOf(b).call(this));return h.termType=b.termType,h.statements=a||[],h.constraints=c||[],h.initBindings=d||[],h.optional=g||[],h}return g(b,a),d(b,[{key:"add",value:function(b,c,d,e){return this.statements.push(new p(b,c,d,e))}},{key:"addStatement",value:function(b){return this.statements.push(b)}},{key:"bnode",value:function(b){return new h(b)}},{key:"bottomTypeURIs",value:function(b){var c,d,e,f,g,h,i,j,k;c=[];for(g in b)if(b.hasOwnProperty(g)){for(k=b[g],j=this.each(void 0,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),this.sym(g)),d=!0,f=0,h=j.length;f<h;f++)if(e=j[f],i=e.uri,i in b){d=!1;break}d&&(c[g]=k)}return c}},{key:"collection",value:function(){return new j}},{key:"each",value:function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o=[],p=this.statementsMatching(b,c,d,e,!1);if(null==b)for(g=0,k=p.length;g<k;g++)f=p[g],o.push(f.subject);else if(null==c)for(h=0,l=p.length;h<l;h++)f=p[h],o.push(f.predicate);else if(null==d)for(i=0,m=p.length;i<m;i++)f=p[i],o.push(f.object);else if(null==e)for(j=0,n=p.length;j<n;j++)f=p[j],o.push(f.why);return o}},{key:"equals",value:function(b){return!!b&&this.hashString()===b.hashString()}},{key:"findMembersNT",value:function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;t={},t[b.toNT()]=!0,k={},n=this.transitiveClosure(t,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!0);for(v in n)if(n.hasOwnProperty(v)){for(o=this.statementsMatching(void 0,this.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),this.fromNT(v)),c=0,e=o.length;c<e;c++)u=o[c],k[u.subject.toNT()]=u;for(p=this.each(void 0,this.sym("http://www.w3.org/2000/01/rdf-schema#domain"),this.fromNT(v)),d=0,f=p.length;d<f;d++)for(l=p[d],q=this.statementsMatching(void 0,l),j=0,g=q.length;j<g;j++)u=q[j],k[u.subject.toNT()]=u;for(r=this.each(void 0,this.sym("http://www.w3.org/2000/01/rdf-schema#range"),this.fromNT(v)),m=0,h=r.length;m<h;m++)for(l=r[m],s=this.statementsMatching(void 0,l),w=0,i=s.length;w<i;w++)u=s[w],k[u.object.toNT()]=u}return k}},{key:"findMemberURIs",value:function(b){return this.NTtoURI(this.findMembersNT(b))}},{key:"findSubClassesNT",value:function(b){var c={};return c[b.toNT()]=!0,this.transitiveClosure(c,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!0)}},{key:"findSuperClassesNT",value:function(b){var c={};return c[b.toNT()]=!0,this.transitiveClosure(c,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!1)}},{key:"findTypesNT",value:function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(m="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",s=[],n=this.statementsMatching(b,void 0,void 0),d=0,f=n.length;d<f;d++)if(r=n[d],r.predicate.uri===m)s[r.object.toNT()]=r;else for(o=this.each(r.predicate,this.sym("http://www.w3.org/2000/01/rdf-schema#domain")),e=0,g=o.length;e<g;e++)l=o[e],s[l.toNT()]=r;for(p=this.statementsMatching(void 0,void 0,b),j=0,h=p.length;j<h;j++)for(r=p[j],q=this.each(r.predicate,this.sym("http://www.w3.org/2000/01/rdf-schema#range")),k=0,i=q.length;k<i;k++)c=q[k],s[c.toNT()]=r;return this.transitiveClosure(s,this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!1)}},{key:"findTypeURIs",value:function(b){return this.NTtoURI(this.findTypesNT(b))}},{key:"formula",value:function(){return new b}},{key:"fromNT",value:function(b){var c,d,e,f;switch(b[0]){case"<":return this.sym(b.slice(1,-1));case'"':if(e=void 0,c=void 0,d=b.lastIndexOf('"'),d<b.length-1)if("@"===b[d+1])e=b.slice(d+2);else{if("^^"!==b.slice(d+1,d+3))throw new Error("Can't convert string from NT: "+b);c=this.fromNT(b.slice(d+3))}return b=b.slice(1,d),b=b.replace(/\\"/g,'"'),b=b.replace(/\\n/g,"\n"),b=b.replace(/\\\\/g,"\\"),this.literal(b,e,c);case"_":return f=new h,f.id=parseInt(b.slice(3),10),h.nextId--,f;case"?":return new q(b.slice(1))}throw new Error("Can't convert from NT: "+b)}},{key:"holds",value:function(b,c,d,e){var f=this.anyStatementMatching(b,c,d,e);return null!=f}},{key:"holdsStatement",value:function(b){return this.holds(b.subject,b.predicate,b.object,b.why)}},{key:"list",value:function(b){var c=new j;return b.forEach(function(a){c.append(a)}),c}},{key:"literal",value:function(b,c,d){return new k(""+b,c,d)}},{key:"NTtoURI",value:function(b){var c,d,e={};for(c in b)b.hasOwnProperty(c)&&(d=b[c],"<"===c[0]&&(e[c.slice(1,-1)]=d));return e}},{key:"serialize",value:function(b,c,d){var e,f,g;switch(g=o(this),g.suggestNamespaces(this.namespaces),g.setBase(b),f=d?this.statementsMatching(void 0,void 0,void 0,d):this.statements,null!=c?c:"text/n3"){case"application/rdf+xml":e=g.statementsToXML(f);break;case"text/n3":case"text/turtle":e=g.statementsToN3(f);break;default:throw new Error("serialize: Content-type "+c+" not supported.")}return e}},{key:"substitute",value:function(c){var d=this.statements.map(function(a){a.substitute(c)});return new b(d)}},{key:"sym",value:function(b,c){if(c)throw new Error("This feature (kb.sym with 2 args) is removed. Do not assume prefix mappings.");return new m(b)}},{key:"the",value:function(b,c,d,e){var f=this.any(b,c,d,e);return null==f&&l.error("No value found for the() {"+b+" "+c+" "+d+"}."),f}},{key:"transitiveClosure",value:function(b,c,d){var e,f,g,h,i,j,k={};Object.assign(k,b);for(var l={};;){if(j=function(){for(var a in k)if(k.hasOwnProperty(a))return a}(),null==j)return l;for(i=d?this.each(void 0,c,this.fromNT(j)):this.each(this.fromNT(j),c),f=0,g=i.length;f<g;f++)e=i[f],h=e.toNT(),h in l||h in k||(k[h]=k[j]);l[j]=k[j],delete k[j]}}},{key:"topTypeURIs",value:function(b){var c,d,e,f,g,h,i,j;i=[];for(e in b)if(b.hasOwnProperty(e)){for(j=b[e],g=0,h=this.each(this.sym(e),this.sym("http://www.w3.org/2000/01/rdf-schema#subClassOf")),c=0,f=h.length;c<f;c++)if(d=h[c],"http://www.w3.org/2000/01/rdf-schema#Resource"!==d.uri){g++;break}g||(i[e]=j)}return i["http://www.w3.org/2000/01/rdf-schema#Resource"]&&delete i["http://www.w3.org/2000/01/rdf-schema#Resource"],i["http://www.w3.org/2002/07/owl#Thing"]&&delete i["http://www.w3.org/2002/07/owl#Thing"],i}},{key:"toString",value:function(){return"{"+this.statements.join("\n")+"}"}},{key:"whether",value:function(b,c,d,e){return this.statementsMatching(b,c,d,e,!1).length}}]),b}(n);r.termType="formula",r.prototype.classOrder=i.Formula,r.prototype.isVar=0,r.prototype.ns=a("./namespace"),r.prototype.variable=a("./data-factory").variable,b.exports=r},{"./blank-node":42,"./class-order":43,"./collection":44,"./data-factory":46,"./literal":53,"./log":54,"./named-node":56,"./namespace":57,"./node":58,"./serialize":65,"./statement":68,"./variable":73}],51:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function n(a,b,c,d){var e=a.any(b,c,void 0);return!!e&&(a.equate(e,d),!0)}function o(a,b,c,d){var e=a.any(void 0,c,d);return!!e&&(a.equate(e,b),!0)}function p(a,b,c,d,e){a.typeCallback&&a.typeCallback(a,d,e);var f=a.classActions[d.hashString()],g=!1;if(f)for(var h=0;h<f.length;h++)g=g||f[h](a,b,c,d,e);return g}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./util").ArrayIndexOf,i=a("./formula"),j=a("./util").RDFArrayRemove,k=a("./statement"),l=a("./node"),m="http://www.w3.org/2002/07/owl#",q=function(b){function c(a){e(this,c);var b=f(this,Object.getPrototypeOf(c).call(this));return b.statements=[],b.optional=[],b.propertyActions=[],b.classActions=[],b.redirections=[],b.aliases=[],b.HTTPRedirects=[],b.subjectIndex=[],b.predicateIndex=[],b.objectIndex=[],b.whyIndex=[],b.index=[b.subjectIndex,b.predicateIndex,b.objectIndex,b.whyIndex],b.namespaces={},b.features=a||["sameAs","InverseFunctionalProperty","FunctionalProperty"],b.initPropertyActions(b.features),b}return g(c,b),d(c,[{key:"applyPatch",value:function(c,d,e){var h,f=a("./query"),g=this,i=function(b){if(c.delete){h=c.delete,j&&(h=h.substitute(j)),h=h.statements;var f=[],i=h.map(function(a){var b=g.statementsMatching(a.subject,a.predicate,a.object,d);return 0===b.length?(f.push(a),null):b[0]});if(f.length)return e("Couldn't find to delete: "+f[0]);i.map(function(a){g.remove(a)})}c.insert&&(h=c.insert,j&&(h=h.substitute(j)),h=h.statements,h.map(function(a){a.why=d,g.add(a.subject,a.predicate,a.object,a.why)})),b()},j=null;if(c.where){var k=new f("patch");k.pat=c.where,k.pat.statements.map(function(a){a.why=d});var l=[];g.query(k,function(b){l.push(b)},g.fetcher,function(){return 0===l.length?e("No match found to be patched:"+c.where):l.length>1?e("Patch ambiguous. No patch done."):(j=l[0],void i(e))})}else i(e)}},{key:"declareExistential",value:function(b){return this._existentialVariables||(this._existentialVariables=[]),this._existentialVariables.push(b),b}},{key:"initPropertyActions",value:function(b){this.propertyActions["<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>"]=[p],h(b,"sameAs")>=0&&(this.propertyActions["<http://www.w3.org/2002/07/owl#sameAs>"]=[function(a,b,c,d,e){
return a.equate(b,d),!0}]),h(b,"InverseFunctionalProperty")>=0&&(this.classActions["<"+m+"InverseFunctionalProperty>"]=[function(a,b,c,d,e){return a.newPropertyAction(b,o)}]),h(b,"FunctionalProperty")>=0&&(this.classActions["<"+m+"FunctionalProperty>"]=[function(a,b,c,d,e){return a.newPropertyAction(b,n)}])}},{key:"add",value:function(b,d,e,f){var g;if(1===arguments.length){if(b instanceof Array)for(g=0;g<b.length;g++)this.add(b[g]);else b instanceof k?this.add(b.subject,b.predicate,b.object,b.why):b instanceof c&&this.add(b.statements);return this}var h,i;f||(f=this.fetcher?this.fetcher.appNode:this.sym("chrome:theSession")),b=l.fromValue(b),d=l.fromValue(d),e=l.fromValue(e),f=l.fromValue(f),this.predicateCallback&&this.predicateCallback(this,d,f);var j=this.canon(d).hashString();h=this.propertyActions[j];var m=!1;if(h)for(g=0;g<h.length;g++)m=m||h[g](this,b,d,e,f);var n=[this.canon(b).hashString(),j,this.canon(e).hashString(),this.canon(f).hashString()];for(i=new k(b,d,e,f),g=0;g<4;g++){var o=this.index[g],p=n[g];o[p]||(o[p]=[]),o[p].push(i)}return this.statements.push(i),i}},{key:"addAll",value:function(b){var c=this;b.forEach(function(a){c.add(a.subject,a.predicate,a.object,a.graph)})}},{key:"any",value:function(b,c,d,e){var f=this.anyStatementMatching(b,c,d,e);if(null!=f)return null==b?f.subject:null==c?f.predicate:null==d?f.object:void 0}},{key:"anyStatementMatching",value:function(b,c,d,e){var f=this.statementsMatching(b,c,d,e,!0);if(f&&0!==f.length)return f[0]}},{key:"canon",value:function(b){if(!b)return b;var c=this.redirections[b.hashString()];return c?c:b}},{key:"check",value:function(){this.checkStatementList(this.statements);for(var b=0;b<4;b++){var c=this.index[b];for(var d in c)c.hasOwnProperty(d)&&this.checkStatementList(c[d],b)}}},{key:"checkStatementList",value:function(b,c){for(var f,d=["subject","predicate","object","why"],e=" found in "+d[c]+" index.",g=0;g<b.length;g++){f=b[g];for(var h=[f.subject,f.predicate,f.object,f.why],i=function(b,c){for(var d=0;d<b.length;d++)if(b[d].subject.sameTerm(c.subject)&&b[d].predicate.sameTerm(c.predicate)&&b[d].object.sameTerm(c.object)&&b[d].why.sameTerm(c.why))return!0},j=0;j<4;j++){var k=this.canon(h[j]),l=k.hashString();this.index[j][l]&&!i(this.index[j][l],f)}if(!i(this.statements,f))throw new Error("Statement list does not statement "+f+"@"+f.why+e)}}},{key:"close",value:function(){return this}},{key:"copyTo",value:function(b,c,d){d||(d=[]);var e=this.statementsMatching(b);h(d,"two-direction")!==-1&&e.concat(this.statementsMatching(void 0,void 0,b));for(var f=0;f<e.length;f++){var g=e[f];switch(g.object.termType){case"NamedNode":this.add(c,g.predicate,g.object);break;case"Literal":case"BlankNode":case"collection":this.add(c,g.predicate,g.object.copy(this))}h(d,"delete")!==-1&&this.remove(g)}}},{key:"equate",value:function(b,c){b=this.canon(b),c=this.canon(c);var d=b.compareTerm(c);return!d||(d<0?this.replaceWith(c,b):this.replaceWith(b,c))}},{key:"formula",value:function(b){return new c(b)}},{key:"match",value:function(b,c,d,e){return this.statementsMatching(l.fromValue(b),l.fromValue(c),l.fromValue(d),l.fromValue(e))}},{key:"mentionsURI",value:function(b){var c="<"+b+">";return!!this.subjectIndex[c]||!!this.objectIndex[c]||!!this.predicateIndex[c]}},{key:"newExistential",value:function(b){if(!b)return this.bnode();var c=this.sym(b);return this.declareExistential(c)}},{key:"newPropertyAction",value:function(b,c){var d=b.hashString();this.propertyActions[d]||(this.propertyActions[d]=[]),this.propertyActions[d].push(c);for(var e=this.statementsMatching(void 0,b,void 0),f=!1,g=0;g<e.length;g++)f=f||c(this,e[g].subject,b,e[g].object);return f}},{key:"newUniversal",value:function(b){var c=this.sym(b);return this._universalVariables||(this._universalVariables=[]),this._universalVariables.push(c),c}},{key:"nextSymbol",value:function(b){for(var c=0;;c++){var d=b.uri+"#n"+c;if(!this.mentionsURI(d))return this.sym(d)}}},{key:"query",value:function(c,d,e,f){var g=a("./query").indexedFormulaQuery;return g.call(this,c,d,e,f)}},{key:"remove",value:function(b){if(b instanceof Array){for(var d=0;d<b.length;d++)this.remove(b[d]);return this}if(b instanceof c)return this.remove(b.statements);var e=this.statementsMatching(b.subject,b.predicate,b.object,b.why);if(!e.length)throw new Error("Statement to be removed is not on store: "+b);return this.removeStatement(e[0]),this}},{key:"removeDocument",value:function(b){for(var c=this.statementsMatching(void 0,void 0,void 0,b).slice(),d=0;d<c.length;d++)this.removeStatement(c[d]);return this}},{key:"removeMany",value:function(b,c,d,e,f){for(var g=this.statementsMatching(b,c,d,e,!1),h=[],i=0;i<g.length;i++)h.push(g[i]);for(f&&(h=h.slice(0,f)),i=0;i<h.length;i++)this.remove(h[i])}},{key:"removeMatches",value:function(b,c,d,e){return this.removeStatements(this.statementsMatching(b,c,d,e)),this}},{key:"removeStatement",value:function(b){for(var c=[b.subject,b.predicate,b.object,b.why],d=0;d<4;d++){var e=this.canon(c[d]),f=e.hashString();this.index[d][f]&&j(this.index[d][f],b)}return j(this.statements,b),this}},{key:"removeStatements",value:function(b){for(var c=0;c<b.length;c++)this.remove(b[c]);return this}},{key:"replaceWith",value:function(b,c){for(var d=b.hashString(),e=c.hashString(),f=function(b){var c=b[d];if(c){var f=b[e];f?b[e]=c.concat(f):b[e]=c,delete b[d]}},g=0;g<4;g++)f(this.index[g]);if(this.redirections[d]=c,b.uri){if(this.aliases[e]||(this.aliases[e]=[]),this.aliases[e].push(b),this.aliases[d])for(g=0;g<this.aliases[d].length;g++)this.redirections[this.aliases[d][g].hashString()]=c,this.aliases[e].push(this.aliases[d][g]);this.add(c,this.sym("http://www.w3.org/2007/ont/link#uri"),b.uri),this.fetcher&&this.fetcher.nowKnownAs(b,c)}return f(this.classActions),f(this.propertyActions),!0}},{key:"sameThings",value:function(b,c){if(b.sameTerm(c))return!0;var d=this.canon(b);if(!d)return!1;var e=this.canon(c);return!!e&&d.uri===e.uri}},{key:"setPrefixForURI",value:function(b,c){"tab"===b&&this.namespaces.tab||"ns"!==b.slice(0,2)&&"default"!==b.slice(0,7)&&(this.namespaces[b]=c)}},{key:"statementsMatching",value:function(b,c,d,e,f){var m,n,g=[b,c,d,e],h=[],i=[],j=[],k=[];for(m=0;m<4;m++)h[m]=this.canon(l.fromValue(g[m])),h[m]?(k.push(m),i[m]=h[m].hashString()):j.push(m);if(0===k.length)return this.statements;if(1===k.length)return m=k[0],n=this.index[m][i[m]],n&&f&&n.length>1&&(n=n.slice(0,1)),n=n||[];var p,q,o=1e10;for(q=0;q<k.length;q++){if(m=k[q],n=this.index[m][i[m]],!n)return[];n.length<o&&(o=n.length,p=q)}for(var r=k[p],s=this.index[r][i[r]],t=k.slice(0,p).concat(k.slice(p+1)),u=[],v=["subject","predicate","object","why"],w=0;w<s.length;w++){var x=s[w];for(q=0;q<t.length;q++)if(m=t[q],!this.canon(x[v[m]]).sameTerm(h[m])){x=null;break}if(null!=x&&(u.push(x),f))break}return u}},{key:"uris",value:function(b){var c=this.canon(b),d=this.aliases[c.hashString()];if(!c.uri)return[];var e=[c.uri];if(d)for(var f=0;f<d.length;f++)e.push(d[f].uri);return e}},{key:"length",get:function(){return this.statements.length}}]),c}(i);b.exports=q,b.exports.handleRDFType=p},{"./formula":50,"./node":58,"./query":62,"./statement":68,"./util":72}],52:[function(a,b,c){"use strict";var d=function(){return{parseJSON:function(b,c,d){var e,f,g,h={},i=d.sym(c);for(var j in b){0===j.indexOf("_:")?h[j]?e=h[j]:(e=d.bnode(j),h[j]=e):e=d.sym(j);var k=b[j];for(var l in k){var m=k[l];f=d.sym(l);for(var n in m){var o=m[n];if("uri"===o.type)g=d.sym(o.value),d.add(e,f,g,i);else if("BlankNode"===o.type)h[o.value]?g=h[o.value]:(g=d.bnode(o.value),h[o.value]=g),d.add(e,f,g,i);else{if("Literal"!==o.type)throw new Error("error: unexpected termtype: "+n.type);g=o.datatype?d.literal(o.value,void 0,d.sym(o.datatype)):o.lang?d.literal(o.value,o.lang):d.literal(o.value),d.add(e,f,g,i)}}}}}}}();b.exports=d},{}],53:[function(a,b,c){"use strict";function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("./class-order"),j=a("./named-node"),k=a("./node"),l=a("./xsd"),m=function(a){function b(a,c,d){f(this,b);var e=g(this,Object.getPrototypeOf(b).call(this));return e.termType=b.termType,e.value=a,c&&(e.lang=c,d=l.langString),d&&(e.datatype=j.fromValue(d)),e}return h(b,a),e(b,[{key:"copy",value:function(){return new b(this.value,this.lang,this.datatype)}},{key:"equals",value:function(b){return!!b&&(this.termType===b.termType&&this.value===b.value&&this.language===b.language&&(!this.datatype&&!b.datatype||this.datatype&&this.datatype.equals(b.datatype)))}},{key:"toNT",value:function(){if("number"==typeof this.value)return this.toString();if("string"!=typeof this.value)throw new Error("Value of RDF literal is not string or number: "+this.value);var b=this.value;return b=b.replace(/\\/g,"\\\\"),b=b.replace(/\"/g,'\\"'),b=b.replace(/\n/g,"\\n"),b='"'+b+'"',this.language?b+="@"+this.language:this.datatype.equals(l.string)||(b+="^^"+this.datatype.toCanonical()),b}},{key:"toString",value:function(){return""+this.value}},{key:"language",get:function(){return this.lang},set:function(b){this.lang=b||""}}],[{key:"fromBoolean",value:function(c){var d=c?"1":"0";return new b(d,null,l.boolean)}},{key:"fromDate",value:function(c){if(!(c instanceof Date))throw new TypeError("Invalid argument to Literal.fromDate()");var d=function(b){return(""+(100+b)).slice(1,3)},e=""+c.getUTCFullYear()+"-"+d(c.getUTCMonth()+1)+"-"+d(c.getUTCDate())+"T"+d(c.getUTCHours())+":"+d(c.getUTCMinutes())+":"+d(c.getUTCSeconds())+"Z";return new b(e,null,l.dateTime)}},{key:"fromNumber",value:function(c){if("number"!=typeof c)throw new TypeError("Invalid argument to Literal.fromNumber()");var d=void 0;return d=(""+c).indexOf("e")>=0?l.float:(""+c).indexOf(".")>=0?l.decimal:l.integer,new b(""+c,null,d)}},{key:"fromValue",value:function(c){if("undefined"==typeof c||null===c)return c;if(c&&c.termType)return c;switch("undefined"==typeof c?"undefined":d(c)){case"object":if(c instanceof Date)return b.fromDate(c);case"boolean":return b.fromBoolean(c);case"number":return b.fromNumber(c);case"string":return new b(c)}throw new Error("Can't make literal from "+c+" of type "+("undefined"==typeof c?"undefined":d(c)))}}]),b}(k);m.termType="Literal",m.prototype.classOrder=i.Literal,m.prototype.datatype=l.string,m.prototype.lang="",m.prototype.isVar=0,b.exports=m},{"./class-order":43,"./named-node":56,"./node":58,"./xsd":74}],54:[function(a,b,c){"use strict";b.exports={debug:function(b){},warn:function(b){},info:function(b){},error:function(b){},success:function(b){},msg:function(b){}}},{}],55:[function(a,b,c){"use strict";var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},e=a("./uri"),f=a("./util").ArrayIndexOf,g=function(){function a(a){return encodeURI(a)}function X(a,b,c,d,e,f,g,h){return new Y(a,b,c,d,e,f,g,h)}function Y(a,b,c,d,e,f,g,h){"undefined"==typeof b&&(b=null),"undefined"==typeof c&&(c=""),"undefined"==typeof d&&(d=null),"undefined"==typeof e&&(e=""),"undefined"==typeof f&&(f=null),"undefined"==typeof g&&(g=""),"undefined"==typeof h&&(h=null),this._bindings=new k([]),this._flags=g,""!=c&&(r(c.indexOf(":")>=0,"Document URI not absolute: "+c),this._bindings[""]=c+"#"),this._store=a,e&&a.setGenPrefix(e),this._thisDoc=c,this.source=a.sym(c),this.lines=0,this.statementCount=0,this.startOfLine=0,this.previousLine=0,this._genPrefix=e,this.keywords=new j(["a","this","bind","has","is","of","true","false"]),this.keywordsSet=0,this._anonymousNodes=new k([]),this._variables=new k([]),this._parentVariables=new k([]),this._reason=h,this._reason2=null,v&&(this._reason2=why_BecauseOfData(a.sym(c),this._reason)),d?this._baseURI=d:c?this._baseURI=c:this._baseURI=null,r(!this._baseURI||this._baseURI.indexOf(":")>=0),this._genPrefix||(this._thisDoc?this._genPrefix=this._thisDoc+"#_g":this._genPrefix=RDFSink_uniqueURI()),null==b?this._thisDoc?this._formula=a.formula(c+"#_formula"):this._formula=a.formula():this._formula=b,this._context=this._formula,this._parentContext=null}function $(a,b,c,d,e){this._str=c.encode("utf-8"),this._str=c,this._i=d,this._why=e,this.lines=b,this._uri=a}function _(a,b,c,d,e){return"Line "+(b+1)+" of <"+a+">: Bad syntax: "+e+'\nat: "'+m(c,d,d+30)+'"'}var b={encode:function(b){b=b.replace(/\r\n/g,"\n");for(var c="",d=0;d<b.length;d++){var e=b.charCodeAt(d);e<128?c+=String.fromCharCode(e):e>127&&e<2048?(c+=String.fromCharCode(e>>6|192),c+=String.fromCharCode(63&e|128)):(c+=String.fromCharCode(e>>12|224),c+=String.fromCharCode(e>>6&63|128),c+=String.fromCharCode(63&e|128))}return c},decode:function(b){for(var c="",d=0;d<b.length;){var e=b.charCodeAt(d);e<128?(c+=String.fromCharCode(e),d++):e>191&&e<224?(c+=String.fromCharCode((31&e)<<6|63&b.charCodeAt(d+1)),d+=2):(c+=String.fromCharCode((15&e)<<12|(63&b.charCodeAt(d+1))<<6|63&b.charCodeAt(d+2)),d+=3)}return c}},h="http://www.w3.org/2000/10/swap/log#",i=function(b){return b},j=function(b){return b},k=function(b){if(b.length>0)throw"missing.js: oops nnonempty dict not imp";return[]},l=function(b){return b.length},m=function(b,c,e){if("undefined"==typeof b.slice)throw"@@ mising.js: No .slice function for "+b+" of type "+("undefined"==typeof b?"undefined":d(b));return"undefined"==typeof e||null==e?b.slice(c):b.slice(c,e)},n=Error("dummy error stop iteration"),o=function(b){return this.last=0,this.li=b,this.next=function(){if(this.last==this.li.length)throw n;return this.li[this.last++]},this},q=function(b,c){return b.indexOf(c)},r=function(b,c){if(!b){if(c)throw"python Assertion failed: "+c;throw"(python) Assertion failed."}},s=function(b){return String.fromCharCode(b)};String.prototype.encode=function(a){if("utf-8"!=a)throw"UTF8_converter: can only do utf-8";return b.encode(this)},String.prototype.decode=function(a){if("utf-8"!=a)throw"UTF8_converter: can only do utf-8";return this};var t=function(b,c){return e.join(c,b)},u=null,v=0,w=0,x=function(b){},y="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",z="http://www.w3.org/2002/07/owl#sameAs",B="#",D="http://www.w3.org/2001/XMLSchema#integer",E="http://www.w3.org/2001/XMLSchema#double",F="http://www.w3.org/2001/XMLSchema#decimal",G="http://www.w3.org/2001/XMLSchema#date",H="http://www.w3.org/2001/XMLSchema#dateTime",K="\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~",L=K+":",S=(new RegExp("^[ \\t]*(#[^\\n]*)?\\r?\\n","g"),new RegExp("^[ \\t]*(#[^\\n]*)?$","g"),new RegExp("^[ \\t]*","g"),new RegExp("^[-+]?[0-9]+","g"),new RegExp("^([-+]?[0-9]+)(\\.[0-9]+)?(e[-+]?[0-9]+)?","g")),T=new RegExp("^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9](T[0-9][0-9]:[0-9][0-9](:[0-9][0-9](\\.[0-9]*)?)?)?Z?"),V=(new RegExp("^[0-9]+","g"),new RegExp('[\\\\\\r\\n\\"]',"g")),W=new RegExp("^[a-zA-Z0-9]+(-[a-zA-Z0-9]+)?","g");return Y.prototype.here=function(a){return this._genPrefix+"_L"+this.lines+"C"+(a-this.startOfLine+1)},Y.prototype.formula=function(){return this._formula},Y.prototype.loadStream=function(a){return this.loadBuf(a.read())},Y.prototype.loadBuf=function(a){return this.startDoc(),this.feed(a),this.endDoc()},Y.prototype.feed=function(a){for(var b=a.decode("utf-8"),c=0;c>=0;){var d=this.skipSpace(b,c);if(d<0)return;var c=this.directiveOrStatement(b,d);if(c<0)throw _(this._thisDoc,this.lines,b,d,"expected directive or statement")}},Y.prototype.directiveOrStatement=function(a,b){var c=this.skipSpace(a,b);if(c<0)return c;var d=this.directive(a,c);if(d>=0)return this.checkDot(a,d);var d=this.statement(a,c);return d>=0?this.checkDot(a,d):d},Y.prototype.tok=function(a,b,c){if("@"==m(b,c,c+1))var c=c+1;else if(f(this.keywords,a)<0)return-1;var e=c+l(a);return m(b,c,e)==a&&K.indexOf(b.charAt(e))>=0?e:-1},Y.prototype.directive=function(b,c){var d=this.skipSpace(b,c);if(d<0)return d;var e=new j([]),d=this.tok("bind",b,c);if(d>0)throw _(this._thisDoc,this.lines,b,c,"keyword bind is obsolete: use @prefix");var d=this.tok("keywords",b,c);if(d>0){var c=this.commaSeparatedList(b,d,e,!1);if(c<0)throw _(this._thisDoc,this.lines,b,c,"'@keywords' needs comma separated list of words");return this.setKeywords(m(e,null,null)),w>80&&x("Keywords ",this.keywords),c}var d=this.tok("forAll",b,c);if(d>0){var c=this.commaSeparatedList(b,d,e,!0);if(c<0)throw _(this._thisDoc,this.lines,b,c,"Bad variable list after @forAll");var g=new o(e);try{for(;;){var h=g.next();(f(this._variables,h)<0||f(this._parentVariables,h)>=0)&&(this._variables[h]=this._context.newUniversal(h))}}catch(a){if(a!=n)throw a}return c}var d=this.tok("forSome",b,c);if(d>0){var c=this.commaSeparatedList(b,d,e,this.uri_ref2);if(c<0)throw _(this._thisDoc,this.lines,b,c,"Bad variable list after @forSome");var g=new o(e);try{for(;;){var h=g.next();this._context.declareExistential(h)}}catch(a){if(a!=n)throw a}return c}var d=this.tok("prefix",b,c);if(d>=0){var i=new j([]),c=this.qname(b,d,i);if(c<0)throw _(this._thisDoc,this.lines,b,d,"expected qname after @prefix");var d=this.uri_ref2(b,c,i);if(d<0)throw _(this._thisDoc,this.lines,b,c,"expected <uriref> after @prefix _qname_");var k=i[1].uri;if(this._baseURI)var k=t(this._baseURI,k);else r(k.indexOf(":")>=0,"With no base URI, cannot handle relative URI for NS");return r(k.indexOf(":")>=0),this._bindings[i[0][0]]=k,this.bind(i[0][0],a(k)),d}var d=this.tok("base",b,c);if(d>=0){var i=new j([]),c=this.uri_ref2(b,d,i);if(c<0)throw _(this._thisDoc,this.lines,b,d,"expected <uri> after @base ");var k=i[0].uri;if(!this._baseURI)throw _(this._thisDoc,this.lines,b,d,"With no previous base URI, cannot use relative URI in @base  <"+k+">");var k=t(this._baseURI,k);return r(k.indexOf(":")>=0),this._baseURI=k,c}return-1},Y.prototype.bind=function(a,b){""==a||this._store.setPrefixForURI(a,b)},Y.prototype.setKeywords=function(a){null==a?this.keywordsSet=0:(this.keywords=a,this.keywordsSet=1)},Y.prototype.startDoc=function(){},Y.prototype.endDoc=function(){return this._formula},Y.prototype.makeStatement=function(a){a[0].add(a[2],a[1],a[3],this.source),this.statementCount+=1},Y.prototype.statement=function(a,b){var c=new j([]),b=this.object(a,b,c);if(b<0)return b;var d=this.property_list(a,b,c[0]);if(d<0)throw _(this._thisDoc,this.lines,a,b,"expected propertylist");return d},Y.prototype.subject=function(a,b,c){return this.item(a,b,c)},Y.prototype.verb=function(a,b,c){var d=this.skipSpace(a,b);if(d<0)return d;var e=new j([]),d=this.tok("has",a,b);if(d>=0){var b=this.prop(a,d,e);if(b<0)throw _(this._thisDoc,this.lines,a,d,"expected property after 'has'");return c.push(new i(["->",e[0]])),b}var d=this.tok("is",a,b);if(d>=0){var b=this.prop(a,d,e);if(b<0)throw _(this._thisDoc,this.lines,a,d,"expected <property> after 'is'");var d=this.skipSpace(a,b);if(d<0)throw _(this._thisDoc,this.lines,a,b,"End of file found, expected property after 'is'");var b=d,d=this.tok("of",a,b);if(d<0)throw _(this._thisDoc,this.lines,a,b,"expected 'of' after 'is' <prop>");return c.push(new i(["<-",e[0]])),d}var d=this.tok("a",a,b);if(d>=0)return c.push(new i(["->",this._store.sym(y)])),d;if("<="==m(a,b,b+2))return c.push(new i(["<-",this._store.sym(h+"implies")])),b+2;if("="==m(a,b,b+1))return">"==m(a,b+1,b+2)?(c.push(new i(["->",this._store.sym(h+"implies")])),b+2):(c.push(new i(["->",this._store.sym(z)])),b+1);if(":="==m(a,b,b+2))return c.push(new i(["->",h+"becomes"])),b+2;var d=this.prop(a,b,e);if(d>=0)return c.push(new i(["->",e[0]])),d;if(">-"==m(a,b,b+2)||"<-"==m(a,b,b+2))throw _(this._thisDoc,this.lines,a,d,">- ... -> syntax is obsolete.");return-1},Y.prototype.prop=function(a,b,c){return this.item(a,b,c)},Y.prototype.item=function(a,b,c){return this.path(a,b,c)},Y.prototype.blankNode=function(a){return this._context.bnode(a,this._reason2)},Y.prototype.path=function(a,b,c){var d=this.nodeOrLiteral(a,b,c);if(d<0)return d;for(;"!^.".indexOf(m(a,d,d+1))>=0;){var e=m(a,d,d+1);if("."==e){var f=m(a,d+1,d+2);if(!f||L.indexOf(f)>=0&&":?<[{(".indexOf(f)<0)break}var g=c.pop(),h=this.blankNode(this.here(d)),d=this.node(a,d+1,c);if(d<0)throw _(this._thisDoc,this.lines,a,d,"EOF found in middle of path syntax");var j=c.pop();"^"==e?this.makeStatement(new i([this._context,j,h,g])):this.makeStatement(new i([this._context,j,g,h])),c.push(h)}return d},Y.prototype.anonymousNode=function(a){var b=this._anonymousNodes[a];if(b)return b;var b=this._store.bnode(this._context,this._reason2);return this._anonymousNodes[a]=b,b},Y.prototype.node=function(a,b,c,d){"undefined"==typeof d&&(d=null);var e=d,f=this.skipSpace(a,b);if(f<0)return f;var b=f,g=m(a,b,b+1);if("["==g){var h=this.here(b),f=this.skipSpace(a,b+1);if(f<0)throw _(this._thisDoc,this.lines,a,b,"EOF after '['");if("="==m(a,f,f+1)){var b=f+1,p=new j([]),f=this.objectList(a,b,p);if(!(f>=0))throw _(this._thisDoc,this.lines,a,b,"objectList expected after [= ");var e=p[0];if(l(p)>1){var q=new o(p);try{for(;;){var r=q.next();this.makeStatement(new i([this._context,this._store.sym(z),e,r]))}}catch(a){if(a!=n)throw a}}var f=this.skipSpace(a,f);if(f<0)throw _(this._thisDoc,this.lines,a,b,"EOF when objectList expected after [ = ");if(";"==m(a,f,f+1))var f=f+1}if(null==e)var e=this.blankNode(h);var b=this.property_list(a,f,e);if(b<0)throw _(this._thisDoc,this.lines,a,f,"property_list expected");var f=this.skipSpace(a,b);if(f<0)throw _(this._thisDoc,this.lines,a,b,"EOF when ']' expected after [ <propertyList>");if("]"!=m(a,f,f+1))throw _(this._thisDoc,this.lines,a,f,"']' expected");return c.push(e),f+1}if("{"==g){var s=m(a,b+1,b+2);if("$"==s){b+=1;for(var f=b+1,t=new j([]),v=!0;;){var b=this.skipSpace(a,f);if(b<0)throw _(this._thisDoc,this.lines,a,b,"needed '$}', found end.");if("$}"==m(a,b,b+2)){var f=b+2;break}if(v)var v=!1;else{if(","!=m(a,b,b+1))throw _(this._thisDoc,this.lines,a,b,"expected: ','");b+=1}var w=new j([]),f=this.item(a,b,w);if(f<0)throw _(this._thisDoc,this.lines,a,b,"expected item in set or '$}'");t.push(w[0])}return c.push(this._store.newSet(t,this._context)),f}var f=b+1,x=this._parentContext;this._parentContext=this._context;var y=this._anonymousNodes,A=this._parentVariables;this._parentVariables=this._variables,this._anonymousNodes=new k([]),this._variables=this._variables.slice();var B=this._reason2;if(this._reason2=u,null==e)var e=this._store.formula();for(this._context=e;;){var b=this.skipSpace(a,f);if(b<0)throw _(this._thisDoc,this.lines,a,b,"needed '}', found end.");if("}"==m(a,b,b+1)){var f=b+1;break}var f=this.directiveOrStatement(a,b);if(f<0)throw _(this._thisDoc,this.lines,a,b,"expected statement or '}'")}return this._anonymousNodes=y,this._variables=this._parentVariables,this._parentVariables=A,this._context=this._parentContext,this._reason2=B,this._parentContext=x,c.push(e.close()),f}if("("==g){var C=this._store.list,s=m(a,b+1,b+2);if("$"==s){var C=this._store.newSet;b+=1}for(var f=b+1,t=new j([]);;){var b=this.skipSpace(a,f);if(b<0)throw _(this._thisDoc,this.lines,a,b,"needed ')', found end.");if(")"==m(a,b,b+1)){var f=b+1;break}var w=new j([]),f=this.item(a,b,w);if(f<0)throw _(this._thisDoc,this.lines,a,b,"expected item in list or ')'");t.push(w[0])}return c.push(C(t,this._context)),f}var f=this.tok("this",a,b);if(f>=0)throw _(this._thisDoc,this.lines,a,b,"Keyword 'this' was ancient N3. Now use @forSome and @forAll keywords.");var f=this.tok("true",a,b);if(f>=0)return c.push(!0),f;var f=this.tok("false",a,b);if(f>=0)return c.push(!1),f;if(null==e){var f=this.uri_ref2(a,b,c);if(f>=0)return f}return-1},Y.prototype.property_list=function(a,b,c){for(;;){var d=this.skipSpace(a,b);if(d<0)throw _(this._thisDoc,this.lines,a,b,"EOF found when expected verb in property list");if(":-"!=m(a,d,d+2)){var b=d,f=new j([]),d=this.verb(a,b,f);if(d<=0)return b;var g=new j([]),b=this.objectList(a,d,g);if(b<0)throw _(this._thisDoc,this.lines,a,d,"objectList expected");var h=new o(g);try{for(;;){var k=h.next(),l=f[0],p=l[0],q=l[1];"->"==p?this.makeStatement(new i([this._context,q,c,k])):this.makeStatement(new i([this._context,q,k,c]))}}catch(a){if(a!=n)throw a}var d=this.skipSpace(a,b);if(d<0)throw _(this._thisDoc,this.lines,a,d,"EOF found in list of objects");if(";"!=m(a,b,b+1))return b;var b=b+1}else{var b=d+2,e=new j([]),d=this.node(a,b,e,c);if(d<0)throw _(this._thisDoc,this.lines,a,b,"bad {} or () or [] node after :- ");var b=d}}},Y.prototype.commaSeparatedList=function(a,b,c,d){var e=this.skipSpace(a,b);if(e<0)throw _(this._thisDoc,this.lines,a,e,"EOF found expecting comma sep list");if("."==a.charAt(e))return b;if(d)var e=this.uri_ref2(a,e,c);else var e=this.bareWord(a,e,c);if(e<0)return-1;for(;;){var b=this.skipSpace(a,e);if(b<0)return b;var f=m(a,b,b+1);if(","!=f)return"."!=f?-1:b;if(d)var e=this.uri_ref2(a,b+1,c);else var e=this.bareWord(a,b+1,c);if(e<0)throw _(this._thisDoc,this.lines,a,e,"bad list content")}},Y.prototype.objectList=function(a,b,c){var b=this.object(a,b,c);if(b<0)return-1;for(;;){var d=this.skipSpace(a,b);if(d<0)throw _(this._thisDoc,this.lines,a,d,"EOF found after object");if(","!=m(a,d,d+1))return d;var b=this.object(a,d+1,c);if(b<0)return b}},Y.prototype.checkDot=function(a,b){var c=this.skipSpace(a,b);if(c<0)return c;if("."==m(a,c,c+1))return c+1;if("}"==m(a,c,c+1))return c;if("]"==m(a,c,c+1))return c;throw _(this._thisDoc,this.lines,a,c,"expected '.' or '}' or ']' at end of statement")},Y.prototype.uri_ref2=function(a,b,c){var d=new j([]),e=this.qname(a,b,d);if(e>=0){var g=d[0],h=g[0],i=g[1];if(null==h){r(0,"not used?");var k=this._baseURI+B}else{var k=this._bindings[h];if(!k){if("_"==h)return c.push(this.anonymousNode(i)),e;throw _(this._thisDoc,this.lines,a,b,"Prefix "+h+" not bound.")}}var n=this._store.sym(k+i);return f(this._variables,n)>=0?c.push(this._variables[n]):c.push(n),e}var b=this.skipSpace(a,b);if(b<0)return-1;if("?"==a.charAt(b)){var o=new j([]),e=this.variable(a,b,o);return e>0?(c.push(o[0]),e):-1}if("<"==a.charAt(b)){for(var b=b+1,p=b;b<l(a);){if(">"==a.charAt(b)){var q=m(a,p,b);if(this._baseURI)var q=t(this._baseURI,q);else r(q.indexOf(":")>=0,"With no base URI, cannot deal with relative URIs");if("#"==m(a,b-1,b)&&"#"!=m(q,-1,null))var q=q+"#";var n=this._store.sym(q);return f(this._variables,n)>=0?c.push(this._variables[n]):c.push(n),b+1}var b=b+1}throw _(this._thisDoc,this.lines,a,e,"unterminated URI reference")}if(this.keywordsSet){var o=new j([]),e=this.bareWord(a,b,o);if(e<0)return-1;if(f(this.keywords,o[0])>=0)throw _(this._thisDoc,this.lines,a,b,'Keyword "'+o[0]+'" not allowed here.');return c.push(this._store.sym(this._bindings[""]+o[0])),e}return-1},Y.prototype.skipSpace=function(a,b){for(var c=" \n\r\t\f\v            ​\u2028\u2029　",d=b?b:0;d<a.length;d++){var e=a.charAt(d);if(c.indexOf(e)<0){if("#"!==a.charAt(d))return d;for(;;d++){if(d===a.length)return-1;if("\n"===a.charAt(d)){this.lines=this.lines+1;break}}}else"\n"===a.charAt(d)&&(this.lines=this.lines+1)}return-1},Y.prototype.variable=function(a,b,c){var d=this.skipSpace(a,b);if(d<0)return-1;if("?"!=m(a,d,d+1))return-1;var d=d+1,b=d;if("0123456789-".indexOf(a.charAt(d))>=0)throw _(this._thisDoc,this.lines,a,d,"Varible name can't start with '"+a.charAt(d)+"s'");for(;b<l(a)&&L.indexOf(a.charAt(b))<0;)var b=b+1;if(null==this._parentContext)throw _(this._thisDoc,this.lines,a,d,"Can't use ?xxx syntax for variable in outermost level: "+m(a,d-1,b));return c.push(this._store.variable(m(a,d,b))),b},Y.prototype.bareWord=function(a,b,c){var d=this.skipSpace(a,b);if(d<0)return-1;var e=a.charAt(d);if("0123456789-".indexOf(e)>=0)return-1;if(L.indexOf(e)>=0)return-1;for(var b=d;b<l(a)&&L.indexOf(a.charAt(b))<0;)var b=b+1;return c.push(m(a,d,b)),b},Y.prototype.qname=function(a,b,c){var b=this.skipSpace(a,b);if(b<0)return-1;var d=a.charAt(b);if("0123456789-+".indexOf(d)>=0)return-1;if(L.indexOf(d)<0)for(var e=d,b=b+1;b<l(a);){var d=a.charAt(b);if(!(L.indexOf(d)<0))break;var e=e+d,b=b+1}else var e="";if(b<l(a)&&":"==a.charAt(b)){for(var g=e,b=b+1,e="";b<l(a);){var d=a.charAt(b);if(!(L.indexOf(d)<0))break;var e=e+d,b=b+1}return c.push(new i([g,e])),b}return e&&this.keywordsSet&&f(this.keywords,e)<0?(c.push(new i(["",e])),b):-1},Y.prototype.object=function(a,b,c){var d=this.subject(a,b,c);if(d>=0)return d;var d=this.skipSpace(a,b);if(d<0)return-1;var b=d;if('"'==a.charAt(b)){if('"""'==m(a,b,b+3))var e='"""';else var e='"';var b=b+l(e),f=this.strconst(a,b,e),d=f[0],g=f[1];return c.push(this._store.literal(g)),x("New string const ",g,d),d}return-1},Y.prototype.nodeOrLiteral=function(a,b,c){var d=this.node(a,b,c);if(d>=0)return d;var d=this.skipSpace(a,b);if(d<0)return-1;var b=d,e=a.charAt(b);if("-+0987654321".indexOf(e)>=0){T.lastIndex=0;var f=T.exec(a.slice(b));if(null!=f){var g=f[0];d=b+g.length,g.indexOf("T")>=0?c.push(this._store.literal(g,void 0,this._store.sym(H))):c.push(this._store.literal(g,void 0,this._store.sym(G)))}else{S.lastIndex=0;var f=S.exec(a.slice(b));if(null==f)throw _(this._thisDoc,this.lines,a,b,"Bad number or date syntax");d=b+S.lastIndex;var g=m(a,b,d);g.indexOf("e")>=0?c.push(this._store.literal(parseFloat(g),void 0,this._store.sym(E))):m(a,b,d).indexOf(".")>=0?c.push(this._store.literal(parseFloat(g),void 0,this._store.sym(F))):c.push(this._store.literal(parseInt(g),void 0,this._store.sym(D)))}return d}if('"'==a.charAt(b)){if('"""'==m(a,b,b+3))var h='"""';else var h='"';var b=b+l(h),i=null,k=this.strconst(a,b,h),d=k[0],n=k[1],o=null;if("@"==m(a,d,d+1)){W.lastIndex=0;var f=W.exec(a.slice(d+1));if(null==f)throw _(this._thisDoc,startline,a,b,"Bad language code syntax on string literal, after @");var b=W.lastIndex+d+1,o=m(a,d+1,b),d=b}if("^^"==m(a,d,d+2))var p=new j([]),d=this.uri_ref2(a,d+2,p),i=p[0];return c.push(this._store.literal(n,o,i)),d}return-1},Y.prototype.strconst=function(a,b,c){for(var d=b,e="",f=this.lines;d<l(a);){var b=d+l(c);if(m(a,d,b)==c)return new i([b,e]);if('"'!=a.charAt(d)){V.lastIndex=0;var g=V.exec(a.slice(d));if(!g)throw _(this._thisDoc,f,a,d,"Closing quote missing in string at ^ in "+m(a,d-20,d)+"^"+m(a,d,d+20));var b=d+V.lastIndex-1,e=e+m(a,d,b),h=a.charAt(b);if('"'!=h)if("\r"!=h){if("\n"==h){if('"'==c)throw _(this._thisDoc,f,a,b,"newline found in string literal");this.lines=this.lines+1;var e=e+h,d=b+1;this.previousLine=this.startOfLine,this.startOfLine=d}else if("\\"==h){var d=b+1,h=m(a,d,d+1);if(!h)throw _(this._thisDoc,f,a,b,"unterminated string literal (2)");var j=q('abfrtvn\\"',h);if(j>=0)var k='a\b\f\r\t\v\n\\"'.charAt(j),e=e+k,d=d+1;else if("u"==h)var n=this.uEscape(a,d+1,f),d=n[0],h=n[1],e=e+h;else{if("U"!=h)throw _(this._thisDoc,this.lines,a,b,"bad escape");var n=this.UEscape(a,d+1,f),d=n[0],h=n[1],e=e+h}}}else var d=b+1;else var d=b}else var e=e+'"',d=d+1}throw _(this._thisDoc,this.lines,a,b,"unterminated string literal")},Y.prototype.uEscape=function(a,b,c){for(var d=b,e=0,f=0;e<4;){var g=m(a,d,d+1),h=g.toLowerCase(),d=d+1;if(""==h)throw _(this._thisDoc,c,a,b,"unterminated string literal(3)");var j=q("0123456789abcdef",h);if(j<0)throw _(this._thisDoc,c,a,b,"bad string literal hex escape");var f=16*f+j,e=e+1}var k=String.fromCharCode(f);return new i([d,k])},Y.prototype.UEscape=function(a,b,c){for(var d=b,e=0,f="\\U";e<8;){var g=m(a,d,d+1),h=g.toLowerCase(),d=d+1;if(""==h)throw _(this._thisDoc,c,a,b,"unterminated string literal(3)");var j=q("0123456789abcdef",h);if(j<0)throw _(this._thisDoc,c,a,b,"bad string literal hex escape");
var f=f+h,e=e+1}var k=s("0x"+m(f,2,10)-0);return new i([d,k])},$.prototype.toString=function(){var a=this._str,b=this._i,c=0;if(b>60)var d="...",c=b-60;else var d="";if(l(a)-b>60)var e="...";else var e="";return'Line %i of <%s>: Bad syntax (%s) at ^ in:\n"%s%s^%s%s"'%new i([this.lines+1,this._uri,this._why,d,m(a,c,b),m(a,b,b+60),e])},X}();b.exports=g},{"./uri":71,"./util":72}],56:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./class-order"),i=a("./node"),j=function(a){function b(a){e(this,b);var c=f(this,Object.getPrototypeOf(b).call(this));return c.termType=b.termType,c.value=a,c}return g(b,a),d(b,[{key:"dir",value:function(){var c=this.uri.split("#")[0],d=c.slice(0,-1).lastIndexOf("/"),e=c.indexOf("//");return e>=0&&d<e+2||d<0?null:new b(c.slice(0,d+1))}},{key:"doc",value:function(){return this.uri.indexOf("#")<0?this:new b(this.uri.split("#")[0])}},{key:"toString",value:function(){return"<"+this.uri+">"}},{key:"uri",get:function(){return this.value},set:function(b){this.value=b}}],[{key:"fromValue",value:function(c){if("undefined"==typeof c||null===c)return c;var d=c&&c.termType;return d?c:new b(c)}}]),b}(i);j.termType="NamedNode",j.prototype.classOrder=h.NamedNode,j.prototype.isVar=0,b.exports=j},{"./class-order":43,"./node":58}],57:[function(a,b,c){"use strict";function e(a){return function(b){return new d(a+(b||""))}}var d=a("./named-node");b.exports=e},{"./named-node":56}],58:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){e(this,a)}return d(a,[{key:"substitute",value:function(b){return this}},{key:"compareTerm",value:function(b){return this.classOrder<b.classOrder?-1:this.classOrder>b.classOrder?1:this.value<b.value?-1:this.value>b.value?1:0}},{key:"equals",value:function(b){return!!b&&(this.termType===b.termType&&this.value===b.value)}},{key:"hashString",value:function(){return this.toCanonical()}},{key:"sameTerm",value:function(b){return this.equals(b)}},{key:"toCanonical",value:function(){return this.toNT()}},{key:"toNT",value:function(){return this.toString()}},{key:"toString",value:function(){throw new Error("Node.toString() is abstract - see the subclasses instead")}}]),a}();b.exports=f,f.fromValue=function(c){var d=a("./collection"),e=a("./literal");a("./named-node");if("undefined"==typeof c||null===c)return c;var g=c&&c.termType;return g?c:Array.isArray(c)?new d(c):e.fromValue(c)}},{"./collection":44,"./literal":53,"./named-node":56}],59:[function(a,b,c){"use strict";function n(a,b,c,n,o){function u(){o&&o(null,b)}function v(a){if("application/ld+json"!==n||"application/nquads"!==n||"application/n-quads"!==n){if(!o)throw new Error("Error trying to parse <"+c+"> as "+n+":\n"+a+":\n"+a.stack);o(a,b)}}function w(a,c){a&&o(a,b);try{r.parse(c,x)}catch(a){o(a,b)}}function x(a,c,d){if(a&&o(a,b),c)s.push(c);else{for(var e=0;e<s.length;e++)y(b,s[e]);o(null,b)}}function y(a,b){var c=z(b.subject),d=z(b.predicate),e=z(b.object),f=null;b.graph&&(f=z(b.graph)),a.add(c,d,e,f)}function z(a){var b;if(g.Util.isLiteral(a)){b=g.Util.getLiteralValue(a);var c=g.Util.getLiteralLanguage(a),e=new i(g.Util.getLiteralType(a));return new f(b,c,e)}return g.Util.isIRI(a)?new i(a):g.Util.isBlank(a)?(b=a.substring(2,a.length),new d(b)):null}try{if("text/n3"===n||"text/turtle"===n){var p=h(b,b,c,c,null,null,"",null);p.loadBuf(a),u()}else if("application/rdf+xml"===n){var q=new k(b);q.parse(m.parseXML(a),c,b.sym(c)),u()}else if("application/xhtml+xml"===n)j(m.parseXML(a,{contentType:"application/xhtml+xml"}),b,c),u();else if("text/html"===n)j(m.parseXML(a,{contentType:"text/html"}),b,c),u();else if("application/sparql-update"===n)l(a,b,c),u();else{if("application/ld+json"!==n&&"application/nquads"!==n&&"application/n-quads"!==n)throw new Error("Don't know how to parse "+n+" yet");var r=g.Parser(),s=[];if("application/ld+json"===n){var t;try{t=JSON.parse(a)}catch(a){o(a,null)}e.toRDF(t,{format:"application/nquads"},w)}else w(null,a)}}catch(a){v(a)}}b.exports=n;var d=a("./blank-node"),e=a("jsonld"),f=a("./literal"),g=a("n3"),h=a("./n3parser"),i=a("./named-node"),j=a("./rdfaparser").parseRDFaDOM,k=a("./rdfxmlparser"),l=a("./patch-parser"),m=a("./util")},{"./blank-node":42,"./literal":53,"./n3parser":55,"./named-node":56,"./patch-parser":60,"./rdfaparser":63,"./rdfxmlparser":64,"./util":72,jsonld:13,n3:14}],60:[function(a,b,c){"use strict";function f(a,b,c){var f,g,h,i=["INSERT","DELETE","WHERE"],j=e("http://www.w3.org/ns/pim/patch#"),k=d(b,b,c,c,null,null,"",null),l={},m=function(b,c,d,e,f){return"Line "+(c+1)+" of <"+b+">: Bad syntax:\n   "+f+'\n   at: "'+d.slice(e,e+30)+'"'};f=0;var n=b.sym(c+"#query");for(l.query=n;;){if(g=k.skipSpace(a,f),g<0)return l;if(";"===a[g]){if(f=k.skipSpace(a,g+1),f<0)return l;g=f}var o=!1;for(h=0;h<i.length;h++){var p=i[h];if(a.slice(g,g+p.length)===p){if(f=k.skipSpace(a,g+p.length),f<0)throw m(k._thisDoc,k.lines,a,g+p.length,"found EOF, needed {...} after "+p);if(("INSERT"===p||"DELETE"===p)&&"DATA"===a.slice(f,f+4)){if(g=k.skipSpace(a,f+4),g<0)throw m(k._thisDoc,k.lines,a,f+4,"needed {...} after INSERT DATA "+p);f=g}var q=[];if(g=k.node(a,f,q),g<0)throw m(k._thisDoc,k.lines,a,f,"bad syntax or EOF in {...} after "+p);l[p.toLowerCase()]=q[0],b.add(n,j(p.toLowerCase()),q[0]),o=!0,f=g}}if(!o&&"@prefix"===a.slice(g,g+7)){if(f=k.directive(a,g),f<0)throw m(k._thisDoc,k.lines,a,f,"bad syntax or EOF after @prefix ");f=k.checkDot(a,f),o=!0}if(!o)throw m(k._thisDoc,k.lines,a,g,"Unknown syntax at start of statememt: '"+a.slice(g).slice(0,20)+"'")}}b.exports=f;var d=a("./n3parser"),e=a("./namespace")},{"./n3parser":55,"./namespace":57}],61:[function(a,b,c){"use strict";function e(a){function c(a){for(var b=i()+"SELECT ",c=0;c<a.vars.length;c++)b+=a.vars[c]+" ";return b+="\n"}function e(a){var b="",c=a.statements;for(var e in c)d.debug("Found statement: "+c),b+=i()+c[e]+"\n";return b}function f(a){var b="";for(var c in a.constraints){var d=a.constraints[c];b+=i()+"FILTER ( "+d.describe(c)+" ) \n"}return b}function g(a){for(var c="",h=0;h<a.optional.length;h++)d.debug("Found optional query"),c+=i()+"OPTIONAL { \n",b++,c+=e(a.optional[h]),c+=f(a.optional[h]),c+=g(a.optional[h]),b--,c+=i()+"}\n";return c}function h(a){var c=i()+"WHERE \n{ \n";return b++,c+=e(a),c+=f(a),c+=g(a),b--,c+="}"}function i(){for(var a="",c=0;c<b;c++)a+="    ";return a}function j(a){return c(a)+h(a.pat)}var b=0;return j(a)}var d=a("./log");b.exports=e},{"./log":54}],62:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b,c,d){function q(a,b){return a.nvars!==b.nvars?a.nvars-b.nvars:a.index.length-b.index.length}var e=function(b){var d,c="";for(d in b)b.hasOwnProperty(d)&&(c+="    "+d+" -> "+b[d]);return c},h=function(b){var d,c="Bindings: ",f=b.length;for(d=0;d<f;d++)c+=e(b[d][0])+";\n\t";return c},i=function(b,c,d,e){var f=d[b];if(void 0===f){if(b.isVar){var g=[];return g[b]=c,[[g,null]]}f=b}if(!f.complexType)return e.redirections[f]&&(f=e.redirections[f]),e.redirections[c]&&(c=e.redirections[c]),f.sameTerm(c)?[[[],null]]:[];if(b instanceof Array)return c instanceof Array?j(b,c,d):[];throw new Error("query.js: oops - code not written yet")},j=function a(b,c,d,e){var f;if(b.length!==c.length)return[];if(!b.length)return[[[],null]];var g=i(b[0],c[0],d,e);if(0===g.length)return g;var j,l,m,n,o,p,q,h=[],k=g.length;for(j=0;j<k;j++){l=g[j][0],q=[];for(o in l)l.hasOwnProperty(o)&&(q[o]=l[o]);for(o in d)d.hasOwnProperty(o)&&(q[o]=d[o]);for(f=a(b.slice(1),c.slice(1),q,e),n=f.length,m=0;m<n;m++){p=f[m][0];for(o in l)l.hasOwnProperty(o)&&(p[o]=l[o]);h.push([p,null])}}return h},k=function(b,c){var d=c[b];return void 0===d?b:d},l=function(b,c){var e,d={};for(e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);for(e in c)c.hasOwnProperty(e)&&(d[e]=c[e]);return d},m=function(b,c){return this.trunkBindings=c,this.originalCallback=b,this.branches=[],this};m.prototype.checkAllDone=function(){var a;for(a=0;a<this.branches.length;a++)if(!this.branches[a].done)return;f.debug("OPTIONAL BIDNINGS ALL DONE:"),this.doCallBacks(this.branches.length-1,this.trunkBindings)},m.prototype.doCallBacks=function(a,b){var c;if(a<0)return this.originalCallback(b);for(c=0;c<this.branches[a].results.length;c++)this.doCallBacks(a-1,l(b,this.branches[a].results[c]))};var n=function(b,c){return this.count=0,this.success=!1,this.done=!1,this.callback=b,this.onDone=c,this};n.prototype.reportMatch=function(a){this.callback(a),this.success=!0},n.prototype.reportDone=function(){this.done=!0,f.info("Mandatory query branch finished.***"),void 0!==this.onDone&&this.onDone()};var o=function(b){return this.count=0,this.done=!1,this.results=[],this.junction=b,b.branches.push(this),this};o.prototype.reportMatch=function(a){this.results.push(a)},o.prototype.reportDone=function(){f.debug("Optional branch finished - results.length = "+this.results.length),0===this.results.length&&(this.results.push({}),f.debug("Optional branch FAILED - that's OK.")),this.done=!0,this.junction.checkAllDone()};var p=function(b,c,d){var e,f,g,h,i;for(c.nvars=0,c.index=null,f=[c.subject,c.predicate,c.object],i=[b.subjectIndex,b.predicateIndex,b.objectIndex],h=0;h<3;h++)if(f[h].isVar&&void 0===d[f[h]])c.nvars++;else{if(e=k(f[h],d),b.redirections[e.hashString()]&&(e=b.redirections[e.hashString()]),g=i[h][e.hashString()],!g)return c.index=[],!1;(null===c.index||c.index.length>g.length)&&(c.index=g)}return null===c.index&&(c.index=b.statements),!0},r=0,s=function a(c,d,h,i,j,k,l){f.debug("Match begins, Branch count now: "+l.count+" for "+l.pattern_debug);var n=c.fetcher?c.fetcher:null,p=d.statements;if(0===p.length){if(f.debug("FOUND MATCH WITH BINDINGS:"+e(h)),0===d.optional.length)l.reportMatch(h);else{f.debug("OPTIONAL: "+d.optional);var t,q=new m(b,h),s=[];for(t=0;t<d.optional.length;t++)s[t]=new o(q),s[t].pattern_debug=d.optional[t];for(t=0;t<d.optional.length;t++)s[t].count=s[t].count+1,a(c,d.optional[t],h,"",j,b,s[t])}return l.count--,void f.debug("Match ends -- success , Branch count now: "+l.count+" for "+l.pattern_debug)}var v,w,x=p.length;if(n){var y="match"+r++,z=function(e,f){var g=e.uri.split("#")[0];n.nowOrWhenFetched(g,void 0,function(b,f,g){b&&console.log("Error following link to <"+e.uri+"> in query: "+f),a(c,d,h,i,j,k,l)})};for(w=0;w<x;w++){if(v=p[w],void 0!==h[v.subject]&&h[v.subject].uri&&n&&"unrequested"===n.getState(g(h[v.subject].uri)))return void z(h[v.subject],y);if(void 0!==h[v.object]&&h[v.object].uri&&n&&"unrequested"===n.getState(g(h[v.object].uri)))return void z(h[v.object],y)}}u(c,d,h,i,j,k,l)},t=function(b,c){var e,f,d=!0;for(e in b)b.hasOwnProperty(e)&&c[e]&&(f=c[e].test,f&&!f(b[e])&&(d=!1));return d},u=function(b,c,d,g,i,k,l){var o,r,u,v,w,x,y,m=c.statements,n=m.length;for(o=0;o<n;o++)y=m[o],f.info("match2: item="+y+", bindingsSoFar="+e(d)),p(b,y,d);m.sort(q),y=m[0];var z=b.formula();z.optional=c.optional,z.constraints=c.constraints,z.statements=m.slice(1),f.debug(g+"match2 searching "+y.index.length+" for "+y+"; bindings so far="+e(d));var A,C,D,B=y.index.length,E=0;for(A=0;A<B;A++)for(D=y.index[A],C=j([y.subject,y.predicate,y.object],[D.subject,D.predicate,D.object],d,b),f.info(g+" From first: "+C.length+": "+h(C)),u=C.length,r=0;r<u;r++)if(w=[],x=C[r][0],t(x,c.constraints)){for(v in x)x.hasOwnProperty(v)&&(w[v]=x[v]);for(v in d)d.hasOwnProperty(v)&&(w[v]=d[v]);l.count++,E++,s(b,z,w,g+"  ",i,k,l)}else f.debug("Branch count CS: "+l.count);l.count--,0===E&&f.debug("Match2 fails completely on "+y),f.debug("Match2 ends, Branch count: "+l.count+" for "+l.pattern_debug),0===l.count&&(f.debug("Branch finished."),l.reportDone())},v=this;f.debug("Query on "+this.statements.length);var w=new n(b,d);w.count++,setTimeout(function(){s(v,a.pat,a.pat.initBindings,"",c,b,w)},0)}var e=a("./indexed-formula"),f=a("./log"),g=a("./uri").docpart,h=function a(b,c){d(this,a),this.pat=new e,this.vars=[],this.name=b,this.id=c};b.exports.Query=h,b.exports.indexedFormulaQuery=i},{"./indexed-formula":51,"./log":54,"./uri":71}],63:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./blank-node"),g=a("./literal"),h=a("./data-factory"),i=a("./named-node"),j=a("./uri"),k=a("./util");if("undefined"==typeof l)var l={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12};var m=function(){function a(b,c){e(this,a),this.options=c||{},this.kb=b,this.target=c.target||{graph:{subjects:{},prefixes:{},terms:{}}},this.blankNodes=[],this.htmlOptions={selfClosing:"br img input area base basefont col colgroup source wbr isindex link meta param hr"},this.theOne="_:"+(new Date).getTime(),this.language=null,this.vocabulary=null,this.blankCounter=0,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"}],this.inXHTMLMode=!1,this.absURIRE=/[\w\_\-]+:\S+/,this.finishedHandlers=[],this.init()}return d(a,[{key:"addTriple",value:function(b,c,d,e){var f,g,i,j;f="undefined"==typeof c?h.namedNode(this.options.base):this.toRDFNodeObject(c),i=this.toRDFNodeObject(d),g=this.toRDFNodeObject(e),j=h.namedNode(this.options.base),this.kb.add(f,i,g,j)}},{key:"ancestorPath",value:function(b){for(var c="";b&&b.nodeType!==l.DOCUMENT_NODE;)c="/"+b.localName+c,b=b.parentNode;return c}},{key:"copyMappings",value:function(b){var c={};for(var d in b)c[d]=b[d];return c}},{key:"copyProperties",value:function(){}},{key:"deriveDateTimeType",value:function(c){for(var d=0;d<a.dateTimeTypes.length;d++){var e=a.dateTimeTypes[d].pattern.exec(c);if(e&&e[0].length===c.length)return a.dateTimeTypes[d].type}return null}},{key:"init",value:function(){}},{key:"newBlankNode",value:function(){return this.blankCounter++,"_:"+this.blankCounter}},{key:"newSubjectOrigin",value:function(b,c){}},{key:"parseCURIE",value:function(c,d,e){var g,f=c.indexOf(":");if(f>=0){var h=c.substring(0,f);if(""===h)return g=d[""],g?g+c.substring(f+1):null;if("_"===h)return"_:"+c.substring(f+1);if(a.NCNAME.test(h)&&(g=d[h]))return g+c.substring(f+1)}return null}},{key:"parseCURIEOrURI",value:function(b,c,d){var e=this.parseCURIE(b,c,d);return e?e:this.resolveAndNormalize(d,b)}},{key:"parsePredicate",value:function(b,c,d,e,f,g){if(""===b)return null;var h=this.parseTermOrCURIEOrAbsURI(b,c,g?null:d,e,f);return h&&0===h.indexOf("_:")?null:h}},{key:"parsePrefixMappings",value:function(b,c){for(var d=this.tokenize(b),e=null,f=0;f<d.length;f++)":"===d[f][d[f].length-1]?e=d[f].substring(0,d[f].length-1):e&&(c[e]=this.options.base?j.join(d[f],this.options.base):d[f],e=null)}},{key:"parseSafeCURIEOrCURIEOrURI",value:function(b,c,d){return b=this.trim(b),"["===b.charAt(0)&&"]"===b.charAt(b.length-1)?(b=b.substring(1,b.length-1),b=b.trim(b),0===b.length?null:"_:"===b?this.theOne:this.parseCURIE(b,c,d)):this.parseCURIEOrURI(b,c,d)}},{key:"parseTermOrCURIEOrAbsURI",value:function(b,c,d,e,f){b=this.trim(b);var g=this.parseCURIE(b,e,f);if(g)return g;if(d){if(c&&!this.absURIRE.exec(b))return c+b;var h=d[b];if(h)return h;var i=b.toLowerCase();if(h=d[i])return h}return this.absURIRE.exec(b)?this.resolveAndNormalize(f,b):null}},{key:"parseTermOrCURIEOrURI",value:function(b,c,d,e,f){b=this.trim(b);var g=this.parseCURIE(b,e,f);if(g)return g;var h=d[b];if(h)return h;var i=b.toLowerCase();return(h=d[i])?h:c&&!this.absURIRE.exec(b)?c+b:this.resolveAndNormalize(f,b)}},{key:"parseURI",value:function(b){return b}},{key:"process",value:function(c,d){var e;c.nodeType===l.DOCUMENT_NODE?(e=c.baseURI,c=c.documentElement,c.baseURI=e,this.setContext(c)):c.parentNode.nodeType===l.DOCUMENT_NODE&&this.setContext(c);var f=[],g=function(b){if(!b&&d&&d.baseURI)return d.baseURI;var c=b.indexOf("#");return c>=0&&(b=b.substring(0,c)),d&&d.baseURIMap&&(b=d.baseURIMap(b)),b};for(f.push({current:c,context:this.push(null,g(c.baseURI))});f.length>0;){var h=f.shift();if(h.parent){if(h.context.parent&&h.context.parent.listMapping===h.listMapping)continue;for(var i in h.listMapping){var k=h.listMapping[i];if(0!==k.length){for(var m=[],n=0;n<k.length;n++)m.push(this.newBlankNode());for(var o=0;o<m.length;o++)this.addTriple(h.parent,m[o],"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",k[o]),this.addTriple(h.parent,m[o],"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",{type:a.objectURI,value:o+1<m.length?m[o+1]:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"});this.addTriple(h.parent,h.subject,i,{type:a.objectURI,value:m[0]})}else this.addTriple(h.parent,h.subject,i,{type:a.objectURI,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"})}}else{var p=h.current,q=h.context,r=!1,s=null,t=null,u=null,v=q.prefixes,w=!1,x=[],y=q.listMapping,z=!q.parent,A=q.language,B=q.vocabulary;e=this.parseURI(g(p.baseURI)),p.item=null;var C=p.getAttributeNode("vocab");if(C){var D=this.trim(C.value);if(D.length>0){B=D;var E=e.spec;this.addTriple(p,E,"http://www.w3.org/ns/rdfa#usesVocabulary",{type:a.objectURI,value:B})}else B=this.vocabulary}for(var F=0;F<p.attributes.length;F++){var G=p.attributes[F];if("x"===G.nodeName.charAt(0)&&0===G.nodeName.indexOf("xmlns:")){w||(v=this.copyMappings(v),w=!0);var H=G.nodeName.substring(6),I=a.trim(G.value);v[H]=this.options.base?j.join(I,this.options.base):I}}var J=p.getAttributeNode("prefix");J&&(w||(v=this.copyMappings(v),w=!0),this.parsePrefixMappings(J.value,v));for(var K=null,L=0;!K&&L<this.langAttributes.length;L++)K=p.getAttributeNodeNS(this.langAttributes[L].namespaceURI,this.langAttributes[L].localName);if(K){var M=a.trim(K.value);A=M.length>0?M:null}var $,_,N=p.getAttributeNode("rel"),O=p.getAttributeNode("rev"),P=p.getAttributeNode("typeof"),Q=p.getAttributeNode("property"),R=p.getAttributeNode("datatype"),S=this.inHTMLMode?p.getAttributeNode("datetime"):null,T=p.getAttributeNode("content"),U=p.getAttributeNode("about"),V=p.getAttributeNode("src"),W=p.getAttributeNode("resource"),X=p.getAttributeNode("href"),Y=p.getAttributeNode("inlist"),Z=[];if(N){_=this.tokenize(N.value);for(var aa=0;aa<_.length;aa++)$=this.parsePredicate(_[aa],B,q.terms,v,e,this.inHTMLMode&&null!==Q),$&&Z.push($)}var ba=[];if(O){_=this.tokenize(O.value);for(var ca=0;ca<_.length;ca++)$=this.parsePredicate(_[ca],B,q.terms,v,e,this.inHTMLMode&&Q),$&&ba.push($)}if(this.inHTMLMode&&(N||O)&&Q&&(0===Z.length&&(N=null),0===ba.length&&(O=null)),N||O?(U&&(s=this.parseSafeCURIEOrCURIEOrURI(U.value,v,e)),P&&(u=s),s||(p.parentNode.nodeType===l.DOCUMENT_NODE?s=g(p.baseURI):q.parentObject&&(s=g(p.parentNode.baseURI)===q.parentObject?g(p.baseURI):q.parentObject)),W&&(t=this.parseSafeCURIEOrCURIEOrURI(W.value,v,e)),t||(X?t=this.resolveAndNormalize(e,encodeURI(X.value)):V?t=this.resolveAndNormalize(e,encodeURI(V.value)):!P||U||this.inXHTMLMode&&("head"===p.localName||"body"===p.localName)||(t=this.newBlankNode())),!P||U||!this.inXHTMLMode||"head"!==p.localName&&"body"!==p.localName?P&&!U&&(u=t):u=s):!Q||T||R?(U&&(s=this.parseSafeCURIEOrCURIEOrURI(U.value,v,e)),!s&&W&&(s=this.parseSafeCURIEOrCURIEOrURI(W.value,v,e)),!s&&X&&(s=this.resolveAndNormalize(e,encodeURI(X.value))),!s&&V&&(s=this.resolveAndNormalize(e,encodeURI(V.value))),s||(p.parentNode.nodeType===l.DOCUMENT_NODE?s=g(p.baseURI):!this.inXHTMLMode&&!this.inHTMLMode||"head"!==p.localName&&"body"!==p.localName?P?s=this.newBlankNode():q.parentObject&&(s=g(p.parentNode.baseURI)===q.parentObject?g(p.baseURI):q.parentObject,Q||(r=!0)):s=g(p.parentNode.baseURI)===q.parentObject?g(p.baseURI):q.parentObject),P&&(u=s)):(U&&(s=this.parseSafeCURIEOrCURIEOrURI(U.value,v,e),P&&(u=s)),s||p.parentNode.nodeType!==l.DOCUMENT_NODE?!s&&q.parentObject&&(s=g(p.parentNode.baseURI)===q.parentObject?g(p.baseURI):q.parentObject):(s=g(p.baseURI),P&&(u=s)),P&&!u&&(W&&(u=this.parseSafeCURIEOrCURIEOrURI(W.value,v,e)),!u&&X&&(u=this.resolveAndNormalize(e,encodeURI(X.value))),!u&&V&&(u=this.resolveAndNormalize(e,encodeURI(V.value))),u||!this.inXHTMLMode&&!this.inHTMLMode||"head"!==p.localName&&"body"!==p.localName||(u=s),u||(u=this.newBlankNode()),t=u)),s&&(U||W||u)){var da=s;P&&!U&&!W&&t&&(da=t),this.newSubjectOrigin(p,da)}if(u){_=this.tokenize(P.value);for(var ea=0;ea<_.length;ea++){var fa=this.parseTermOrCURIEOrAbsURI(_[ea],B,q.terms,v,e);fa&&this.addTriple(p,u,a.typeURI,{type:a.objectURI,value:fa})}}if(s&&s!==q.parentObject&&(y={},z=!0),t){if(N&&Y)for(var ga=0;ga<Z.length;ga++){var ha=y[Z[ga]];ha||(ha=[],y[Z[ga]]=ha),ha.push({type:a.objectURI,value:t})}else if(N)for(var ia=0;ia<Z.length;ia++)this.addTriple(p,s,Z[ia],{type:a.objectURI,value:t});if(O)for(var ja=0;ja<ba.length;ja++)this.addTriple(p,t,ba[ja],{type:a.objectURI,value:s})}else{if(s&&!t&&(N||O)&&(t=this.newBlankNode()),N&&Y)for(var ka=0;ka<Z.length;ka++){var la=y[Z[ka]];la||(la=[],y[$]=la),x.push({predicate:Z[ka],list:la})}else if(N)for(var ma=0;ma<Z.length;ma++)x.push({predicate:Z[ma],forward:!0});if(O)for(var na=0;na<ba.length;na++)x.push({predicate:ba[na],forward:!1})}if(Q){var oa=null,pa=null;R?(oa=""===R.value?a.PlainLiteralURI:this.parseTermOrCURIEOrAbsURI(R.value,B,q.terms,v,e),pa=S&&!T?S.value:oa===a.XMLLiteralURI||oa===a.HTMLLiteralURI?null:T?T.value:p.textContent):T?(oa=a.PlainLiteralURI,pa=T.value):S?(pa=S.value,oa=a.deriveDateTimeType(pa),oa||(oa=a.PlainLiteralURI)):N||O||(W&&(pa=this.parseSafeCURIEOrCURIEOrURI(W.value,v,e)),!pa&&X?pa=this.resolveAndNormalize(e,encodeURI(X.value)):!pa&&V&&(pa=this.resolveAndNormalize(e,encodeURI(V.value))),pa&&(oa=a.objectURI)),oa||(P&&!U?(oa=a.objectURI,pa=u):(pa=p.textContent,this.inHTMLMode&&"time"===p.localName&&(oa=a.deriveDateTimeType(pa)),oa||(oa=a.PlainLiteralURI))),_=this.tokenize(Q.value);for(var qa=0;qa<_.length;qa++){var ra=this.parsePredicate(_[qa],B,q.terms,v,e);if(ra)if(Y){var sa=y[ra];sa||(sa=[],y[ra]=sa),sa.push(oa===a.XMLLiteralURI||oa===a.HTMLLiteralURI?{type:oa,value:p.childNodes}:{type:oa?oa:a.PlainLiteralURI,value:pa,language:A})}else oa===a.XMLLiteralURI||oa===a.HTMLLiteralURI?this.addTriple(p,s,ra,{type:oa,value:p.childNodes}):this.addTriple(p,s,ra,{type:oa?oa:a.PlainLiteralURI,value:pa,language:A})}}if(s&&!r)for(var ta=0;ta<q.incomplete.length;ta++)q.incomplete[ta].list?q.incomplete[ta].list.push({type:a.objectURI,value:s}):q.incomplete[ta].forward?this.addTriple(p,q.subject,q.incomplete[ta].predicate,{type:a.objectURI,value:s}):this.addTriple(p,s,q.incomplete[ta].predicate,{type:a.objectURI,value:q.subject});var ua=null,va=s;r?(ua=this.push(q,q.subject),ua.parentObject=g(p.parentNode.baseURI)===q.parentObject?g(p.baseURI):q.parentObject,ua.incomplete=q.incomplete,ua.language=A,ua.prefixes=v,ua.vocabulary=B):(ua=this.push(q,s),ua.parentObject=t?t:s?s:q.subject,ua.prefixes=v,ua.incomplete=x,t&&(va=t,y={},z=!0),ua.listMapping=y,ua.language=A,ua.vocabulary=B),z&&f.unshift({parent:p,context:q,subject:va,listMapping:y});for(var wa=p.lastChild;wa;wa=wa.previousSibling)wa.nodeType===l.ELEMENT_NODE&&(wa.baseURI=p.baseURI,f.unshift({current:wa,context:ua}))}}this.inHTMLMode&&this.copyProperties();for(var xa=0;xa<this.finishedHandlers.length;xa++)this.finishedHandlers[xa](c)}},{key:"push",value:function(b,c){return{parent:b,subject:c?c:b?b.subject:null,parentObject:null,incomplete:[],listMapping:b?b.listMapping:{},language:b?b.language:this.language,prefixes:b?b.prefixes:this.target.graph.prefixes,terms:b?b.terms:this.target.graph.terms,vocabulary:b?b.vocabulary:this.vocabulary}}},{key:"resolveAndNormalize",value:function(b,c){return j.join(c,b)}},{key:"setContext",value:function(b){"html"===b.localName&&"XHTML+RDFa 1.1"===b.getAttribute("version")?this.setXHTMLContext():"html"===b.localName||"http://www.w3.org/1999/xhtml"===b.namespaceURI?"undefined"!=typeof document&&document.doctype?"-//W3C//DTD XHTML+RDFa 1.0//EN"===document.doctype.publicId&&"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd"===document.doctype.systemId?(console.log("WARNING: RDF 1.0 is not supported.  Defaulting to HTML5 mode."),this.setHTMLContext()):"-//W3C//DTD XHTML+RDFa 1.1//EN"===document.doctype.publicId&&"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-2.dtd"===document.doctype.systemId?this.setXHTMLContext():this.setHTMLContext():this.setHTMLContext():this.setXMLContext()}},{key:"setHTMLContext",value:function(){this.setInitialContext(),this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"},{namespaceURI:null,localName:"lang"}],this.inXHTMLMode=!1,this.inHTMLMode=!0}},{key:"setInitialContext",value:function(){this.vocabulary=null,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"}]}},{key:"setXHTMLContext",value:function(){this.setInitialContext(),this.inXHTMLMode=!0,this.inHTMLMode=!1,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"},{namespaceURI:null,localName:"lang"}],this.target.graph.terms.alternate="http://www.w3.org/1999/xhtml/vocab#alternate",this.target.graph.terms.appendix="http://www.w3.org/1999/xhtml/vocab#appendix",this.target.graph.terms.bookmark="http://www.w3.org/1999/xhtml/vocab#bookmark",this.target.graph.terms.cite="http://www.w3.org/1999/xhtml/vocab#cite",this.target.graph.terms.chapter="http://www.w3.org/1999/xhtml/vocab#chapter",this.target.graph.terms.contents="http://www.w3.org/1999/xhtml/vocab#contents",this.target.graph.terms.copyright="http://www.w3.org/1999/xhtml/vocab#copyright",this.target.graph.terms.first="http://www.w3.org/1999/xhtml/vocab#first",this.target.graph.terms.glossary="http://www.w3.org/1999/xhtml/vocab#glossary",this.target.graph.terms.help="http://www.w3.org/1999/xhtml/vocab#help",this.target.graph.terms.icon="http://www.w3.org/1999/xhtml/vocab#icon",this.target.graph.terms.index="http://www.w3.org/1999/xhtml/vocab#index",this.target.graph.terms.last="http://www.w3.org/1999/xhtml/vocab#last",this.target.graph.terms.license="http://www.w3.org/1999/xhtml/vocab#license",this.target.graph.terms.meta="http://www.w3.org/1999/xhtml/vocab#meta",this.target.graph.terms.next="http://www.w3.org/1999/xhtml/vocab#next",this.target.graph.terms.prev="http://www.w3.org/1999/xhtml/vocab#prev",this.target.graph.terms.previous="http://www.w3.org/1999/xhtml/vocab#previous",this.target.graph.terms.section="http://www.w3.org/1999/xhtml/vocab#section",this.target.graph.terms.stylesheet="http://www.w3.org/1999/xhtml/vocab#stylesheet",this.target.graph.terms.subsection="http://www.w3.org/1999/xhtml/vocab#subsection",this.target.graph.terms.start="http://www.w3.org/1999/xhtml/vocab#start",this.target.graph.terms.top="http://www.w3.org/1999/xhtml/vocab#top",this.target.graph.terms.up="http://www.w3.org/1999/xhtml/vocab#up",this.target.graph.terms.p3pv1="http://www.w3.org/1999/xhtml/vocab#p3pv1",this.target.graph.terms.related="http://www.w3.org/1999/xhtml/vocab#related",this.target.graph.terms.role="http://www.w3.org/1999/xhtml/vocab#role",this.target.graph.terms.transformation="http://www.w3.org/1999/xhtml/vocab#transformation"}},{key:"setXMLContext",value:function(){this.setInitialContext(),this.inXHTMLMode=!1,this.inHTMLMode=!1}},{key:"tokenize",value:function(b){return this.trim(b).split(/\s+/)}},{key:"toRDFNodeObject",value:function(c){if("undefined"!=typeof c){if("string"==typeof c)return"_:"===c.substring(0,2)?("undefined"==typeof this.blankNodes[c.substring(2)]&&(this.blankNodes[c.substring(2)]=new f(c.substring(2))),this.blankNodes[c.substring(2)]):h.namedNode(c);switch(c.type){case a.objectURI:return"_:"===c.value.substring(0,2)?("undefined"==typeof this.blankNodes[c.value.substring(2)]&&(this.blankNodes[c.value.substring(2)]=new f(c.value.substring(2))),this.blankNodes[c.value.substring(2)]):h.namedNode(c.value);case a.PlainLiteralURI:return new g(c.value,c.language||"");case a.XMLLiteralURI:case a.HTMLLiteralURI:var d="";return Object.keys(c.value).forEach(function(a){d+=k.domToString(c.value[a],this.htmlOptions)}),new g(d,"",new i(c.type));default:return new g(c.value,"",new i(c.type))}}}},{key:"trim",value:function(b){return b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}],[{key:"parseRDFaDOM",value:function(c,d,e){var f=new a(d,{base:e});c.baseURI=e,f.process(c)}}]),a}();m.XMLLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral",m.HTMLLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#HTML",m.PlainLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral",m.objectURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#object",m.typeURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",m.nameChar="[-A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�က0-F.0-9·̀-ͯ‿-⁀]",m.nameStartChar="[A-Za-zÀ-ÖØ-öø-ÿĀ-ıĴ-ľŁ-ňŊ-žƀ-ǃǍ-ǰǴ-ǵǺ-ȗɐ-ʨʻ-ˁΆΈ-ΊΌΎ-ΡΣ-ώϐ-ϖϚϜϞϠϢ-ϳЁ-ЌЎ-яё-ќў-ҁҐ-ӄӇ-ӈӋ-ӌӐ-ӫӮ-ӵӸ-ӹԱ-Ֆՙա-ֆא-תװ-ײء-غف-يٱ-ڷں-ھۀ-ێې-ۓەۥ-ۦअ-हऽक़-ॡঅ-ঌএ-ঐও-নপ-রলশ-হড়-ঢ়য়-ৡৰ-ৱਅ-ਊਏ-ਐਓ-ਨਪ-ਰਲ-ਲ਼ਵ-ਸ਼ਸ-ਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઋઍએ-ઑઓ-નપ-રલ-ળવ-હઽૠଅ-ଌଏ-ଐଓ-ନପ-ରଲ-ଳଶ-ହଽଡ଼-ଢ଼ୟ-ୡஅ-ஊஎ-ஐஒ-கங-சஜஞ-டண-தந-பம-வஷ-ஹఅ-ఌఎ-ఐఒ-నప-ళవ-హౠ-ౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹೞೠ-ೡഅ-ഌഎ-ഐഒ-നപ-ഹൠ-ൡก-ฮะา-ำเ-ๅກ-ຂຄງ-ຈຊຍດ-ທນ-ຟມ-ຣລວສ-ຫອ-ຮະາ-ຳຽເ-ໄཀ-ཇཉ-ཀྵႠ-Ⴥა-ჶᄀᄂ-ᄃᄅ-ᄇᄉᄋ-ᄌᄎ-ᄒᄼᄾᅀᅌᅎᅐᅔ-ᅕᅙᅟ-ᅡᅣᅥᅧᅩᅭ-ᅮᅲ-ᅳᅵᆞᆨᆫᆮ-ᆯᆷ-ᆸᆺᆼ-ᇂᇫᇰᇹḀ-ẛẠ-ỹἀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼΩK-Å℮ↀ-ↂぁ-ゔァ-ヺㄅ-ㄬ가-힣一-龥〇〡-〩_]",m.NCNAME=new RegExp("^"+m.nameStartChar+m.nameChar+"*$"),m.dateTimeTypes=[{pattern:/-?P(?:[0-9]+Y)?(?:[0-9]+M)?(?:[0-9]+D)?(?:T(?:[0-9]+H)?(?:[0-9]+M)?(?:[0-9]+(?:\.[0-9]+)?S)?)?/,type:"http://www.w3.org/2001/XMLSchema#duration"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9]T(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]+)?(?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#dateTime"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9](?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#date"},{pattern:/(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]+)?(?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#time"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]/,type:"http://www.w3.org/2001/XMLSchema#gYearMonth"},{pattern:/-?[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9]/,type:"http://www.w3.org/2001/XMLSchema#gYear"}],b.exports=m},{"./blank-node":42,"./data-factory":46,"./literal":53,"./named-node":56,"./uri":71,"./util":72}],64:[function(a,b,c){"use strict";var d=a("./uri"),e=function a(b){var a={};a.ns={RDF:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDFS:"http://www.w3.org/2000/01/rdf-schema#"},a.nodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},this.frameFactory=function(b,c,e){return{NODE:1,ARC:2,parent:c,parser:b,store:b.store,element:e,lastChild:0,base:null,lang:null,node:null,nodeType:null,
listIndex:1,rdfid:null,datatype:null,collection:!1,terminateFrame:function(){this.collection&&this.node.close()},addSymbol:function(b,c){c=d.join(c,this.base),this.node=this.store.sym(c),this.nodeType=b},loadTriple:function(){if(this.parent.parent.collection?this.parent.parent.node.append(this.node):this.store.add(this.parent.parent.node,this.parent.node,this.node,this.parser.why),null!=this.parent.rdfid){var c=this.store.sym(d.join("#"+this.parent.rdfid,this.base));this.store.add(c,this.store.sym(a.ns.RDF+"type"),this.store.sym(a.ns.RDF+"Statement"),this.parser.why),this.store.add(c,this.store.sym(a.ns.RDF+"subject"),this.parent.parent.node,this.parser.why),this.store.add(c,this.store.sym(a.ns.RDF+"predicate"),this.parent.node,this.parser.why),this.store.add(c,this.store.sym(a.ns.RDF+"object"),this.node,this.parser.why)}},isTripleToLoad:function(){return null!=this.parent&&null!=this.parent.parent&&this.nodeType===this.NODE&&this.parent.nodeType===this.ARC&&this.parent.parent.nodeType===this.NODE},addNode:function(b){this.addSymbol(this.NODE,b),this.isTripleToLoad()&&this.loadTriple()},addCollection:function(){this.nodeType=this.NODE,this.node=this.store.collection(),this.collection=!0,this.isTripleToLoad()&&this.loadTriple()},addCollectionArc:function(){this.nodeType=this.ARC},addBNode:function(b){null!=b?null!=this.parser.bnodes[b]?this.node=this.parser.bnodes[b]:this.node=this.parser.bnodes[b]=this.store.bnode():this.node=this.store.bnode(),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()},addArc:function(c){c===a.ns.RDF+"li"&&(c=a.ns.RDF+"_"+this.parent.listIndex,this.parent.listIndex++),this.addSymbol(this.ARC,c)},addLiteral:function(b){this.parent.datatype?this.node=this.store.literal(b,"",this.store.sym(this.parent.datatype)):this.node=this.store.literal(b,this.lang),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()}}},this.getAttributeNodeNS=function(a,b,c){var d=null;if(a.getAttributeNodeNS)d=a.getAttributeNodeNS(b,c);else for(var f,g,e=a.attributes,h=0;h<e.length;++h)if(f=e[h],f.namespaceURI===b&&(g=f.prefix?f.prefix+":"+c:c,g===f.nodeName)){d=f;break}return d},this.store=b,this.bnodes={},this.why=null,this.reify=!1,this.parse=function(b,c,d){var e=b.childNodes;this.cleanParser();var f;if(b.nodeType===a.nodeType.DOCUMENT){for(var g=0;g<e.length;g++)if(e[g].nodeType===a.nodeType.ELEMENT){f=e[g];break}}else{if(b.nodeType!==a.nodeType.ELEMENT)throw new Error("RDFParser: can't find root in "+c+". Halting. ");f=b}this.why=d;var h=this.frameFactory(this);return this.base=c,h.base=c,h.lang=null,this.parseDOM(this.buildFrame(h,f)),!0},this.parseDOM=function(b){for(var c,e=function(a){var b="";if(null==a.namespaceURI)throw new Error("RDF/XML syntax error: No namespace for "+a.localName+" in "+this.base);return a.namespaceURI&&(b+=a.namespaceURI),a.localName?b+=a.localName:a.nodeName&&(b+=a.nodeName.indexOf(":")>=0?a.nodeName.split(":")[1]:a.nodeName),b}.bind(this),f=!0;b.parent;){var g=b.element,h=g.attributes;if(g.nodeType===a.nodeType.TEXT||g.nodeType===a.nodeType.CDATA_SECTION)b.parent.nodeType===b.NODE&&(b.addArc(a.ns.RDF+"value"),b=this.buildFrame(b)),b.addLiteral(g.nodeValue);else if(e(g)!==a.ns.RDF+"RDF")if(b.parent&&b.parent.collection&&(b.addCollectionArc(),b=this.buildFrame(b,b.element),b.parent.element=null),b.parent&&b.parent.nodeType&&b.parent.nodeType!==b.ARC){b.addArc(e(g)),this.reify&&(c=this.getAttributeNodeNS(g,a.ns.RDF,"ID"),c&&(b.rdfid=c.nodeValue,g.removeAttributeNode(c)));var m=this.getAttributeNodeNS(g,a.ns.RDF,"parseType"),n=this.getAttributeNodeNS(g,a.ns.RDF,"datatype");if(n&&(b.datatype=n.nodeValue,g.removeAttributeNode(n)),m){var o=m.nodeValue;"Literal"===o?(b.datatype=a.ns.RDF+"XMLLiteral",b=this.buildFrame(b),b.addLiteral(g),f=!1):"Resource"===o?(b=this.buildFrame(b,b.element),b.parent.element=null,b.addBNode()):"Collection"===o&&(b=this.buildFrame(b,b.element),b.parent.element=null,b.addCollection()),g.removeAttributeNode(m)}if(0!==h.length){var p=this.getAttributeNodeNS(g,a.ns.RDF,"resource"),q=this.getAttributeNodeNS(g,a.ns.RDF,"nodeID");b=this.buildFrame(b),p?(b.addNode(p.nodeValue),g.removeAttributeNode(p)):q?(b.addBNode(q.nodeValue),g.removeAttributeNode(q)):b.addBNode();for(var r=h.length-1;r>=0;r--){var s=this.buildFrame(b);s.addArc(e(h[r])),e(h[r])===a.ns.RDF+"type"?this.buildFrame(s).addNode(h[r].nodeValue):this.buildFrame(s).addLiteral(h[r].nodeValue)}}else 0===g.childNodes.length&&this.buildFrame(b).addLiteral("")}else{var i=this.getAttributeNodeNS(g,a.ns.RDF,"about");if(c=this.getAttributeNodeNS(g,a.ns.RDF,"ID"),i&&c)throw new Error("RDFParser: "+g.nodeName+" has both rdf:id and rdf:about. Halting. Only one of these properties may be specified on a node.");if(!i&&c)b.addNode("#"+c.nodeValue),g.removeAttributeNode(c);else if(null==i&&null==c){var j=this.getAttributeNodeNS(g,a.ns.RDF,"nodeID");j?(b.addBNode(j.nodeValue),g.removeAttributeNode(j)):b.addBNode()}else b.addNode(i.nodeValue),g.removeAttributeNode(i);var k=this.getAttributeNodeNS(g,a.ns.RDF,"type");a.ns.RDF+"Description"!==e(g)&&(k={nodeValue:e(g)}),null!=k&&(this.store.add(b.node,this.store.sym(a.ns.RDF+"type"),this.store.sym(d.join(k.nodeValue,b.base)),this.why),k.nodeName&&g.removeAttributeNode(k));for(var l=h.length-1;l>=0;l--)this.store.add(b.node,this.store.sym(e(h[l])),this.store.literal(h[l].nodeValue,b.lang),this.why)}for(g=b.element;b.parent;){for(var t=b;null==g;)b=b.parent,g=b.element;var u=g.childNodes&&g.childNodes[b.lastChild];if(u&&f){if((u.nodeType===a.nodeType.ELEMENT||u.nodeType===a.nodeType.TEXT||u.nodeType===a.nodeType.CDATA_SECTION)&&(u.nodeType!==a.nodeType.TEXT&&u.nodeType!==a.nodeType.CDATA_SECTION||1===g.childNodes.length)){b.lastChild++,b=this.buildFrame(t,g.childNodes[b.lastChild-1]);break}b.lastChild++}else{if(b.terminateFrame(),!(b=b.parent))break;g=b.element,f=!0}}}},this.cleanParser=function(){this.bnodes={},this.why=null},this.buildFrame=function(b,c){var e=this.frameFactory(this,b,c);if(b&&(e.base=b.base,e.lang=b.lang),!c||c.nodeType===a.nodeType.TEXT||c.nodeType===a.nodeType.CDATA_SECTION)return e;var f=c.attributes,g=c.getAttributeNode("xml:base");null!=g&&(e.base=g.nodeValue,c.removeAttribute("xml:base"));var h=c.getAttributeNode("xml:lang");null!=h&&(e.lang=h.nodeValue,c.removeAttribute("xml:lang"));for(var i=f.length-1;i>=0;i--)if("xml"===f[i].nodeName.substr(0,3)){if("xmlns:"===f[i].name.slice(0,6)){var j=f[i].nodeValue;this.base&&(j=d.join(j,this.base)),this.store.setPrefixForURI(f[i].name.slice(6),j)}c.removeAttributeNode(f[i])}return e}};b.exports=e},{"./uri":71}],65:[function(a,b,c){"use strict";function f(a,b,c,f,g){function l(a,b){return g?void g(a,b):b}var h=null;try{var k,i=e(b),j=b.statementsMatching(void 0,void 0,void 0,a);switch(i.suggestNamespaces(b.namespaces),i.setBase(c),f){case"application/rdf+xml":return h=i.statementsToXML(j),l(null,h);case"text/n3":case"application/n3":return h=i.statementsToN3(j),l(null,h);case"text/turtle":case"application/x-turtle":return i.setFlags("si"),h=i.statementsToN3(j),l(null,h);case"application/ld+json":k=i.statementsToN3(j),d.convertToJson(k,g);break;case"application/n-quads":case"application/nquads":k=i.statementsToN3(j),h=d.convertToNQuads(k,g);break;default:throw new Error("Serialize: Content-type "+f+" not supported for data write.")}}catch(a){if(g)return g(a);throw a}}b.exports=f;var d=a("./convert"),e=a("./serializer")},{"./convert":45,"./serializer":66}],66:[function(a,b,c){"use strict";var d=a("./named-node"),e=a("./uri"),f=a("./util"),g=a("./xsd"),h=function(){function b(a){return encodeURI(a)}function c(a){for(var c,b="",d=0;d<a.length;d++)c=a.charCodeAt(d),b+=c>65535?"\\U"+("00000000"+c.toString(16)).slice(-8):c>126?"\\u"+("0000"+c.toString(16)).slice(-4):a[d];return b}var a=function(b){this.flags="",this.base=null,this.prefixes=[],this.namespaces=[],this.suggestPrefix("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#"),this.suggestPrefix("xml","reserved:reservedForFutureUse"),this.namespacesUsed=[],this.keywords=["a"],this.prefixchars="abcdefghijklmnopqustuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",this.incoming=null,this.formulas=[],this.store=b};a.prototype.setBase=function(a){this.base=a},a.prototype.setFlags=function(a){this.flags=a?a:""},a.prototype.toStr=function(a){var b=a.toNT();return"formula"==a.termType&&(this.formulas[b]=a),b},a.prototype.fromStr=function(a){if("{"==a[0]){var b=this.formulas[a];return b||alert("No formula object for "+a),b}return this.store.fromNT(a)},a.prototype.suggestPrefix=function(a,b){"default"!==a.slice(0,7)&&"ns"!==a.slice(0,2)&&a&&b&&(a in this.namespaces||b in this.prefixes||(this.prefixes[b]=a,this.namespaces[a]=b))},a.prototype.suggestNamespaces=function(a){for(var b in a)this.suggestPrefix(b,a[b])},a.prototype.checkIntegrity=function(){var a,b;for(a in this.namespaces)if(this.prefixes[this.namespaces[a]]!==a)throw"Serializer integity error 1: "+a+", "+this.namespaces[a]+", "+this.prefixes[this.namespaces[a]]+"!";for(b in this.prefixes)if(this.namespaces[this.prefixes[b]]!==b)throw"Serializer integity error 2: "+b+", "+this.prefixs[b]+", "+this.namespaces[this.prefixes[b]]+"!"},a.prototype.makeUpPrefix=function(b){function e(c){return!!a.prototype.validPrefix.test(c)&&("ns"!==c&&(!(c in this.namespaces)&&(this.prefixes[b]=c,this.namespaces[c]=b,d=c,!0)))}var d,c=b;e=e.bind(this),"#/".indexOf(c[c.length-1])>=0&&(c=c.slice(0,-1));var f=c.lastIndexOf("/");f>=0&&(c=c.slice(f+1));for(var g=0;g<c.length&&this.prefixchars.indexOf(c[g]);)g++;if(c=c.slice(0,g),c.length<6&&e(c))return d;if(e(c.slice(0,3)))return d;if(e(c.slice(0,2)))return d;if(e(c.slice(0,4)))return d;if(e(c.slice(0,1)))return d;if(e(c.slice(0,5)))return d;a.prototype.validPrefix.test(c)||(c="n");for(var g=0;;g++)if(e(c.slice(0,3)+g))return d},a.prototype.rootSubjects=function(a){for(var b={},c={},d={},e=0;e<a.length;e++){var f=a[e];[f.subject,f.predicate,f.object].map(function(a){"BlankNode"==a.termType&&(d[a.toNT()]=!0)});var g=a[e].object;b.hasOwnProperty(g)||(b[g]=[]),b[g].push(f.subject);var h=c[this.toStr(f.subject)];h||(h=[]),h.push(f),c[this.toStr(f.subject)]=h}var i=[];for(var j in c)if(c.hasOwnProperty(j)){var g=this.fromStr(j);"BlankNode"==g.termType&&b[g]&&1==b[g].length||i.push(g)}this.incoming=b;for(var k={},e=0;e<i.length;e++)k[i[e].toNT()]=!0;return{roots:i,subjects:c,rootsHash:k,incoming:b}},a.prototype.toN3=function(a){return this.statementsToN3(a.statements)},a.prototype._notQNameChars="\t\r\n !\"#$%&'()*.,+/;<=>?@[\\]^`{|}~",a.prototype._notNameChars=a.prototype._notQNameChars+":",a.prototype.statementsToN3=function(b){function l(a){for(var c=this.rootSubjects(a),d=c.roots,e=[],f=0;f<d.length;f++){var g=d[f];e.push(m(g,c))}return e}function m(a,b){return"BlankNode"!=a.termType||b.incoming[a]?[p(a,b)].concat([n(a,b)]).concat(["."]):o(a,b,!0).concat(["."])}function n(a,b){var c=[],d=null,e=b.subjects[this.toStr(a)];if("undefined"==typeof e)throw"Cant find statements for "+a;e.sort();for(var i=[],j=0;j<e.length;j++){var k=e[j];k.predicate.uri==d?i.push(","):(d&&(c=c.concat([i]).concat([";"]),i=[]),c.push(g[k.predicate.uri]?g[k.predicate.uri]:p(k.predicate,b))),d=k.predicate.uri,i.push(o(k.object,b))}return c=c.concat([i])}function o(a,b,c){return"BlankNode"==a.termType&&b.subjects[this.toStr(a)]&&(c||void 0==b.rootsHash[a.toNT()])?["["].concat(n(a,b)).concat(["]"]):p(a,b)}function p(a,b){switch(a.termType){case"formula":var c=["{"];return c=c.concat(l(a.statements)),c.concat(["}"]);case"collection":var c=["("];for(i=0;i<a.elements.length;i++)c.push([o(a.elements[i],b)]);return c.push(")"),c;default:return this.atomicTermToN3(a)}}function q(){var a="";this.defaultNamespace&&(a+="@prefix : <"+this.defaultNamespace+">.\n");for(var b in this.prefixes)this.prefixes.hasOwnProperty(b)&&this.namespacesUsed[b]&&(a+="@prefix "+this.prefixes[b]+": <"+e.refTo(this.base,b)+">.\n");return a+"\n"}var c=4,d=80,g={};this.flags.indexOf("s")<0&&(g["http://www.w3.org/2002/07/owl#sameAs"]="="),this.flags.indexOf("t")<0&&(g["http://www.w3.org/1999/02/22-rdf-syntax-ns#type"]="a"),this.flags.indexOf("i")<0&&(g["http://www.w3.org/2000/10/swap/log#implies"]="=>");var h=function(b){for(var c="",d=0;d<b;d++)c+=" ";return c},j=function a(b){for(var c="",d=0;d<b.length;d++){var e=b[d],f="string"==typeof e?e:a(e);0!=d&&","!=f&&";"!=f&&(c+=" "),c+=f}return c},k=function a(b,e){var f="",g=1e5;e||(e=0);for(var i=0;i<b.length;i++){var k=b[i];if("string"!=typeof k){var l=a(k,e+1);if(l.length<10*(d-c*e)&&l.indexOf('"""')<0){var m=j(k);m.length<d-c*e&&(k="   "+m,l="")}l&&(g=1e4),f+=l}if("string"==typeof k){if("1"==k.length&&"\n"==f.slice(-1)){if(",.;".indexOf(k)>=0){f=f.slice(0,-1)+k+"\n",g+=1;continue}if("])}".indexOf(k)>=0){f=f.slice(0,-1)+" "+k+"\n",g+=2;continue}}if(g<c*e+4)f=f.slice(0,-1)+" "+k+"\n",g+=k.length+1;else{var m=h(c*e)+k;f+=m+"\n",g=m.length}}}return f};l=l.bind(this),n=n.bind(this),o=o.bind(this),a.prototype.termToN3=p,p=p.bind(this),q=q.bind(this);var r=l(b);return q()+k(r,-1)},a.prototype.atomicTermToN3=function(b,c){switch(b.termType){case"BlankNode":case"Variable":return b.toNT();case"Literal":if(b.datatype)switch(b.datatype.uri){case"http://www.w3.org/2001/XMLSchema#integer":return b.value.toString();case"http://www.w3.org/2001/XMLSchema#boolean":return b.value?"true":"false"}var d=this.stringToN3(b.value);return b.language?d+="@"+b.language:b.datatype.equals(g.string)||(d+="^^"+this.termToN3(b.datatype,c)),d;case"NamedNode":return this.symbolToN3(b);default:throw"Internal: atomicTermToN3 cannot handle "+b+" of termType+"+b.termType}},a.prototype.validPrefix=new RegExp(/^[a-zA-Z][a-zA-Z0-9]*$/),a.prototype.forbidden1=new RegExp(/[\\"\b\f\r\v\t\n\u0080-\uffff]/gm),a.prototype.forbidden3=new RegExp(/[\\"\b\f\r\v\u0080-\uffff]/gm),a.prototype.stringToN3=function(c,d){d||(d="e");var h,i,e="",f=0,g=0;for(c.length>20&&'"'!=c.slice(-1)&&d.indexOf("n")<0&&(c.indexOf("\n")>0||c.indexOf('"')>0)?(h='"""',i=a.prototype.forbidden3):(h='"',i=a.prototype.forbidden1),f=0;f<c.length;){i.lastIndex=0;var j=i.exec(c.slice(f));if(null==j)break;g=f+i.lastIndex-1,e+=c.slice(f,g);var k=c[g];if('"'==k&&'"""'==h&&'"""'!=c.slice(g,g+3))e+=k;else{var l='\b\f\r\t\v\n\\"'.indexOf(k);e+=l>=0?"\\"+'bfrtvn\\"'[l]:d.indexOf("e")>=0?"\\u"+("000"+k.charCodeAt(0).toString(16).toLowerCase()).slice(-4):k}f=g+1}return h+e+c.slice(f)+h},a.prototype.symbolToN3=function(f){var g=f.uri,h=g.indexOf("#");if(h<0&&this.flags.indexOf("/")<0&&(h=g.lastIndexOf("/")),h>=0&&this.flags.indexOf("p")<0&&(0===g.indexOf("http")||0===g.indexOf("ws")||0===g.indexOf("file"))){for(var i=!0,j=h+1;j<g.length;j++)if(a.prototype._notNameChars.indexOf(g[j])>=0){i=!1;break}if(g.slice(0,h+1)==this.base+"#")return"<#"+g.slice(h+1)+">";if(i){var k=g.slice(h+1),l=g.slice(0,h+1);if(this.defaultNamespace&&this.defaultNamespace==l&&this.flags.indexOf("d")<0)return this.flags.indexOf("k")>=0&&this.keyords.indexOf(k)<0?k:":"+k;this.checkIntegrity();var m=this.prefixes[l];if(m||(m=this.makeUpPrefix(l)),m)return this.namespacesUsed[l]=!0,m+":"+k}}return g=this.flags.indexOf("r")<0&&this.base?e.refTo(this.base,g):this.flags.indexOf("u")>=0?c(g):b(g),"<"+g+">"},a.prototype.writeStore=function(a){var b=this.store,c=b.fetcher,d=c&&c.appNode,e=this.store.index[3];for(s in e){var f=b.fromNT(s);d&&f.sameTerm(d)||a("\n"+this.atomicTermToN3(f)+" "+this.atomicTermToN3(b.sym("http://www.w3.org/2000/10/swap/log#semantics"))+" { "+this.statementsToN3(b.statementsMatching(void 0,void 0,void 0,f))+" }.\n")}b.statementsMatching(void 0,b.sym("http://www.w3.org/2007/ont/link#requestedURI")).map(function(c){a("\n<"+c.object.value+"> log:metadata {\n");var d=b.statementsMatching(void 0,void 0,void 0,c.subject);a(this.statementsToN3(this.statementsToN3(d))),a("}.\n")}),d&&metaSources.push(d);var g=[];metaSources.map(function(a){g=g.concat(b.statementsMatching(void 0,void 0,void 0,a))}),a(this.statementsToN3(g))},a.prototype.statementsToXML=function(b){function m(a){this.suggestPrefix("rdf","http://www.w3.org/1999/02/22-rdf-syntax-ns#");for(var b=this.rootSubjects(a),c=b.roots,d=[],e=0;e<c.length;e++){var f=c[e];d.push(p(f,b))}return d}function n(a){return"undefined"==typeof a?"@@@undefined@@@@":a.replace(/[&<"]/g,function(a){switch(a[0]){case"&":return"&amp;";case"<":return"&lt;";case'"':return"&quot;"}})}function o(a){return n(this.base?f.uri.refTo(this.base,a.uri):a.uri)}function p(a,b){var e,f,h,j,c=[],k=b.subjects[this.toStr(a)];if("undefined"==typeof k)throw"Serializing XML - Cant find statements for "+a;k.sort(function(a,b){var c=a.predicate.uri,d=b.predicate.uri;if(c.substring(0,i.length)==i||d.substring(0,i.length)==i)return c.localeCompare(d);var e=c.substring(i.length),f=d.substring(i.length),g=parseInt(e),h=parseInt(f);return isNaN(g)||isNaN(h)||g!=e||h!=f?c.localeCompare(d):g-h});for(var l=0;l<k.length;l++)if(h=k[l],"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"!=h.predicate.uri||e||"symbol"!=h.object.termType){if(j=h.predicate,j.uri.substr(0,i.length)==i){var m=j.uri.substr(i.length),r=parseInt(m);m==r.toString()&&(j=new d("http://www.w3.org/1999/02/22-rdf-syntax-ns#li"))}switch(f=s(j),h.object.termType){case"BlankNode":c=1==b.incoming[h.object].length?c.concat(["<"+f+">",p(h.object,b),"</"+f+">"]):c.concat(["<"+f+' rdf:nodeID="'+h.object.toNT().slice(2)+'"/>']);break;case"NamedNode":c=c.concat(["<"+f+' rdf:resource="'+o(h.object)+'"/>']);break;case"Literal":c=c.concat(["<"+f+(h.object.datatype.equals(g.string)?"":' rdf:datatype="'+n(h.object.datatype.uri)+'"')+(h.object.language?' xml:lang="'+h.object.language+'"':"")+">"+n(h.object.value)+"</"+f+">"]);break;case"collection":c=c.concat(["<"+f+' rdf:parseType="Collection">',q(h.object,b),"</"+f+">"]);break;default:throw"Can't serialize object of type "+h.object.termType+" into XML"}}else e=h.object;var t=e?s(e):"rdf:Description",u="";return"BlankNode"==a.termType?b.incoming[a]&&1==b.incoming[a].length||(u=' rdf:nodeID="'+a.toNT().slice(2)+'"'):u=' rdf:about="'+o(a)+'"',["<"+t+u+">"].concat([c]).concat(["</"+t+">"])}function q(a,b){for(var c=[],d=0;d<a.elements.length;d++)c.push(p(a.elements[d],b));return c}function r(a,b){var c=[],d=b.subjects[this.toStr(a)];if(void 0==d)return c;d.sort();for(var e=0;e<d.length;e++){var f=d[e];switch(f.object.termType){case"BlankNode":c=b.rootsHash[f.object.toNT()]?c.concat(["<"+s(f.predicate)+' rdf:nodeID="'+f.object.toNT().slice(2)+'">',"</"+s(f.predicate)+">"]):c.concat(["<"+s(f.predicate)+' rdf:parseType="Resource">',r(f.object,b),"</"+s(f.predicate)+">"]);break;case"NamedNode":c=c.concat(["<"+s(f.predicate)+' rdf:resource="'+o(f.object)+'"/>']);break;case"Literal":c=c.concat(["<"+s(f.predicate)+(f.object.datatype.equals(g.string)?"":' rdf:datatype="'+n(f.object.datatype.value)+'"')+(f.object.language?' xml:lang="'+f.object.language+'"':"")+">"+n(f.object.value)+"</"+s(f.predicate)+">"]);break;case"collection":c=c.concat(["<"+s(f.predicate)+' rdf:parseType="Collection">',q(f.object,b),"</"+s(f.predicate)+">"]);break;default:throw"Can't serialize object of type "+f.object.termType+" into XML"}}return c}function s(b){var c=b.uri,d=c.indexOf("#");if(d<0&&this.flags.indexOf("/")<0&&(d=c.lastIndexOf("/")),d<0)throw"Cannot make qname out of <"+c+">";for(var f=d+1;f<c.length;f++)if(a.prototype._notNameChars.indexOf(c[f])>=0)throw'Invalid character "'+c[f]+'" cannot be in XML qname for URI: '+c;var g=c.slice(d+1),i=c.slice(0,d+1);if(this.defaultNamespace&&this.defaultNamespace==i&&this.flags.indexOf("d")<0)return g;var j=this.prefixes[i];return j||(j=this.makeUpPrefix(i)),h[i]=!0,j+":"+g}var c=4,e=80,h=[];h["http://www.w3.org/1999/02/22-rdf-syntax-ns#"]=!0;var i="http://www.w3.org/1999/02/22-rdf-syntax-ns#_",j=function(b){for(var c="",d=0;d<b;d++)c+=" ";return c},k=function a(b){for(var c="",d=0;d<b.length;d++){var e=b[d],f="string"==typeof e?e:a(e);c+=f}return c},l=function a(b,d){var f="",g=1e5;d||(d=0);for(var h=0;h<b.length;h++){var i=b[h];if("string"!=typeof i){var l=a(i,d+1);if(l.length<10*(e-c*d)&&l.indexOf('"""')<0){var m=k(i);m.length<e-c*d&&(i="   "+m,l="")}l&&(g=1e4),f+=l}if("string"==typeof i)if(g<c*d+4)f=f.slice(0,-1)+" "+i+"\n",g+=i.length+1;else{var m=j(c*d)+i;f+=m+"\n",g=m.length}}return f};m=m.bind(this),o=o.bind(this),p=p.bind(this),r=r.bind(this),s=s.bind(this);var t=m(b),u="<rdf:RDF";this.defaultNamespace&&(u+=' xmlns="'+n(this.defaultNamespace)+'"');for(var v in h)h.hasOwnProperty(v)&&(u+="\n xmlns:"+this.prefixes[v]+'="'+n(v)+'"');u+=">";var w=[u,t,"</rdf:RDF>"];return l(w,-1)};var h=function(c){return new a(c)};return h}();b.exports=h},{"./named-node":56,"./uri":71,"./util":72,"./xsd":74}],67:[function(a,b,c){"use strict";function g(a,b,c){function h(a){if(g[a])return g[a];var b=c.variable(a);return g[a]=b,b}function i(a){return"string"==typeof a&&a.match(/[^ \n\t]/)}function j(a){return"string"==typeof a&&a.match(/^[\?\$]/)}function k(a){return"string"==typeof a?a.replace(/^&lt;/,"<").replace(/&gt;$/,">"):a}function l(a){return"string"==typeof a&&a.match(/^<[^>]*>$/)}function m(a){return"string"==typeof a&&(a.match(/^_:/)||a.match(/^$/))}function n(a){return"string"==typeof a&&a.match(/:$/)}function o(a){return"string"==typeof a&&a.match(/^:|^[^_][^:]*:/)}function p(a){var b=a.split(":");return b[0]}function q(a){var b=a.split(":");return b[1]}function r(a){return l(a)?a.slice(1,a.length-1):a}function s(a){var b=a.indexOf("'")===-1?null:a.indexOf("'"),e=a.indexOf('"')===-1?null:a.indexOf('"');if(!b&&!e){var f=new Array(1);return f[0]=a,f}var h,i,g=new Array(2);if(!b||e&&e<b)h='"',i=e;else{if(e&&!(b&&b<e))return d.error("SQARQL QUERY OOPS!"),g;h="'",i=b}g[0]=a.slice(0,i);var j=a.slice(i+1).indexOf(h);if(j===-1)return d.error("SPARQL parsing error: no matching parentheses in literal "+a),a;var k;return a.slice(j+i+2).match(/^\^\^/)?(k=a.slice(j+i+2).indexOf(" "),g[1]=c.literal(a.slice(i+1,i+1+j),"",c.sym(r(a.slice(i+4+j,i+2+j+k)))),g=g.concat(s(a.slice(j+i+3+k)))):a.slice(j+i+2).match(/^@/)?(k=a.slice(j+i+2).indexOf(" "),g[1]=c.literal(a.slice(i+1,i+1+j),a.slice(i+3+j,i+2+j+k),null),g=g.concat(s(a.slice(j+i+2+k)))):(g[1]=c.literal(a.slice(i+1,i+1+j),"",null),d.info("Literal found: "+g[1]),g=g.concat(s(a.slice(j+i+2)))),g}function t(a){a=a.replace(/\(/g," ( ").replace(/\)/g," ) ").replace(/</g," <").replace(/>/g,"> ").replace(/{/g," { ").replace(/}/g," } ").replace(/[\t\n\r]/g," ").replace(/; /g," ; ").replace(/\. /g," . ").replace(/, /g," , "),d.info("New str into spaceDelimit: \n"+a);var b=[],c=a.split(" ");for(var e in c)i(c[e])&&(b=b.concat(c[e]));return b}function u(a){for(var b=a,c=0;c<b.length;c++)if("a"===b[c]&&(b[c]="<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>"),"is"===b[c]&&"of"===b[c+2]){b.splice(c,1),b.splice(c+1,1);var d=b[c-1];b[c-1]=b[c+1],b[c+1]=d}return b}function v(a){for(var b=[],e=0;e<a.length;e++)"string"==typeof a[e]?(a[e]=k(a[e]),j(a[e])?b[e]=h(a[e].slice(1)):m(a[e])?(d.info(a[e]+" was identified as a bnode."),b[e]=c.bnode()):l(a[e])?(d.info(a[e]+" was identified as a symbol."),b[e]=c.sym(r(a[e]))):o(a[e])?(d.info(a[e]+" was identified as a prefixed symbol"),M[p(a[e])]?b[e]=c.sym(a[e]=M[p(a[e])]+q(a[e])):(d.error("SPARQL error: "+a[e]+" with prefix "+p(a[e])+" does not have a correct prefix entry."),b[e]=a[e])):b[e]=a[e]):b[e]=a[e];return b}function w(a){var b=s(a),c=[];for(var e in b)c="string"==typeof b[e]?c.concat(t(b[e])):c.concat(b[e]);return c=u(c),d.info("SPARQL Tokens: "+c),c}function x(a,b){for(var c=0;c<b.length;c++)if("string"==typeof b[c]&&b[c].toLowerCase()===a.toLowerCase())return c;return null}function y(a,b){for(var c=[],d=0;d<b.length;d++)"string"==typeof b[d]&&b[d].toLowerCase()===a.toLowerCase()&&c.push(d);return c}function z(a,b){d.info("SPARQL vars: "+a);for(var c in a)if(j(a[c])){d.info("Added "+a[c]+" to query variables from SPARQL");var e=h(a[c].slice(1));b.vars.push(e),e.label=a[c].slice(1)}else d.warn("Incorrect SPARQL variable in SELECT: "+a[c])}function A(a){var b=y("PREFIX",a),c=[];for(var e in b){var f=a[b[e]+1],g=a[b[e]+2];if(n(f))if(l(g)){d.info("Prefix found: "+f+" -> "+g);var h=p(f),i=r(g);c[h]=i}else d.error("Invalid SPARQL symbol: "+g);else d.error("Invalid SPARQL prefix: "+f)}return c}function B(a,b,c){d.info("Looking for a close bracket of type "+c+" in "+a);for(var e=0,f=0;f<a.length;f++)if(a[f]===b&&e++,a[f]===c&&e--,e<0)return f;return d.error("Statement had no close parenthesis in SPARQL query"),0}function E(a){return this.describe=function(b){return b+" = "+a.toNT()},this.test=function(b){return a.sameTerm(b)},this}function F(a){this.describe=function(b){return"REGEXP( '"+a+"' , "+b+" )"},this.test=function(b){var c=a,d=new RegExp(c);return!!b.value&&d.test(b.value)}}function G(a,b){3!==a.length||"Variable"!==a[0].termType||"NamedNode"!==a[2].termType&&"Literal"!==a[2].termType?6===a.length&&"string"==typeof a[0]&&"regexp"===a[0].toLowerCase()&&"("===a[1]&&")"===a[5]&&","===a[3]&&"Variable"===a[4].termType&&"Literal"===a[2].termType&&(d.debug("Constraint added: "+a),b.constraints[a[4]]=new F(a[2].value)):"="===a[1]?(d.debug("Constraint added: "+a),b.constraints[a[0]]=new E(a[2])):">"===a[1]?(d.debug("Constraint added: "+a),b.constraints[a[0]]=new E(a[2])):"<"===a[1]?(d.debug("Constraint added: "+a),b.constraints[a[0]]=new E(a[2])):d.warn("I don't know how to handle the constraint: "+a)}function H(a,b){d.debug("Optional query: "+a+" not yet implemented.");var e=c.formula();I(a,e),b.optional.push(e)}function I(a,b){var e,c=v(a);d.debug("WHERE: "+c);for(var f;x("OPTIONAL",c);)f=x("OPTIONAL",c),d.debug("OPT: "+f+" "+c[f]+" in "+c),"{"!==c[f+1]&&d.warn("Bad optional opening bracket in word "+f),e=B(c.slice(f+2),"{","}"),e===-1?d.error("No matching bracket in word "+f):(H(c.slice(f+2,f+2+e),b),f=x("OPTIONAL",c),e=B(c.slice(f+2),"{","}"),c.splice(f,e+3));for(d.debug("WHERE after optionals: "+c);x("FILTER",c);){var g=x("FILTER",c);"("!==c[g+1]&&d.warn("Bad filter opening bracket in word "+g),e=B(c.slice(g+2),"(",")"),e===-1?d.error("No matching bracket in word "+g):(G(c.slice(g+2,g+2+e),b),g=x("FILTER",c),e=B(c.slice(g+2),"(",")"),c.splice(g,e+3))}d.debug("WHERE after filters and optionals: "+c),J(c,b)}function J(a,b){var c=new Array(1);c[0]=-1;for(var e=c.concat(y(".",a)),f=[],g=0;g<e.length-1;g++)f[g]=a.slice(e[g]+1,e[g+1]);for(g in f){d.info("s+p+o "+g+" = "+f[g]);var h=f[g][0];f[g].splice(0,1);var i=c.concat(y(";",f[g]));i.push(f[g].length);for(var j=[],k=0;k<i.length-1;k++)j[k]=f[g].slice(i[k]+1,i[k+1]);for(g in j){d.info("p+o "+g+" = "+f[g]);var l=j[g][0];j[g].splice(0,1);var m=c.concat(y(",",j[g]));m.push(j[g].length);var n=[];for(k=0;k<m.length-1;k++)n[k]=j[g].slice(m[k]+1,m[k+1]);for(g in n){var o=n[g][0];d.info("Subj="+h+" Pred="+l+" Obj="+o),b.add(h,l,o)}}}}var g=[];d.info("SPARQL input: \n"+a);var K=new e,L=w(a),M=A(L);M.rdf||(M.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"),M.rdfs||(M.rdfs="http://www.w3.org/2000/01/rdf-schema#");var N=x("SELECT",L),O=x("WHERE",L);if(N<0||O<0||N>O)return d.error("Invalid or nonexistent SELECT and WHERE tags in SPARQL query"),!1;if(z(L.slice(N+1,O),K),I(L.slice(O+2,L.length-1),K.pat),b)return K;for(var P in K.pat.statements){var Q=K.pat.statements[P];"NamedNode"===Q.subject.termType&&f&&f.lookUpThing(Q.subject,"sparql:"+Q.subject),"NamedNode"===Q.object.termType&&f&&f.lookUpThing(Q.object,"sparql:"+Q.object)}return K}var d=a("./log"),e=a("./query").Query,f=a("./fetcher");b.exports=g},{"./fetcher":49,"./log":54,"./query":62}],68:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./node"),g=function(){function a(b,c,d,g){e(this,a),this.subject=f.fromValue(b),this.predicate=f.fromValue(c),this.object=f.fromValue(d),this.why=g}return d(a,[{key:"equals",value:function(b){return b.subject.equals(this.subject)&&b.predicate.equals(this.predicate)&&b.object.equals(this.object)&&b.graph.equals(this.graph)}},{key:"substitute",value:function(c){return new a(this.subject.substitute(c),this.predicate.substitute(c),this.object.substitute(c),this.why)}},{key:"toCanonical",value:function(){var b=[this.subject.toCanonical(),this.predicate.toCanonical(),this.object.toCanonical()];return this.graph&&"DefaultGraph"!==this.graph.termType&&b.push(this.graph.toCanonical()),b.join(" ")+" ."}},{key:"toNT",value:function(){return[this.subject.toNT(),this.predicate.toNT(),this.object.toNT()].join(" ")+" ."}},{key:"toString",value:function(){return this.toNT()}},{key:"graph",get:function(){return this.why},set:function(b){this.why=b}}]),a}();b.exports=g},{"./node":58}],69:[function(a,b,c){"use strict";var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},e=a("./uri").docpart,f=a("./fetcher"),g=a("./data-factory").graph,h=a("./indexed-formula"),i=a("./data-factory").namedNode,j=a("./namespace"),k=a("./serializer"),l=a("./uri").join,m=a("./util"),n=function(){var a=function(b){if(this.store=b,b.updater)throw new Error("You can't have two UpdateManagers for the same store");if(b.fetcher||f(b),b.updater)throw new Error("You can't have two UpdateManagers for the same store");b.updater=this,this.ifps={},this.fps={},this.ns={},this.ns.link=j("http://www.w3.org/2007/ont/link#"),this.ns.http=j("http://www.w3.org/2007/ont/http#"),this.ns.httph=j("http://www.w3.org/2007/ont/httph#"),this.ns.ldp=j("http://www.w3.org/ns/ldp#"),this.ns.rdf=j("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),this.ns.rdfs=j("http://www.w3.org/2000/01/rdf-schema#"),this.ns.rdf=j("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),this.ns.owl=j("http://www.w3.org/2002/07/owl#"),this.patchControl=[]};return a.prototype.patchControlFor=function(a){return this.patchControl[a.uri]||(this.patchControl[a.uri]=[]),this.patchControl[a.uri]},a.prototype.editable=function(a,b){if(!a)return!1;if(b||(b=this.store),"file:///"===a.slice(0,8)){if(b.holds(b.sym(a),i("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),i("http://www.w3.org/2007/ont/link#MachineEditableDocument")))return"LOCALFILE";var c=b.statementsMatching(b.sym(a),void 0,void 0);return console.log("sparql.editable: Not MachineEditableDocument file "+a+"\n"),console.log(c.map(function(a){return a.toNT()}).join("\n")),!1}var d,f=!1,g=b.each(void 0,this.ns.link("requestedURI"),e(a));if(b.holds(i(a),this.ns.rdf("type"),this.ns.ldp("Resource")))return"SPARQL";for(var h,j,k=0;k<g.length;k++)if(d=g[k],void 0!==d){var l=b.any(d,this.ns.link("response"));if(void 0!==d){var m=b.each(l,this.ns.httph("accept-patch"));if(m.length)for(h=0;h<m.length;h++)if(j=m[h].value.trim(),j.indexOf("application/sparql-update")>=0)return"SPARQL";var n=b.each(l,this.ns.httph("ms-author-via"));if(n.length)for(h=0;h<n.length;h++){if(j=n[h].value.trim(),j.indexOf("SPARQL")>=0)return"SPARQL";if(j.indexOf("DAV")>=0)return"DAV"}var o=b.each(l,this.ns.http("status"));if(o.length)for(h=0;h<o.length;h++)200!==o[h]&&404!==o[h]||(f=!0)}else console.log("sparql.editable: No response for "+a+"\n")}if(0===g.length)console.log("sparql.editable: No request for "+a+"\n");else if(f)return!1;console.log("sparql.editable: inconclusive for "+a+"\n")},a.prototype.anonymize=function(a){return"_:"===a.toNT().substr(0,2)&&this._mentioned(a)?"?"+a.toNT().substr(2):a.toNT()},a.prototype.anonymizeNT=function(a){return this.anonymize(a.subject)+" "+this.anonymize(a.predicate)+" "+this.anonymize(a.object)+" ."},a.prototype._statement_bnodes=function(a){return[a.subject,a.predicate,a.object].filter(function(a){return a.isBlank})},a.prototype._statement_array_bnodes=function(a){for(var b=[],c=0;c<a.length;c++)b=b.concat(this._statement_bnodes(a[c]));b.sort();for(var d=[],e=0;e<b.length;e++)0!==e&&b[e].sameTerm(b[e-1])||d.push(b[e]);return d},a.prototype._cache_ifps=function(){this.ifps={};for(var a=this.store.each(void 0,this.ns.rdf("type"),this.ns.owl("InverseFunctionalProperty")),b=0;b<a.length;b++)this.ifps[a[b].uri]=!0;
for(this.fps={},a=this.store.each(void 0,this.ns.rdf("type"),this.ns.owl("FunctionalProperty")),b=0;b<a.length;b++)this.fps[a[b].uri]=!0},a.prototype._bnode_context2=function(a,b,c){for(var e,f,d=this.store.statementsMatching(void 0,void 0,a,b),g=0;g<d.length;g++)if(this.fps[d[g].predicate.uri]){if(e=d[g].subject,!e.isBlank)return[d[g]];if(c&&(f=this._bnode_context2(e,b,c-1)))return f.concat([d[g]])}for(d=this.store.statementsMatching(a,void 0,void 0,b),g=0;g<d.length;g++)if(this.ifps[d[g].predicate.uri]){if(e=d[g].object,!e.isBlank)return[d[g]];if(c&&(f=this._bnode_context2(e,b,c-1)))return f.concat([d[g]])}return null},a.prototype._bnode_context_1=function(a,b){for(var c=0;c<3;c++){var d=this._bnode_context2(a,b,c);if(null!==d)return d}throw new Error("Unable to uniquely identify bnode: "+a.toNT())},a.prototype._mentioned=function(a){return 0!==this.store.statementsMatching(a).length||0!==this.store.statementsMatching(void 0,a).length||0!==this.store.statementsMatching(void 0,void 0,a).length},a.prototype._bnode_context=function(a,b){var c=[];if(a.length){this._cache_ifps();for(var d=0;d<a.length;d++){var e=a[d];this._mentioned(e)&&(c=c.concat(this._bnode_context_1(e,b)))}}return c},a.prototype._statement_context=function(a){var b=this._statement_bnodes(a);return this._bnode_context(b,a.why)},a.prototype._context_where=function(a){var b=this;return a&&0!==a.length?"WHERE { "+a.map(function(a){return b.anonymizeNT(a)}).join("\n")+" }\n":""},a.prototype._fire=function(a,b,c){if(!a)throw new Error("No URI given for remote editing operation: "+b);console.log("sparql: sending update to <"+a+">");var d=m.XMLHTTPFactory();d.options={},d.onreadystatechange=function(){if(4===d.readyState){var e=!d.status||d.status>=200&&d.status<300;e?console.log("sparql: update Ok for <"+a+">"):console.log("sparql: update failed for <"+a+"> status="+d.status+", "+d.statusText+", body length="+d.responseText.length+"\n   for query: "+b),c(a,e,d.responseText,d)}},d.open("PATCH",a,!0),d.setRequestHeader("Content-type","application/sparql-update"),d.send(b)},a.prototype.update_statement=function(a){if(!a||a.why){var b=this,c=this._statement_context(a);return{statement:a?[a.subject,a.predicate,a.object,a.why]:void 0,statementNT:a?this.anonymizeNT(a):void 0,where:b._context_where(c),set_object:function(c,d){var e=this.where;e+="DELETE DATA { "+this.statementNT+" } ;\n",e+="INSERT DATA { "+this.anonymize(this.statement[0])+" "+this.anonymize(this.statement[1])+" "+this.anonymize(c)+"  . }\n",b._fire(this.statement[3].uri,e,d)}}}},a.prototype.insert_statement=function(a,b){var c=a instanceof Array?a[0]:a,d=this._context_where(this._statement_context(c));if(a instanceof Array){for(var e="",f=0;f<a.length;f++)e+=a[f]+"\n";d+="INSERT DATA { "+e+" }\n"}else d+="INSERT DATA { "+this.anonymize(a.subject)+" "+this.anonymize(a.predicate)+" "+this.anonymize(a.object)+"  . }\n";this._fire(c.why.uri,d,b)},a.prototype.delete_statement=function(a,b){var c=a instanceof Array?a[0]:a,d=this._context_where(this._statement_context(c));if(a instanceof Array){for(var e="",f=0;f<a.length;f++)e+=a[f]+"\n";d+="DELETE DATA { "+e+" }\n"}else d+="DELETE DATA { "+this.anonymize(a.subject)+" "+this.anonymize(a.predicate)+" "+this.anonymize(a.object)+"  . }\n";this._fire(c.why.uri,d,b)},a.prototype.requestDownstreamAction=function(a,b){var c=this.patchControlFor(a);if(c.pendingUpstream){if(c.downstreamAction){if(c.downstreamAction===b)return this;throw new Error("Can't wait for > 1 differnt downstream actions")}c.downstreamAction=b}else b(a)},a.prototype.clearUpstreamCount=function(a){var b=this.patchControlFor(a);b.upstreamCount=0},a.prototype.getUpdatesVia=function(a){var b=this.store.fetcher.getHeader(a,"updates-via");return b&&b.length?b[0].trim():null},a.prototype.addDownstreamChangeListener=function(a,b){var c=this.patchControlFor(a);c.downstreamChangeListeners||(c.downstreamChangeListeners=[]),c.downstreamChangeListeners.push(b);var d=this;this.setRefreshHandler(a,function(a){d.reloadAndSync(a)})},a.prototype.reloadAndSync=function(a){var b=this.patchControlFor(a),c=this;if(b.reloading)return void console.log("   Already reloading - stop");b.reloading=!0;var d=1e3,e=function e(){console.log("try reload - timeout = "+d),c.reload(c.store,a,function(c,f,g){if(b.reloading=!1,c){if(b.downstreamChangeListeners)for(var h=0;h<b.downstreamChangeListeners.length;h++)console.log("        Calling downstream listener "+h),b.downstreamChangeListeners[h]()}else 0===g.status?(console.log("Network error refreshing the data. Retrying in "+d/1e3),b.reloading=!0,d*=2,setTimeout(e,d)):console.log("Error "+g.status+"refreshing the data:"+f+". Stopped"+a)})};e()},a.prototype.setRefreshHandler=function(a,b){var c=this.getUpdatesVia(a),d=b,e=this,f=this,g=1500,h=0;if(!c)return console.log("Server doies not support live updates thoughUpdates-Via :-("),!1;c=l(c,a.uri),c=c.replace(/^http:/,"ws:").replace(/^https:/,"wss:"),console.log("Web socket URI "+c);var i=function b(){var i;if("undefined"!=typeof WebSocket)i=new WebSocket(c);else if("undefined"!=typeof Services)i=Services.wm.getMostRecentWindow("navigator:browser").WebSocket(c);else{if("undefined"==typeof window||!window.WebSocket)return void console.log("Live update disabled, as WebSocket not supported by platform :-(");i=window.WebSocket(c)}i.onopen=function(){console.log("    websocket open"),g=1500,this.send("sub "+a.uri),h&&(console.log("Web socket has been down, better check for any news."),f.requestDownstreamAction(a,d))};var j=e.patchControlFor(a);j.upstreamCount=0,i.onclose=function(a){console.log("*** Websocket closed with code "+a.code+", reason '"+a.reason+"' clean = "+a.clean),g*=2,h+=1,console.log("Retrying in "+g+"ms"),setTimeout(function(){console.log("Trying websocket again"),b()},g)},i.onmessage=function(b){if(b.data&&"pub"===b.data.slice(0,3)){if(j.upstreamCount&&(j.upstreamCount-=1,j.upstreamCount>=0))return void console.log("just an echo");j.upstreamCount=0,console.log("Assume a real downstream change"),e.requestDownstreamAction(a,d)}}};return i(),!0},a.prototype.update=function(a,b,c){try{var e=this.store,f=a?a instanceof h?a.statements:a instanceof Array?a:[a]:[],g=b?b instanceof h?b.statements:b instanceof Array?b:[b]:[];if(!(f instanceof Array))throw new Error("Type Error "+("undefined"==typeof f?"undefined":d(f))+": "+f);if(!(g instanceof Array))throw new Error("Type Error "+("undefined"==typeof g?"undefined":d(g))+": "+g);if(0===f.length&&0===g.length)return c(null,!0);var i=f.length?f[0].why:g[0].why,j=this.patchControlFor(i),n=Date.now(),o=["subject","predicate","object","why"],p=["insert","delete"],q={delete:f,insert:g};p.map(function(a){q[a].map(function(a){if(!i.sameTerm(a.why))throw new Error("update: destination "+i+" inconsistent with delete quad "+a.why);o.map(function(b){if("undefined"==typeof a[b])throw new Error("update: undefined "+b+" of statement.")})})});var r=this.editable(i.uri,e);if(!r)throw new Error("Can't make changes in uneditable "+i);var s,t,u,v;if(r.indexOf("SPARQL")>=0){var w=[];f.length&&(w=this._statement_array_bnodes(f)),g.length&&(w=w.concat(this._statement_array_bnodes(g)));var x=this._bnode_context(w,i),y=this._context_where(x),z="";if(y.length){if(f.length){for(z+="DELETE { ",s=0;s<f.length;s++)z+=this.anonymizeNT(f[s])+"\n";z+=" }\n"}if(g.length){for(z+="INSERT { ",s=0;s<g.length;s++)z+=this.anonymizeNT(g[s])+"\n";z+=" }\n"}z+=y}else{if(f.length){for(z+="DELETE DATA { ",s=0;s<f.length;s++)z+=this.anonymizeNT(f[s])+"\n";z+=" } \n"}if(g.length){for(f.length&&(z+=" ; "),z+="INSERT DATA { ",s=0;s<g.length;s++)z+=this.anonymizeNT(g[s])+"\n";z+=" }\n"}}j.pendingUpstream=j.pendingUpstream?j.pendingUpstream+1:1,"undefined"!=typeof j.upstreamCount&&(j.upstreamCount+=1),this._fire(i.uri,z,function(a,b,d,h){if(h.elapsedTime_ms=Date.now()-n,console.log("    sparql: Return "+(b?"success":"FAILURE "+h.status)+" elapsed "+h.elapsedTime_ms+"ms"),b){try{e.remove(f)}catch(a){b=!1,d="Remote Ok BUT error deleting "+f.length+" from store!!! "+a}for(var k=0;k<g.length;k++)e.add(g[k].subject,g[k].predicate,g[k].object,i)}if(c(a,b,d,h),j.pendingUpstream-=1,0===j.pendingUpstream&&j.downstreamAction){var l=j.downstreamAction;delete j.downstreamAction,console.log("delayed downstream action:"),l(i)}})}else if(r.indexOf("DAV")>=0){var A=e.any(i,this.ns.link("request"));if(!A)throw new Error("No record of our HTTP GET request for document: "+i);var B=e.any(A,this.ns.link("response"));if(!B)return null;var C=e.the(B,this.ns.httph("content-type")).value;for(t=e.statementsMatching(void 0,void 0,void 0,i).slice(),s=0;s<f.length;s++)m.RDFArrayRemove(t,f[s]);for(s=0;s<g.length;s++)t.push(g[s]);switch(v=k(e),v.suggestNamespaces(e.namespaces),v.setBase(i.uri),C){case"application/rdf+xml":u=v.statementsToXML(t);break;case"text/n3":case"text/turtle":case"application/x-turtle":case"application/n3":u=v.statementsToN3(t);break;default:throw new Error("Content-type "+C+" not supported for data write")}var E,D=e.the(B,this.ns.httph("content-location"));D&&(E=l(D.value,E));var F=m.XMLHTTPFactory();F.options={},F.onreadystatechange=function(){if(4===F.readyState){var a=!F.status||F.status>=200&&F.status<300;if(a){for(var b=0;b<f.length;b++)e.remove(f[b]);for(b=0;b<g.length;b++)e.add(g[b].subject,g[b].predicate,g[b].object,i)}c(i.uri,a,F.responseText)}},F.open("PUT",E,!0),F.setRequestHeader("Content-type",C),F.send(u)}else{if(!(r.indexOf("LOCALFILE")>=0))throw new Error("Unhandled edit method: '"+r+"' for "+i);try{for(console.log("Writing back to local file\n"),t=e.statementsMatching(void 0,void 0,void 0,i).slice(),s=0;s<f.length;s++)m.RDFArrayRemove(t,f[s]);for(s=0;s<g.length;s++)t.push(g[s]);v=k(e),v.suggestNamespaces(e.namespaces),v.setBase(i.uri);var G=i.uri.lastIndexOf(".");if(G<1)throw new Error("Rewriting file: No filename extension: "+i.uri);var H=i.uri.slice(G+1);switch(H){case"rdf":case"owl":case"xml":u=v.statementsToXML(t);break;case"n3":case"nt":case"ttl":u=v.statementsToN3(t);break;default:throw new Error("File extension ."+H+" not supported for data write")}console.log("Writing back: <<<"+u+">>>");var I=i.uri.slice(7),J=Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);if(J.initWithPath(I),!J.exists())throw new Error("Rewriting file <"+i.uri+"> but it does not exist!");var K=Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);for(K.init(J,42,parseInt("0666",8),0),K.write(u,u.length),K.close(),s=0;s<f.length;s++)e.remove(f[s]);for(s=0;s<g.length;s++)e.add(g[s].subject,g[s].predicate,g[s].object,i);c(i.uri,!0,"")}catch(a){c(i.uri,!1,"Exception trying to write back file <"+i.uri+">\n")}}}catch(a){c(void 0,!1,"Exception in update: "+a)}},a.prototype.put=function(a,b,c,e){var f,g=this.store;if(("undefined"==typeof b?"undefined":d(b))===d(""))f=b;else{var h=k(g);switch(h.suggestNamespaces(g.namespaces),h.setBase(a.uri),c){case"application/rdf+xml":f=h.statementsToXML(b);break;case"text/n3":case"text/turtle":case"application/x-turtle":case"application/n3":f=h.statementsToN3(b);break;default:throw new Error("Content-type "+c+" not supported for data PUT")}}var i=m.XMLHTTPFactory();i.options={},i.onreadystatechange=function(){if(4===i.readyState){var c=!i.status||i.status>=200&&i.status<300;c&&"string"!=typeof b&&b.map(function(a){g.addStatement(a)}),c&&(delete g.fetcher.nonexistant[a.uri],delete g.fetcher.requested[a.uri]),e(a.uri,c,i.responseText,i)}},i.open("PUT",a.uri,!0),i.setRequestHeader("Content-type",c),i.send(f)},a.prototype.reload=function(a,b,c){var d=Date.now();a.fetcher.nowOrWhenFetched(b.uri,{force:!0,noMeta:!0,clearPreviousData:!0},function(a,e,f){if(a)if(f.onErrorWasCalled||200!==f.status)console.log("    Non-HTTP error reloading data! onErrorWasCalled="+f.onErrorWasCalled+" status: "+f.status),c(!1,"Non-HTTP error reloading data: "+e,f);else{var g=Date.now()-d;b.reloadTime_total||(b.reloadTime_total=0),b.reloadTime_count||(b.reloadTime_count=0),b.reloadTime_total+=g,b.reloadTime_count+=1,console.log("    Fetch took "+g+"ms, av. of "+b.reloadTime_count+" = "+b.reloadTime_total/b.reloadTime_count+"ms."),c(!0)}else console.log("    ERROR reloading data: "+e),c(!1,"Error reloading data: "+e,f)})},a.prototype.oldReload=function(a,b,c){var d=g(),e=f(d),h=Date.now();e.nowOrWhenFetched(b.uri,{force:!0,noMeta:!0,clearPreviousData:!0},function(e,f,g){if(e)if(g.onErrorWasCalled||200!==g.status)console.log("    Non-HTTP error reloading data! onErrorWasCalled="+g.onErrorWasCalled+" status: "+g.status),c(!1,"Non-HTTP error reloading data: "+f,g);else{var i=a.statementsMatching(void 0,void 0,void 0,b).slice(),j=d.statementsMatching(void 0,void 0,void 0,b).slice();console.log("    replacing "+i.length+" with "+j.length+" out of total statements "+a.statements.length),a.remove(i),a.add(j);var k=Date.now()-h;0===j.length&&console.log("????????????????? 0000000"),b.reloadTime_total||(b.reloadTime_total=0),b.reloadTime_count||(b.reloadTime_count=0),b.reloadTime_total+=k,b.reloadTime_count+=1,console.log("    fetch took "+k+"ms, av. of "+b.reloadTime_count+" = "+b.reloadTime_total/b.reloadTime_count+"ms."),c(!0)}else console.log("    ERROR reloading data: "+f),c(!1,"Error reloading data: "+f,g)})},a}();b.exports=n},{"./data-factory":46,"./fetcher":49,"./indexed-formula":51,"./namespace":57,"./serializer":66,"./uri":71,"./util":72}],70:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=a("./data-factory").namedNode,g=function(){function a(b,c){e(this,a),this.parent=b,this.via=c,this.connected=!1,this.pending={},this.subscribed={},this.socket={};try{this.socket=new WebSocket(c),this.socket.onopen=this.onOpen,this.socket.onclose=this.onClose,this.socket.onmessage=this.onMessage,this.socket.onerror=this.onError}catch(a){this.onError(a)}}return d(a,[{key:"_decode",value:function(b){var c,d,e,f,g,h,i;f={},g=function(){var a,d,e,f;for(e=b.split("&"),f=[],a=0,d=e.length;a<d;a++)c=e[a],f.push(c.split("="));return f}();for(d in g)c=g[d],h=[decodeURIComponent(c[0]),decodeURIComponent(c[1])],e=h[0],i=h[1],null==f[e]&&(f[e]=[]),f[e].push(i);return f}},{key:"_send",value:function(b,c,d){var e,f;return f=[b,c,d].join(" "),"function"==typeof(e=this.socket).send?e.send(f):void 0}},{key:"_subscribe",value:function(b){return this._send("sub",b,""),this.subscribed[b]=!0,this.subscribed[b]}},{key:"onClose",value:function(b){var c;this.connected=!1;for(c in this.subscribed)this.pending[c]=!0;return this.subscribed={},this.subscribed}},{key:"onError",value:function(b){throw new Error("onError"+b)}},{key:"onMessage",value:function(b){var c,d;return d=b.data.split(" "),"ping"===d[0]?"function"==typeof(c=this.socket).send?c.send("pong "+d.slice(1).join(" ")):void 0:"pub"===d[0]?this.parent.onUpdate(d[1],this._decode(d[2])):void 0}},{key:"onOpen",value:function(b){var c,d;this.connected=!0,c=[];for(d in this.pending)delete this.pending[d],c.push(this._subscribe(d));return c}},{key:"subscribe",value:function(b){return this.connected?this._subscribe(b):(this.pending[b]=!0,this.pending[b])}}]),a}(),h=function(){function a(b){e(this,a),this.fetcher=b,this.graph={},this.via={},this.fetcher.addCallback("headers",this.onHeaders)}return d(a,[{key:"onHeaders",value:function(b){var c,d,e;return null==b.headers||("undefined"==typeof WebSocket||null===WebSocket||(c=b.headers.etag,e=b.headers["updates-via"],d=b.uri,c&&e&&(this.graph[d]={etag:c,via:e},this.register(e,d)),!0))}},{key:"onUpdate",value:function(b,c){return this.fetcher.refresh(f(b))}},{key:"register",value:function(b,c){return null==this.via[b]&&(this.via[b]=new g(this,b)),this.via[b].subscribe(c)}}]),a}();b.exports.UpdatesSocket=g,b.exports.UpdatesVia=h},{"./data-factory":46}],71:[function(a,b,c){"use strict";function f(a){var b;return b=a.indexOf("#"),b<0?a:a.slice(0,b)}function g(a){return e(f(a.uri))}function h(a){var b=/[^\/]*\/\/([^\/]*)\//.exec(a);return b?b[1]:""}function i(a,b){var c,e,f,g,h,i,j=b.indexOf("#");if(j>0&&(b=b.slice(0,j)),0===a.length)return b;if(0===a.indexOf("#"))return b+a;if(g=a.indexOf(":"),g>=0)return a;if(c=b.indexOf(":"),0===b.length)return a;if(c<0)return d("Invalid base: "+b+" in join with given: "+a),a;if(e=b.slice(0,+c+1||9e9),0===a.indexOf("//"))return e+a;if(b.indexOf("//",c)===c+1){if(f=b.indexOf("/",c+3),f<0)return b.length-c-3>0?b+"/"+a:e+a}else if(f=b.indexOf("/",c+1),f<0)return b.length-c-1>0?b+"/"+a:e+a;if(0===a.indexOf("/"))return b.slice(0,f)+a;if(i=b.slice(f),h=i.lastIndexOf("/"),h<0)return e+a;for(h>=0&&h<i.length-1&&(i=i.slice(0,+h+1||9e9)),i+=a;i.match(/[^\/]*\/\.\.\//);)i=i.replace(/[^\/]*\/\.\.\//,"");return i=i.replace(/\.\//g,""),i=i.replace(/\/\.$/,"/"),b.slice(0,f)+i}function j(a){var b;return b=a.indexOf(":"),b<0?null:a.slice(0,b)}function k(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=new RegExp("^[-_a-zA-Z0-9.]+:(//[^/]*)?/[^/]*$");if(!a)return b;if(a===b)return"";for(d=j=0,g=b.length;j<g&&(c=b[d],c===a[d]);d=++j);if(a.slice(0,d).match(p)&&(e=b.indexOf("//"),e<0&&(e=-2),f=b.indexOf("/",e+2),"/"!==b[f+1]&&"/"!==a[f+1]&&b.slice(0,f)===a.slice(0,f)))return b.slice(f);if("#"===b[d]&&a.length===d)return b.slice(d);for(;d>0&&"/"!==b[d-1];)d--;if(d<3)return b;if(a.indexOf("//",d-2)>0||b.indexOf("//",d-2)>0)return b;if(a.indexOf(":",d)>0)return b;for(i=0,m=a.slice(d),k=0,h=m.length;k<h;k++)c=m[k],"/"===c&&i++;if(0===i&&d<b.length&&"#"===b[d])return"./"+b.slice(d);if(0===i&&d===b.length)return"./";if(o="",i>0)for(l=1,n=i;n>=1?l<=n:l>=n;n>=1?++l:--l)o+="../";return o+b.slice(d)}var d=d||console.log;b.exports.docpart=f,b.exports.document=g,b.exports.hostpart=h,b.exports.join=i,b.exports.protocol=j,b.exports.refTo=k;var e=a("./data-factory").namedNode},{"./data-factory":46}],72:[function(a,b,c){"use strict";function f(a,b,c){var f=null;if("undefined"!=typeof a.fetcher&&(f=a.fetcher,"NamedNode"===b.termType)){var h,g=d(b.uri);if(b.uri.indexOf("#")<0){if(s(b.uri,"http://dbpedia.org/resource/Category:"))return;s(b.uri,"http://purl.org/dc/elements/1.1/")||s(b.uri,"http://purl.org/dc/terms/")?h="http://dublincore.org/2005/06/13/dcq":s(b.uri,"http://xmlns.com/wot/0.1/")?h="http://xmlns.com/wot/0.1/index.rdf":s(b.uri,"http://web.resource.org/cc/")&&(h="http://web.resource.org/cc/schema.rdf")}h&&(g=h),f&&"unrequested"!==f.getState(g)||(h&&e.warn("Assuming server still broken, faking redirect of <"+b.uri+"> to <"+g+">"),f.requestURI(g,c))}}function g(a,b,c){c||(c=0);var d=a.length;for(c<0&&(c=d+c);c<d;c++)if(a[c]===b)return c;return-1}function h(a,b){a.callbacks={};for(var c=b.length-1;c>=0;c--)a.callbacks[b[c]]=[];a.addHook=function(b){a.callbacks[b]||(a.callbacks[b]=[])},a.addCallback=function(b,c){a.callbacks[b].push(c)},a.removeCallback=function(b,c){for(var d=0;d<a.callbacks[b].length;d++)if(a.callbacks[b][d].name===c)return a.callbacks[b].splice(d,1),!0;return!1},a.insertCallback=function(b,c){a.callbacks[b].unshift(c)},a.fireCallbacks=function(b,c){var g,d=[],e=[],f=a.callbacks[b].length;for(g=f-1;g>=0;g--)a.callbacks[b][g].apply(a,c)&&d.push(a.callbacks[b][g]);for(g=d.length-1;g>=0;g--)e.push(d[g]);for(g=f;g<a.callbacks[b].length;g++)e.push(a.callbacks[b][g]);a.callbacks[b]=e}}function i(){return tabulator&&tabulator.isExtension?Components.classes["@mozilla.org/xmlextras/domparser;1"].getService(Components.interfaces.nsIDOMParser):window.DOMParser?new DOMParser:!!window.ActiveXObject&&new ActiveXObject("Microsoft.XMLDOM")}function j(a,b){b=b||{};var c=[];"selfClosing"in b&&b.selfClosing.split(" ").forEach(function(a){c[a]=!0});var d=[];return"skipAttributes"in b&&b.skipAttributes.split(" ").forEach(function(a){d[a]=!0}),k(a,b,c,d)}function k(a,b,c,d){var e,f="",g=[!1];if("undefined"==typeof a.nodeType)return f;if(1===a.nodeType){if(a.hasAttribute("class")&&"classWithChildText"in b&&a.matches(b.classWithChildText.class))f+=a.querySelector(b.classWithChildText.element).textContent;else if(!("skipNodeWithClass"in b&&a.matches("."+b.skipNodeWithClass))){var h=a.nodeName.toLowerCase();f+="<"+h;var i=[];for(e=a.attributes.length-1;e>=0;e--){var j=a.attributes[e];if(!(d.length>0&&d[j.name]||/^\d+$/.test(j.name))){if("class"===j.name&&"replaceClassItemWith"in b&&j.value.split(" ").indexOf(b.replaceClassItemWith.source)>-1){var l=new RegExp(b.replaceClassItemWith.source,"g");j.value=j.value.replace(l,b.replaceClassItemWith.target).trim()}"class"===j.name&&"skipClassWithValue"in b&&b.skipClassWithValue===j.value||i.push(j.name+"='"+j.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&quot;")+"'")}}if(i.length>0&&("sortAttributes"in b&&b.sortAttributes&&i.sort(function(a,b){return a.toLowerCase().localeCompare(b.toLowerCase())}),f+=" "+i.join(" ")),c[h])f+=" />";else{for(f+=">",f+="html"===h?"\n  ":"",g.push("style"===h||"script"===h),e=0;e<a.childNodes.length;e++)f+=k(a.childNodes[e]);g.pop(),f+="body"===h?"</"+h+">\n":"</"+h+">"}}}else if(8===a.nodeType)f+="<!--"+a.nodeValue+"-->";else if(3===a.nodeType||4===a.nodeType){var m=a.nodeValue.replace(/\n+$/,"");f+=g[g.length-1]?m:m.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}else console.log("Warning; Cannot handle serialising nodes of type: "+a.nodeType),console.log(a);return f}function l(){var a=new Date,b=a.getYear()+1900,c=a.getMonth()+1,d=a.getDate(),e=a.getUTCHours(),f=a.getUTCMinutes(),g=a.getSeconds();return c<10&&(c="0"+c),d<10&&(d="0"+d),e<10&&(e="0"+e),f<10&&(f="0"+f),g<10&&(g="0"+g),b+"-"+c+"-"+d+"T"+e+":"+f+":"+g+"Z"}function m(a){for(var d,b=a.getAllResponseHeaders().split("\n"),c={},e=0;e<b.length;e++)if(b[e].length>0){var f=b[e].split(": ");"undefined"==typeof f[1]?c[d]+="\n"+f[0]:(d=f[0].toLowerCase(),c[d]=f[1])}return c}function n(a,b,c){var d=function(b){return"BlankNode"===b.termType?null:b},e=function(e){var f=c.statementsMatching(a).map(function(a){return""+d(a.subject)+" "+d(a.predicate)+" "+d(a.object)}).concat(c.statementsMatching(void 0,void 0,a).map(function(a){return""+d(a.subject)+" "+d(a.predicate)+" "+d(a.object)}));return f.sort(),f.join("\n")};return"BlankNode"===a.termType||"BlankNode"===b.termType?0===a.compareTerm(b)?0:e(a)>e(b)?1:e(a)<e(b)?-1:a.compareTerm(b):a.compareTerm(b)}function o(a,b,c){var d=n(a.subject,b.subject,c);return d?d:(d=n(a.predicate,b.predicate,c),d?d:n(a.object,b.object,c))}function p(a){var b=document.createElement("div");b.textContent=a,document.body.appendChild(b)}function q(c,d){var e;if(d=d||{},"undefined"!=typeof tabulator&&tabulator.isExtension)e=Components.classes["@mozilla.org/xmlextras/domparser;1"].getService(Components.interfaces.nsIDOMParser);else{if("undefined"!=typeof b&&b&&b.exports){var f=a("xmldom").DOMParser,g=(new f).parseFromString(c,d.contentType||"application/xhtml+xml");return g}e="undefined"!=typeof window&&window.DOMParser?new window.DOMParser:new f}return e.parseFromString(c,"application/xml")}function r(a,b){for(var c=0;c<a.length;c++)if(a[c].subject.sameTerm(b.subject)&&a[c].predicate.sameTerm(b.predicate)&&a[c].object.sameTerm(b.object)&&a[c].why.sameTerm(b.why))return void a.splice(c,1);throw new Error("RDFArrayRemove: Array did not contain "+b+" "+b.why)}function s(a,b){return a.slice(0,b.length)===b}function t(a,b){for(var c=a.split("%s"),d="",e=0;e<b.length;e++)b[e]+="",d+=c[e]+b[e];return d+c.slice(b.length).join()}function u(){var c;if("undefined"!=typeof tabulator&&tabulator.isExtension)return Components.classes["@mozilla.org/xmlextras/xmlhttprequest;1"].createInstance().QueryInterface(Components.interfaces.nsIXMLHttpRequest);if("undefined"!=typeof window&&"XMLHttpRequest"in window)return new(c=window.XMLHttpRequest);if("undefined"!=typeof b&&b&&b.exports)return new(c=a("xmlhttprequest").XMLHttpRequest);if(!window.ActiveXObject)return!1;try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){return new ActiveXObject("Microsoft.XMLHTTP")}}var d=a("./uri").docpart,e=a("./log");b.exports.AJAR_handleNewTerm=f,b.exports.ArrayIndexOf=g,b.exports.callbackify=h,b.exports.dtstamp=l,b.exports.DOMParserFactory=i,b.exports.domToString=j,b.exports.dumpNode=k,b.exports.getHTTPHeaders=m,b.exports.heavyCompare=n,b.exports.heavyCompareSPO=o,b.exports.output=p,b.exports.parseXML=q,b.exports.RDFArrayRemove=r,b.exports.string_startswith=s,b.exports.string={},b.exports.string.template=t,b.exports.uri=a("./uri"),b.exports.XMLHTTPFactory=u,b.exports.log=e},{"./log":54,"./uri":71,xmldom:39,xmlhttprequest:void 0}],73:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./class-order"),i=a("./node"),j=a("./uri"),k=function(a){function b(){var a=arguments.length<=0||void 0===arguments[0]?"":arguments[0];e(this,b);var c=f(this,Object.getPrototypeOf(b).call(this));return c.termType=b.termType,c.value=a,c.base="varid:",c.uri=j.join(a,c.base),c}return g(b,a),d(b,[{key:"equals",value:function(b){return!!b&&(this.termType===b.termType&&this.value===b.value)}},{key:"hashString",value:function(){return this.toString()}},{key:"substitute",value:function(b){var c;return null!=(c=b[this.toNT()])?c:this}},{key:"toString",value:function(){return this.uri.slice(0,this.base.length)===this.base?"?"+this.uri.slice(this.base.length):"?"+this.uri}}]),b}(i);k.termType="Variable",k.prototype.classOrder=h.Variable,k.prototype.isVar=1,b.exports=k},{"./class-order":43,"./node":58,"./uri":71}],74:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=a("./named-node"),f=function a(){d(this,a)};f.boolean=new e("http://www.w3.org/2001/XMLSchema#boolean"),f.dateTime=new e("http://www.w3.org/2001/XMLSchema#dateTime"),f.decimal=new e("http://www.w3.org/2001/XMLSchema#decimal"),f.float=new e("http://www.w3.org/2001/XMLSchema#float"),f.integer=new e("http://www.w3.org/2001/XMLSchema#integer"),f.langString=new e("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),f.string=new e("http://www.w3.org/2001/XMLSchema#string"),b.exports=f},{"./named-node":56}],rdflib:[function(a,b,c){"use strict";var d={BlankNode:a("./blank-node"),Collection:a("./collection"),convert:a("./convert"),DataFactory:a("./data-factory"),Empty:a("./empty"),Fetcher:a("./fetcher"),Formula:a("./formula"),IndexedFormula:a("./indexed-formula"),jsonParser:a("./jsonparser"),Literal:a("./literal"),log:a("./log"),N3Parser:a("./n3parser"),NamedNode:a("./named-node"),Namespace:a("./namespace"),Node:a("./node"),parse:a("./parse"),Query:a("./query").Query,queryToSPARQL:a("./query-to-sparql"),RDFaProcessor:a("./rdfaparser"),RDFParser:a("./rdfxmlparser"),serialize:a("./serialize"),Serializer:a("./serializer"),SPARQLToQuery:a("./sparql-to-query"),sparqlUpdateParser:a("./patch-parser"),Statement:a("./statement"),term:a("./node").fromValue,UpdateManager:a("./update-manager"),UpdatesSocket:a("./updates-via").UpdatesSocket,UpdatesVia:a("./updates-via").UpdatesVia,uri:a("./uri"),Util:a("./util"),Variable:a("./variable")};d.NextId=d.BlankNode.nextId,d.fromNT=d.Formula.prototype.fromNT,d.fetcher=d.DataFactory.fetcher,d.graph=d.DataFactory.graph,d.lit=d.DataFactory.lit,d.st=d.DataFactory.st,d.sym=d.DataFactory.namedNode,d.variable=d.DataFactory.variable,d.blankNode=d.DataFactory.blankNode,d.defaultGraph=d.DataFactory.defaultGraph,d.literal=d.DataFactory.literal,d.namedNode=d.DataFactory.namedNode,d.quad=d.DataFactory.quad,d.triple=d.DataFactory.triple,b.exports=d},{"./blank-node":42,"./collection":44,"./convert":45,"./data-factory":46,"./empty":48,"./fetcher":49,"./formula":50,"./indexed-formula":51,"./jsonparser":52,"./literal":53,"./log":54,"./n3parser":55,"./named-node":56,"./namespace":57,"./node":58,"./parse":59,"./patch-parser":60,"./query":62,"./query-to-sparql":61,"./rdfaparser":63,"./rdfxmlparser":64,"./serialize":65,"./serializer":66,"./sparql-to-query":67,"./statement":68,"./update-manager":69,"./updates-via":70,"./uri":71,"./util":72,"./variable":73}]},{},[])("rdflib")});